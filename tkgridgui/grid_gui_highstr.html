<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
<title>grid_gui.py</title>

<style type="text/css">
@media print { body { -webkit-print-color-adjust: exact; font-size: 9pt; } }
</style>

<style type="text/css">

pre
{
    font-face: verdana, arial, helvetica, sans-serif;
    font-size: 1.2em;
    
    word-break: break-all; /* webkit /
    white-space: pre;
    white-space: pre\9; / IE7+ */   

    white-space: pre-wrap;       /* css-3 */
    white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
    white-space: -pre-wrap;      /* Opera 4-6 */
    white-space: -o-pre-wrap;    /* Opera 7 */
    word-wrap: break-word;       /* Internet Explorer 5.5+ */

}
.token_number
{
    color: #0077b3;
    font-weight:500;
}
.token_op
{
    color: #000000;
    font-weight:bold;
}
.token_string
{
    color: #cc0000;
    font-weight:500;
}
.token_comment
{
    color: #007F00;
    font-weight:500;
}
.token_name
{
    color: #000000;
    font-weight:500;
}
.token_error
{
    color: #e40000;
    font-weight:500;
}
.keyword
{
    color: blue;
    font-weight:bold;
}
.text
{
    color: #000000;
    font-weight:500;
}

</style>
<body><h2>grid_gui.py</h2>
<pre><font face="Lucida,Courier New">
directory : D:\2018_py_proj\TkGridGUI\tkgridgui
Line Count : 1003
Line Clip Size : No Clipping

<strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong>  <strong style="background-color:#b4ffb2">Word</strong> <strong style="background-color:#b4ffb2">MatchCase</strong> <strong style="background-color:yellow">(5)</strong> <A href="#line161">161</A> <A href="#line495">495</A> <A href="#line498">498</A> <A href="#line788">788</A> <A href="#line910">910</A> <BR>
<a name="line1"><span class="token_number">   1 </span></a><span class="token_comment">#!/usr/bin/env python</span>
<a name="line2"><span class="token_number">   2 </span></a><span class="token_comment"># -*- coding: ascii -*-</span>
<a name="line3"><span class="token_number">   3 </span></a><span class="keyword">from</span> <span class="token_name">__future__</span> <span class="keyword">import</span> <span class="token_name">print_function</span>
<a name="line4"><span class="token_number">   4 </span></a><span class="keyword">from</span> <span class="token_name">__future__</span> <span class="keyword">import</span> <span class="token_name">unicode_literals</span>
<a name="line5"><span class="token_number">   5 </span></a><span class="keyword">from</span> <span class="token_name">future</span> <span class="keyword">import</span> <span class="token_name">standard_library</span>
<a name="line6"><span class="token_number">   6 </span></a><span class="token_name">standard_library</span><span class="token_op">.</span><span class="token_name">install_aliases</span><span class="token_op">()</span>
<a name="line7"><span class="token_number">   7 </span></a><span class="keyword">from</span> <span class="token_name">builtins</span> <span class="keyword">import</span> <span class="token_name">str</span>
<a name="line8"><span class="token_number">   8 </span></a><span class="keyword">from</span> <span class="token_name">builtins</span> <span class="keyword">import</span> <span class="token_name">range</span>
<a name="line9"><span class="token_number">   9 </span></a><span class="keyword">from</span> <span class="token_name">builtins</span> <span class="keyword">import</span> <span class="token_name">object</span>
<a name="line10"><span class="token_number">  10 </span></a><span class="token_string">r"""</span>
<a name="line11"><span class="token_number">  11 </span></a><span class="token_string">tkGridGUI builds a target python Tkinter GUI graphic user interface using </span>
<a name="line12"><span class="token_number">  12 </span></a><span class="token_string">the grid geometry manager.</span>
<a name="line13"><span class="token_number">  13 </span></a>
<a name="line14"><span class="token_number">  14 </span></a><span class="token_string">The main idea behind tkGridGUI is to allow a fully "wired" python </span>
<a name="line15"><span class="token_number">  15 </span></a><span class="token_string">Tkinter GUI application to be created in minutes.  The users main </span>
<a name="line16"><span class="token_number">  16 </span></a><span class="token_string">responsibility is to add logic to the Tkinter framework created by tkGridGUI.  </span>
<a name="line17"><span class="token_number">  17 </span></a><span class="token_string">tkGridGUI holds structures to create items such as menus, toolbars and statusbars.</span>
<a name="line18"><span class="token_number">  18 </span></a>
<a name="line19"><span class="token_number">  19 </span></a><span class="token_string">TkGridGUI</span>
<a name="line20"><span class="token_number">  20 </span></a><span class="token_string">Copyright (C) 2018  Charlie Taylor</span>
<a name="line21"><span class="token_number">  21 </span></a>
<a name="line22"><span class="token_number">  22 </span></a><span class="token_string">This program is free software: you can redistribute it and/or modify</span>
<a name="line23"><span class="token_number">  23 </span></a><span class="token_string">it under the terms of the GNU General Public License as published by</span>
<a name="line24"><span class="token_number">  24 </span></a><span class="token_string">the Free Software Foundation, either version 3 of the License, or</span>
<a name="line25"><span class="token_number">  25 </span></a><span class="token_string">(at your option) any later version.</span>
<a name="line26"><span class="token_number">  26 </span></a>
<a name="line27"><span class="token_number">  27 </span></a><span class="token_string">This program is distributed in the hope that it will be useful,</span>
<a name="line28"><span class="token_number">  28 </span></a><span class="token_string">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="line29"><span class="token_number">  29 </span></a><span class="token_string">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="line30"><span class="token_number">  30 </span></a><span class="token_string">GNU General Public License for more details.</span>
<a name="line31"><span class="token_number">  31 </span></a>
<a name="line32"><span class="token_number">  32 </span></a><span class="token_string">You should have received a copy of the GNU General Public License</span>
<a name="line33"><span class="token_number">  33 </span></a><span class="token_string">along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="line34"><span class="token_number">  34 </span></a>
<a name="line35"><span class="token_number">  35 </span></a><span class="token_string">-----------------------</span>
<a name="line36"><span class="token_number">  36 </span></a>
<a name="line37"><span class="token_number">  37 </span></a><span class="token_string">"""</span>
<a name="line38"><span class="token_number">  38 </span></a><span class="keyword">import</span> <span class="token_name">os</span>
<a name="line39"><span class="token_number">  39 </span></a><span class="token_name">here</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">abspath</span><span class="token_op">(</span><span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">dirname</span><span class="token_op">(</span><span class="token_name">__file__</span><span class="token_op">))</span>
<a name="line40"><span class="token_number">  40 </span></a>
<a name="line41"><span class="token_number">  41 </span></a><span class="token_name">__author__</span> <span class="token_op">=</span> <span class="token_string">'Charlie Taylor'</span>
<a name="line42"><span class="token_number">  42 </span></a><span class="token_name">__copyright__</span> <span class="token_op">=</span> <span class="token_string">'Copyright (c) 2018 Charlie Taylor'</span>
<a name="line43"><span class="token_number">  43 </span></a><span class="token_name">__license__</span> <span class="token_op">=</span> <span class="token_string">'GPL-3'</span>
<a name="line44"><span class="token_number">  44 </span></a><span class="keyword">exec</span><span class="token_op">(</span> <span class="token_name">open</span><span class="token_op">(</span><span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">join</span><span class="token_op">(</span> <span class="token_name">here</span><span class="token_op">,</span><span class="token_string">'_version.py'</span> <span class="token_op">)).</span><span class="token_name">read</span><span class="token_op">()</span> <span class="token_op">)</span>  <span class="token_comment"># creates local __version__ variable</span>
<a name="line45"><span class="token_number">  45 </span></a><span class="token_name">__email__</span> <span class="token_op">=</span> <span class="token_string">"cet@appliedpython.com"</span>
<a name="line46"><span class="token_number">  46 </span></a><span class="token_name">__status__</span> <span class="token_op">=</span> <span class="token_string">"3 - Alpha"</span> <span class="token_comment"># "3 - Alpha", "4 - Beta", "5 - Production/Stable"</span>
<a name="line47"><span class="token_number">  47 </span></a>
<a name="line48"><span class="token_number">  48 </span></a>
<a name="line49"><span class="token_number">  49 </span></a><span class="keyword">import</span> <span class="token_name">sys</span>
<a name="line50"><span class="token_number">  50 </span></a><span class="keyword">from</span> <span class="token_name">sys</span> <span class="keyword">import</span> <span class="token_name">platform</span>
<a name="line51"><span class="token_number">  51 </span></a>
<a name="line52"><span class="token_number">  52 </span></a><span class="keyword">if</span> <span class="token_name">sys</span><span class="token_op">.</span><span class="token_name">version_info</span> <span class="token_op">&lt;</span> <span class="token_op">(</span><span class="token_number">3</span><span class="token_op">,):</span>
<a name="line53"><span class="token_number">  53 </span></a><span class="text">    </span><span class="keyword">from</span> <span class="token_name">tkSimpleDialog</span> <span class="keyword">import</span> <span class="token_name">Dialog</span>
<a name="line54"><span class="token_number">  54 </span></a><span class="keyword">else</span><span class="token_op">:</span>
<a name="line55"><span class="token_number">  55 </span></a><span class="text">    </span><span class="keyword">from</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">simpledialog</span> <span class="keyword">import</span> <span class="token_name">Dialog</span>
<a name="line56"><span class="token_number">  56 </span></a>
<a name="line57"><span class="token_number">  57 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_op">*</span>
<a name="line58"><span class="token_number">  58 </span></a><span class="keyword">import</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span>
<a name="line59"><span class="token_number">  59 </span></a><span class="keyword">import</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">filedialog</span>
<a name="line60"><span class="token_number">  60 </span></a><span class="keyword">import</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">colorchooser</span>
<a name="line61"><span class="token_number">  61 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">Button</span><span class="token_op">,</span> <span class="token_name">Canvas</span><span class="token_op">,</span> <span class="token_name">Checkbutton</span><span class="token_op">,</span> <span class="token_name">Entry</span><span class="token_op">,</span> <span class="token_name">Frame</span><span class="token_op">,</span> <span class="token_name">Label</span><span class="token_op">,</span> <span class="token_name">LabelFrame</span>
<a name="line62"><span class="token_number">  62 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">Listbox</span><span class="token_op">,</span> <span class="token_name">Message</span><span class="token_op">,</span> <span class="token_name">Radiobutton</span><span class="token_op">,</span> <span class="token_name">Spinbox</span><span class="token_op">,</span> <span class="token_name">Text</span>
<a name="line63"><span class="token_number">  63 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">OptionMenu</span> <span class="token_comment"># ttk OptionMenu seems to be broken</span>
<a name="line64"><span class="token_number">  64 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">ttk</span> <span class="keyword">import</span> <span class="token_name">Combobox</span><span class="token_op">,</span> <span class="token_name">Progressbar</span><span class="token_op">,</span> <span class="token_name">Separator</span><span class="token_op">,</span> <span class="token_name">Treeview</span><span class="token_op">,</span> <span class="token_name">Style</span><span class="token_op">,</span> <span class="token_name">Notebook</span>
<a name="line65"><span class="token_number">  65 </span></a>
<a name="line66"><span class="token_number">  66 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">tkfontchooser</span> <span class="keyword">import</span> <span class="token_name">askfont</span>
<a name="line67"><span class="token_number">  67 </span></a>
<a name="line68"><span class="token_number">  68 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">grid_notebook</span> <span class="keyword">import</span> <span class="token_name">NotebookGridDes</span><span class="token_op">,</span> <span class="token_name">CONTROLS</span><span class="token_op">,</span> <span class="token_name">ContainerControlsL</span><span class="token_op">,</span> <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">,</span> <span class="token_name">CONTROL_COLOR_D</span>
<a name="line69"><span class="token_number">  69 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">target_tk_app_def</span> <span class="keyword">import</span> <span class="token_name">TargetTkAppDef</span> <span class="token_comment"># used to read and save App Definition</span>
<a name="line70"><span class="token_number">  70 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">preview_win</span> <span class="keyword">import</span> <span class="token_name">PreviewWin</span>
<a name="line71"><span class="token_number">  71 </span></a>
<a name="line72"><span class="token_number">  72 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">menu_maker_Dialog</span> <span class="keyword">import</span> <span class="token_name">Menumaker</span>
<a name="line73"><span class="token_number">  73 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">make_py_src</span> <span class="keyword">import</span> <span class="token_name">FormSource</span>
<a name="line74"><span class="token_number">  74 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">make_menu_src</span> <span class="keyword">import</span> <span class="token_name">buildMenuSource</span><span class="token_op">,</span> <span class="token_name">getMenuSource</span>
<a name="line75"><span class="token_number">  75 </span></a>
<a name="line76"><span class="token_number">  76 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">maybe_save_Dialog</span> <span class="keyword">import</span> <span class="token_name">maybe_save_dialog</span>
<a name="line77"><span class="token_number">  77 </span></a>
<a name="line78"><span class="token_number">  78 </span></a><span class="keyword">class</span> <span class="token_name">GridGUI</span><span class="token_op">(</span><span class="token_name">object</span><span class="token_op">):</span>
<a name="line79"><span class="token_number">  79 </span></a><span class="text">    </span><span class="token_string">"""</span>
<a name="line80"><span class="token_number">  80 </span></a><span class="token_string">    tkGridGUI builds a python Tkinter GUI graphic user interface using the grid geometry manager.</span>
<a name="line81"><span class="token_number">  81 </span></a><span class="token_string">    """</span>
<a name="line82"><span class="token_number">  82 </span></a>
<a name="line83"><span class="token_number">  83 </span></a>    <span class="keyword">def</span> <span class="token_name">__init__</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">MainWin</span><span class="token_op">):</span>
<a name="line84"><span class="token_number">  84 </span></a><span class="text">        </span><span class="token_string">"""Inits Tkinter window of GridGUI."""</span>
<a name="line85"><span class="token_number">  85 </span></a>        
<a name="line86"><span class="token_number">  86 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span> <span class="token_op">=</span> <span class="token_name">MainWin</span>
<a name="line87"><span class="token_number">  87 </span></a>        <span class="token_comment">#MainWin.geometry("800x600") #You want the size of the app to be 500x500</span>
<a name="line88"><span class="token_number">  88 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">geometry</span><span class="token_op">(</span> <span class="token_string">'+10+30'</span> <span class="token_op">)</span>
<a name="line89"><span class="token_number">  89 </span></a>        
<a name="line90"><span class="token_number">  90 </span></a>        <span class="keyword">try</span><span class="token_op">:</span>
<a name="line91"><span class="token_number">  91 </span></a><span class="text">            </span><span class="token_name">style</span> <span class="token_op">=</span> <span class="token_name">Style</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">)</span>
<a name="line92"><span class="token_number">  92 </span></a>            <span class="keyword">if</span> <span class="token_string">"win"</span> <span class="token_op">==</span> <span class="token_name">platform</span><span class="token_op">[:</span><span class="token_number">3</span><span class="token_op">]:</span>
<a name="line93"><span class="token_number">  93 </span></a><span class="text">                </span><span class="token_name">style</span><span class="token_op">.</span><span class="token_name">theme_use</span><span class="token_op">(</span><span class="token_string">'vista'</span><span class="token_op">)</span>
<a name="line94"><span class="token_number">  94 </span></a>            <span class="keyword">elif</span> <span class="token_string">"darwin"</span> <span class="keyword">in</span> <span class="token_name">platform</span><span class="token_op">:</span>
<a name="line95"><span class="token_number">  95 </span></a><span class="text">                </span><span class="token_name">style</span><span class="token_op">.</span><span class="token_name">theme_use</span><span class="token_op">(</span><span class="token_string">'clam'</span><span class="token_op">)</span>
<a name="line96"><span class="token_number">  96 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line97"><span class="token_number">  97 </span></a><span class="text">                </span><span class="token_name">style</span><span class="token_op">.</span><span class="token_name">theme_use</span><span class="token_op">(</span><span class="token_string">'clam'</span><span class="token_op">)</span>
<a name="line98"><span class="token_number">  98 </span></a>            <span class="token_name">bg</span> <span class="token_op">=</span> <span class="token_name">style</span><span class="token_op">.</span><span class="token_name">lookup</span><span class="token_op">(</span><span class="token_string">"TLabel"</span><span class="token_op">,</span> <span class="token_string">"background"</span><span class="token_op">)</span>
<a name="line99"><span class="token_number">  99 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">bg</span><span class="token_op">=</span><span class="token_name">bg</span><span class="token_op">)</span>
<a name="line100"><span class="token_number"> 100 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line101"><span class="token_number"> 101 </span></a><span class="text">            </span><span class="keyword">print</span><span class="token_op">(</span><span class="token_string">"OOPS... failed to set style.theme_use... Let's press on."</span><span class="token_op">)</span>
<a name="line102"><span class="token_number"> 102 </span></a>        
<a name="line103"><span class="token_number"> 103 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span> <span class="token_op">=</span> <span class="token_name">MainWin</span>
<a name="line104"><span class="token_number"> 104 </span></a>        
<a name="line105"><span class="token_number"> 105 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">protocol</span><span class="token_op">(</span><span class="token_string">'WM_DELETE_WINDOW'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">cleanupOnQuit</span><span class="token_op">)</span>
<a name="line106"><span class="token_number"> 106 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">allow_subWindows_to_close</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line107"><span class="token_number"> 107 </span></a>        
<a name="line108"><span class="token_number"> 108 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">add_menu_to_MainWin</span><span class="token_op">()</span>
<a name="line109"><span class="token_number"> 109 </span></a>        
<a name="line110"><span class="token_number"> 110 </span></a>        <span class="token_name">topFrame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span> <span class="token_name">MainWin</span> <span class="token_op">)</span> <span class="token_comment"># frame for controls</span>
<a name="line111"><span class="token_number"> 111 </span></a>        <span class="token_comment">#topFrame = tx.ScrolledWindow( MainWin )</span>
<a name="line112"><span class="token_number"> 112 </span></a>        
<a name="line113"><span class="token_number"> 113 </span></a>        <span class="token_name">frame1</span> <span class="token_op">=</span> <span class="token_name">LabelFrame</span><span class="token_op">(</span><span class="token_name">topFrame</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Widgets"</span><span class="token_op">)</span>
<a name="line114"><span class="token_number"> 114 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">place_widget_selection_listbox</span><span class="token_op">(</span> <span class="token_name">frame1</span> <span class="token_op">)</span>
<a name="line115"><span class="token_number"> 115 </span></a>        <span class="token_name">frame1</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">NW</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line116"><span class="token_number"> 116 </span></a>        
<a name="line117"><span class="token_number"> 117 </span></a>        <span class="token_name">frame2</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span> <span class="token_name">topFrame</span> <span class="token_op">)</span> <span class="token_comment"># frame for radio buttons</span>
<a name="line118"><span class="token_number"> 118 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">place_gui_definition_controls</span><span class="token_op">(</span> <span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">MainWin</span> <span class="token_op">)</span>
<a name="line119"><span class="token_number"> 119 </span></a>        <span class="token_name">frame2</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">N</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line120"><span class="token_number"> 120 </span></a>
<a name="line121"><span class="token_number"> 121 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span><span class="token_name">topFrame</span><span class="token_op">)</span> 
<a name="line122"><span class="token_number"> 122 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span> <span class="token_op">=</span> <span class="token_name">NotebookGridDes</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span><span class="token_op">,</span> <span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">num_cols</span><span class="token_op">=</span><span class="token_number">5</span><span class="token_op">,</span> <span class="token_name">num_rows</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line123"><span class="token_number"> 123 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">N</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line124"><span class="token_number"> 124 </span></a>                
<a name="line125"><span class="token_number"> 125 </span></a>        <span class="token_name">topFrame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">BOTH</span><span class="token_op">,</span> <span class="token_name">expand</span><span class="token_op">=</span><span class="token_name">Y</span><span class="token_op">)</span>
<a name="line126"><span class="token_number"> 126 </span></a>        
<a name="line127"><span class="token_number"> 127 </span></a>        <span class="token_comment"># make a Status Bar</span>
<a name="line128"><span class="token_number"> 128 </span></a>        <span class="token_name">statframe</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span><span class="token_name">MainWin</span><span class="token_op">)</span>
<a name="line129"><span class="token_number"> 129 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line130"><span class="token_number"> 130 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'Welcome to TkGridGUI'</span><span class="token_op">)</span>
<a name="line131"><span class="token_number"> 131 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusbar</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">statframe</span><span class="token_op">,</span> <span class="token_name">textvariable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">,</span> 
<a name="line132"><span class="token_number"> 132 </span></a>            <span class="token_name">relief</span><span class="token_op">=</span><span class="token_name">SUNKEN</span><span class="token_op">,</span> <span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line133"><span class="token_number"> 133 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">SW</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">X</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">BOTTOM</span><span class="token_op">)</span>
<a name="line134"><span class="token_number"> 134 </span></a>        <span class="token_name">statframe</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">SW</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">X</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">BOTTOM</span><span class="token_op">)</span>
<a name="line135"><span class="token_number"> 135 </span></a>        
<a name="line136"><span class="token_number"> 136 </span></a>        <span class="token_comment"># Initialize some GridGUI parameters</span>
<a name="line137"><span class="token_number"> 137 </span></a>        
<a name="line138"><span class="token_number"> 138 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileFullName</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line139"><span class="token_number"> 139 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_filePath</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line140"><span class="token_number"> 140 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line141"><span class="token_number"> 141 </span></a>
<a name="line142"><span class="token_number"> 142 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span> <span class="token_op">=</span> <span class="token_name">TargetTkAppDef</span><span class="token_op">(</span> <span class="token_name">name</span><span class="token_op">=</span><span class="token_string">'myApp'</span><span class="token_op">)</span>
<a name="line143"><span class="token_number"> 143 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">=</span> <span class="token_name">None</span> <span class="token_comment"># need to initialize later</span>
<a name="line144"><span class="token_number"> 144 </span></a>        
<a name="line145"><span class="token_number"> 145 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1_Click</span><span class="token_op">(</span> <span class="token_name">None</span> <span class="token_op">)</span> <span class="token_comment"># execute selection logic</span>
<a name="line146"><span class="token_number"> 146 </span></a>
<a name="line147"><span class="token_number"> 147 </span></a>        
<a name="line148"><span class="token_number"> 148 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">in_reading_mode</span> <span class="token_op">=</span> <span class="token_name">False</span> <span class="token_comment"># when True, suppresses some automatic trace actions.</span>
<a name="line149"><span class="token_number"> 149 </span></a>        <span class="keyword">if</span> <span class="token_name">len</span><span class="token_op">(</span> <span class="token_name">sys</span><span class="token_op">.</span><span class="token_name">argv</span> <span class="token_op">)</span> <span class="token_op">==</span> <span class="token_number">2</span><span class="token_op">:</span>
<a name="line150"><span class="token_number"> 150 </span></a><span class="text">            </span><span class="token_name">fName</span> <span class="token_op">=</span> <span class="token_name">sys</span><span class="token_op">.</span><span class="token_name">argv</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">]</span>
<a name="line151"><span class="token_number"> 151 </span></a>            <span class="keyword">if</span> <span class="token_name">fName</span><span class="token_op">.</span><span class="token_name">find</span><span class="token_op">(</span><span class="token_string">'.'</span><span class="token_op">)&lt;</span><span class="token_number">0</span><span class="token_op">:</span>
<a name="line152"><span class="token_number"> 152 </span></a><span class="text">                </span><span class="token_name">fName</span> <span class="token_op">+=</span> <span class="token_string">'.def'</span>
<a name="line153"><span class="token_number"> 153 </span></a>                
<a name="line154"><span class="token_number"> 154 </span></a>            <span class="token_name">fullpath</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">abspath</span><span class="token_op">(</span><span class="token_name">fName</span><span class="token_op">)</span>
<a name="line155"><span class="token_number"> 155 </span></a>            
<a name="line156"><span class="token_number"> 156 </span></a>            <span class="keyword">if</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">isfile</span><span class="token_op">(</span> <span class="token_name">fullpath</span> <span class="token_op">):</span> <span class="token_comment"># if file exists, read it as a definition file</span>
<a name="line157"><span class="token_number"> 157 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">openFile</span><span class="token_op">(</span> <span class="token_name">fName</span><span class="token_op">=</span><span class="token_name">fullpath</span> <span class="token_op">)</span>
<a name="line158"><span class="token_number"> 158 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line159"><span class="token_number"> 159 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'file "%s" does not exist'</span><span class="token_op">%</span><span class="token_name">fName</span><span class="token_op">)</span>
<a name="line160"><span class="token_number"> 160 </span></a>                
<a name="line161"><span class="token_number"> 161 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;&lt;NotebookTabChanged&gt;&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name"><strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong></span><span class="token_op">)</span>
<a name="line162"><span class="token_number"> 162 </span></a>
<a name="line163"><span class="token_number"> 163 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mouse_location</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line164"><span class="token_number"> 164 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Enter&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onMainWindowEnter</span><span class="token_op">)</span>
<a name="line165"><span class="token_number"> 165 </span></a>
<a name="line166"><span class="token_number"> 166 </span></a>    <span class="keyword">def</span> <span class="token_name">onMainWindowEnter</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line167"><span class="token_number"> 167 </span></a><span class="text">        </span><span class="token_string">"""Only track Enter... Want last known location."""</span>
<a name="line168"><span class="token_number"> 168 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mouse_location</span> <span class="token_op">!=</span> <span class="token_string">'main_window'</span><span class="token_op">:</span>
<a name="line169"><span class="token_number"> 169 </span></a><span class="text">            </span><span class="keyword">print</span><span class="token_op">(</span><span class="token_string">'mouse_location = main_window'</span><span class="token_op">)</span>
<a name="line170"><span class="token_number"> 170 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mouse_location</span> <span class="token_op">=</span> <span class="token_string">'main_window'</span>
<a name="line171"><span class="token_number"> 171 </span></a>
<a name="line172"><span class="token_number"> 172 </span></a>    <span class="keyword">def</span> <span class="token_name">refresh_preview_win</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">allow_destroy_children</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">):</span>
<a name="line173"><span class="token_number"> 173 </span></a><span class="text">        </span><span class="token_string">"""</span>
<a name="line174"><span class="token_number"> 174 </span></a><span class="token_string">        Place all of the widgets from grid_notebook onto PreviewWin.</span>
<a name="line175"><span class="token_number"> 175 </span></a><span class="token_string">        May need to delete and rebuild current widgets on PreviewWin.</span>
<a name="line176"><span class="token_number"> 176 </span></a><span class="token_string">        """</span>
<a name="line177"><span class="token_number"> 177 </span></a>            
<a name="line178"><span class="token_number"> 178 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line179"><span class="token_number"> 179 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">=</span> <span class="token_name">PreviewWin</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">grid_gui</span><span class="token_op">=</span><span class="token_name">self</span> <span class="token_op">)</span>
<a name="line180"><span class="token_number"> 180 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">set_PreviewWin</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">)</span>
<a name="line181"><span class="token_number"> 181 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">set_Notebook</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span> <span class="token_op">)</span>
<a name="line182"><span class="token_number"> 182 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line183"><span class="token_number"> 183 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">allow_destroy_children</span><span class="token_op">:</span>
<a name="line184"><span class="token_number"> 184 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">destroy_all_children</span><span class="token_op">()</span>
<a name="line185"><span class="token_number"> 185 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">destroy_all_preview_widgets</span><span class="token_op">()</span>
<a name="line186"><span class="token_number"> 186 </span></a>            
<a name="line187"><span class="token_number"> 187 </span></a>        
<a name="line188"><span class="token_number"> 188 </span></a>        <span class="token_name">widgetL</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">make_complete_list_of_widgets</span><span class="token_op">()</span>
<a name="line189"><span class="token_number"> 189 </span></a>        <span class="token_comment">#print("========== PreviewWin Widget Info.")</span>
<a name="line190"><span class="token_number"> 190 </span></a>        <span class="keyword">for</span> <span class="token_name">w</span> <span class="keyword">in</span> <span class="token_name">widgetL</span><span class="token_op">:</span>
<a name="line191"><span class="token_number"> 191 </span></a>            <span class="token_comment">#print( w )</span>
<a name="line192"><span class="token_number"> 192 </span></a><span class="text">            </span><span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">=</span> <span class="token_name">w</span>
<a name="line193"><span class="token_number"> 193 </span></a>            
<a name="line194"><span class="token_number"> 194 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">maybe_add_component</span><span class="token_op">(</span> <span class="token_name">widget_type</span><span class="token_op">=</span><span class="token_name">widget_type</span><span class="token_op">,</span> 
<a name="line195"><span class="token_number"> 195 </span></a>                                                 <span class="token_name">widget_name</span><span class="token_op">=</span><span class="token_name">widget_name</span><span class="token_op">,</span> 
<a name="line196"><span class="token_number"> 196 </span></a>                                                 <span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_name">tab_label</span><span class="token_op">,</span> 
<a name="line197"><span class="token_number"> 197 </span></a>                                                 <span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">=</span><span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line198"><span class="token_number"> 198 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">show_preview</span><span class="token_op">()</span>
<a name="line199"><span class="token_number"> 199 </span></a>        <span class="token_comment">#print("="*55)</span>
<a name="line200"><span class="token_number"> 200 </span></a>        <span class="token_comment">#print('ref crc_reference =',self.target_app.crc_reference, 'current =', self.target_app.get_model_crc() )</span>
<a name="line201"><span class="token_number"> 201 </span></a>            
<a name="line202"><span class="token_number"> 202 </span></a>        
<a name="line203"><span class="token_number"> 203 </span></a>                
<a name="line204"><span class="token_number"> 204 </span></a>    <span class="keyword">def</span> <span class="token_name">add_menu_to_MainWin</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line205"><span class="token_number"> 205 </span></a>        
<a name="line206"><span class="token_number"> 206 </span></a>        <span class="token_comment"># make menus</span>
<a name="line207"><span class="token_number"> 207 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span> <span class="token_op">=</span> <span class="token_name">Menu</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">relief</span> <span class="token_op">=</span> <span class="token_string">'raised'</span><span class="token_op">,</span> <span class="token_name">bd</span><span class="token_op">=</span><span class="token_number">2</span><span class="token_op">)</span>
<a name="line208"><span class="token_number"> 208 </span></a>
<a name="line209"><span class="token_number"> 209 </span></a>        <span class="token_comment"># create file pulldown menu</span>
<a name="line210"><span class="token_number"> 210 </span></a>        <span class="token_name">fileMenu</span> <span class="token_op">=</span> <span class="token_name">Menu</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">,</span> <span class="token_name">tearoff</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">)</span>
<a name="line211"><span class="token_number"> 211 </span></a>        <span class="token_name">fileMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'New'</span><span class="token_op">,</span> <span class="token_name">command</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">newForm</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+N"</span><span class="token_op">)</span>
<a name="line212"><span class="token_number"> 212 </span></a>        <span class="token_name">fileMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'Open'</span><span class="token_op">,</span> <span class="token_name">command</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">openFile</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+O"</span><span class="token_op">)</span>
<a name="line213"><span class="token_number"> 213 </span></a>        <span class="token_name">fileMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'Save'</span><span class="token_op">,</span> <span class="token_name">command</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+S"</span><span class="token_op">)</span>
<a name="line214"><span class="token_number"> 214 </span></a>        <span class="token_comment">#fileMenu.add('command', label = 'SaveAs', command = self.saveasFile)</span>
<a name="line215"><span class="token_number"> 215 </span></a>        <span class="token_name">fileMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'Exit'</span><span class="token_op">,</span> <span class="token_name">command</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">cleanupOnQuit</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+X"</span><span class="token_op">)</span>
<a name="line216"><span class="token_number"> 216 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'cascade'</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">=</span><span class="token_string">"File"</span><span class="token_op">,</span> <span class="token_name">menu</span><span class="token_op">=</span><span class="token_name">fileMenu</span><span class="token_op">)</span>
<a name="line217"><span class="token_number"> 217 </span></a>
<a name="line218"><span class="token_number"> 218 </span></a>        <span class="token_comment"># create options pulldown menu</span>
<a name="line219"><span class="token_number"> 219 </span></a>        <span class="token_name">optMenu</span> <span class="token_op">=</span> <span class="token_name">Menu</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">,</span> <span class="token_name">tearoff</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">)</span>
<a name="line220"><span class="token_number"> 220 </span></a>        <span class="token_name">optMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'Font to Clipboard'</span><span class="token_op">,</span> <span class="token_name">command</span> <span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton_Select</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+F"</span><span class="token_op">)</span>
<a name="line221"><span class="token_number"> 221 </span></a>        <span class="token_name">optMenu</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_string">'Color to Clipboard'</span><span class="token_op">,</span> <span class="token_name">command</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton_Select</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span><span class="token_name">accelerator</span><span class="token_op">=</span><span class="token_string">"Ctrl+C"</span><span class="token_op">)</span>
<a name="line222"><span class="token_number"> 222 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'cascade'</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">=</span><span class="token_string">"Options"</span><span class="token_op">,</span> <span class="token_name">menu</span><span class="token_op">=</span><span class="token_name">optMenu</span><span class="token_op">)</span>
<a name="line223"><span class="token_number"> 223 </span></a>        
<a name="line224"><span class="token_number"> 224 </span></a>        <span class="token_comment"># bind accelerator keys (need lambda since functions don't have "event" parameter)</span>
<a name="line225"><span class="token_number"> 225 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-N&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">newForm</span><span class="token_op">())</span>
<a name="line226"><span class="token_number"> 226 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-n&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">newForm</span><span class="token_op">())</span>
<a name="line227"><span class="token_number"> 227 </span></a>        
<a name="line228"><span class="token_number"> 228 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-O&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">openFile</span><span class="token_op">())</span>
<a name="line229"><span class="token_number"> 229 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-o&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">openFile</span><span class="token_op">())</span>
<a name="line230"><span class="token_number"> 230 </span></a>        
<a name="line231"><span class="token_number"> 231 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-S&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">())</span>
<a name="line232"><span class="token_number"> 232 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-s&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">())</span>
<a name="line233"><span class="token_number"> 233 </span></a>        
<a name="line234"><span class="token_number"> 234 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-X&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">cleanupOnQuit</span><span class="token_op">())</span>
<a name="line235"><span class="token_number"> 235 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Control-x&gt;"</span><span class="token_op">,</span> <span class="keyword">lambda</span> <span class="token_name">event</span><span class="token_op">:</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">cleanupOnQuit</span><span class="token_op">())</span>
<a name="line236"><span class="token_number"> 236 </span></a>
<a name="line237"><span class="token_number"> 237 </span></a>        <span class="token_comment"># create About menu</span>
<a name="line238"><span class="token_number"> 238 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">=</span><span class="token_string">"About"</span><span class="token_op">,</span> <span class="token_name">command</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">About</span><span class="token_op">)</span>
<a name="line239"><span class="token_number"> 239 </span></a>
<a name="line240"><span class="token_number"> 240 </span></a>        <span class="token_comment"># create Help menu</span>
<a name="line241"><span class="token_number"> 241 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_string">'command'</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">=</span><span class="token_string">"Help"</span><span class="token_op">,</span> <span class="token_name">command</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Help</span><span class="token_op">)</span>
<a name="line242"><span class="token_number"> 242 </span></a>
<a name="line243"><span class="token_number"> 243 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">menu</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">)</span>
<a name="line244"><span class="token_number"> 244 </span></a>
<a name="line245"><span class="token_number"> 245 </span></a>    <span class="keyword">def</span> <span class="token_name">mainOrDialog_Callback</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">varName</span><span class="token_op">,</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">mode</span><span class="token_op">):</span>
<a name="line246"><span class="token_number"> 246 </span></a>        <span class="token_comment">#print( "mainOrDialog_Callback varName, index, mode",varName, index, mode )</span>
<a name="line247"><span class="token_number"> 247 </span></a>        <span class="token_comment">#print( "    new StringVar value =",self.MainWin.mainOrDialog.get() )</span>
<a name="line248"><span class="token_number"> 248 </span></a>        
<a name="line249"><span class="token_number"> 249 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line250"><span class="token_number"> 250 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">==</span> <span class="token_string">'dialog'</span><span class="token_op">:</span>
<a name="line251"><span class="token_number"> 251 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">==</span> <span class="token_string">"yes"</span><span class="token_op">:</span>
<a name="line252"><span class="token_number"> 252 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">remove_mock_OK_Cancel_Buttons</span><span class="token_op">()</span>
<a name="line253"><span class="token_number"> 253 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line254"><span class="token_number"> 254 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_mock_OK_Cancel_Buttons</span><span class="token_op">()</span>
<a name="line255"><span class="token_number"> 255 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line256"><span class="token_number"> 256 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">remove_mock_OK_Cancel_Buttons</span><span class="token_op">()</span>
<a name="line257"><span class="token_number"> 257 </span></a>    
<a name="line258"><span class="token_number"> 258 </span></a>    <span class="keyword">def</span> <span class="token_name">place_gui_definition_controls</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">MainWin</span> <span class="token_op">):</span>
<a name="line259"><span class="token_number"> 259 </span></a>        
<a name="line260"><span class="token_number"> 260 </span></a>        <span class="token_comment"># show option for Main Window or Dialog</span>
<a name="line261"><span class="token_number"> 261 </span></a><span class="text">        </span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">=</span><span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line262"><span class="token_number"> 262 </span></a>        <span class="token_name">lbframe</span> <span class="token_op">=</span> <span class="token_name">LabelFrame</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"GUI Type"</span><span class="token_op">)</span>
<a name="line263"><span class="token_number"> 263 </span></a>        <span class="token_name">lbframe</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line264"><span class="token_number"> 264 </span></a>
<a name="line265"><span class="token_number"> 265 </span></a>        <span class="token_name">b</span> <span class="token_op">=</span> <span class="token_name">Radiobutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Main Window"</span><span class="token_op">,</span> <span class="token_name">value</span><span class="token_op">=</span><span class="token_string">'main'</span><span class="token_op">,</span> <span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">)</span>
<a name="line266"><span class="token_number"> 266 </span></a>        <span class="token_name">b</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line267"><span class="token_number"> 267 </span></a>        <span class="token_name">b</span> <span class="token_op">=</span> <span class="token_name">Radiobutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Dialog"</span><span class="token_op">,</span> <span class="token_name">value</span><span class="token_op">=</span><span class="token_string">'dialog'</span><span class="token_op">,</span> <span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">)</span>
<a name="line268"><span class="token_number"> 268 </span></a>        <span class="token_name">b</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line269"><span class="token_number"> 269 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'main'</span><span class="token_op">)</span>
<a name="line270"><span class="token_number"> 270 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mainOrDialog_traceName</span> <span class="token_op">=</span> <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">.</span><span class="token_name">trace_variable</span><span class="token_op">(</span><span class="token_string">"w"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mainOrDialog_Callback</span><span class="token_op">)</span>
<a name="line271"><span class="token_number"> 271 </span></a>        
<a name="line272"><span class="token_number"> 272 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Hide OK Btn"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line273"><span class="token_number"> 273 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">E</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line274"><span class="token_number"> 274 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line275"><span class="token_number"> 275 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line276"><span class="token_number"> 276 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line277"><span class="token_number"> 277 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_traceName</span> <span class="token_op">=</span> <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">trace_variable</span><span class="token_op">(</span><span class="token_string">"w"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_Callback</span><span class="token_op">)</span>
<a name="line278"><span class="token_number"> 278 </span></a>        
<a name="line279"><span class="token_number"> 279 </span></a>        <span class="token_comment"># show checkbox for menu and status bar</span>
<a name="line280"><span class="token_number"> 280 </span></a>        <span class="token_name">lbframe</span> <span class="token_op">=</span> <span class="token_name">LabelFrame</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Window Options"</span><span class="token_op">)</span>
<a name="line281"><span class="token_number"> 281 </span></a>        <span class="token_name">lbframe</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line282"><span class="token_number"> 282 </span></a>        
<a name="line283"><span class="token_number"> 283 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Main Menu"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line284"><span class="token_number"> 284 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line285"><span class="token_number"> 285 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line286"><span class="token_number"> 286 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line287"><span class="token_number"> 287 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line288"><span class="token_number"> 288 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuChkBox_traceName</span> <span class="token_op">=</span> <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">trace_variable</span><span class="token_op">(</span><span class="token_string">"w"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">menuChkBox_Callback</span><span class="token_op">)</span>
<a name="line289"><span class="token_number"> 289 </span></a>        
<a name="line290"><span class="token_number"> 290 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Status Bar"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line291"><span class="token_number"> 291 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line292"><span class="token_number"> 292 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line293"><span class="token_number"> 293 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line294"><span class="token_number"> 294 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line295"><span class="token_number"> 295 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_traceName</span> <span class="token_op">=</span> <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">trace_variable</span><span class="token_op">(</span><span class="token_string">"w"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_Callback</span><span class="token_op">)</span>
<a name="line296"><span class="token_number"> 296 </span></a>        
<a name="line297"><span class="token_number"> 297 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Resizable"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line298"><span class="token_number"> 298 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line299"><span class="token_number"> 299 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line300"><span class="token_number"> 300 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"yes"</span><span class="token_op">)</span>
<a name="line301"><span class="token_number"> 301 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line302"><span class="token_number"> 302 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">resizableChkBox_traceName</span> <span class="token_op">=</span> <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">trace_variable</span><span class="token_op">(</span><span class="token_string">"w"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">resizableChkBox_Callback</span><span class="token_op">)</span>
<a name="line303"><span class="token_number"> 303 </span></a>        
<a name="line304"><span class="token_number"> 304 </span></a>        <span class="token_comment"># show choices for standard dialogs</span>
<a name="line305"><span class="token_number"> 305 </span></a>        <span class="token_name">lbframe</span> <span class="token_op">=</span> <span class="token_name">LabelFrame</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Standard Dialogs"</span><span class="token_op">)</span>
<a name="line306"><span class="token_number"> 306 </span></a>        <span class="token_name">lbframe</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line307"><span class="token_number"> 307 </span></a>
<a name="line308"><span class="token_number"> 308 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Messages"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line309"><span class="token_number"> 309 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">E</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line310"><span class="token_number"> 310 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line311"><span class="token_number"> 311 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line312"><span class="token_number"> 312 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line313"><span class="token_number"> 313 </span></a>        
<a name="line314"><span class="token_number"> 314 </span></a>
<a name="line315"><span class="token_number"> 315 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Color Choose"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line316"><span class="token_number"> 316 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">E</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line317"><span class="token_number"> 317 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line318"><span class="token_number"> 318 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line319"><span class="token_number"> 319 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line320"><span class="token_number"> 320 </span></a>
<a name="line321"><span class="token_number"> 321 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"File Open/Save"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line322"><span class="token_number"> 322 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">E</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line323"><span class="token_number"> 323 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line324"><span class="token_number"> 324 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line325"><span class="token_number"> 325 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line326"><span class="token_number"> 326 </span></a>
<a name="line327"><span class="token_number"> 327 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox</span> <span class="token_op">=</span> <span class="token_name">Checkbutton</span><span class="token_op">(</span><span class="token_name">lbframe</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Alarm Handler"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_string">"15"</span><span class="token_op">)</span>
<a name="line328"><span class="token_number"> 328 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">E</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line329"><span class="token_number"> 329 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox_StringVar</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line330"><span class="token_number"> 330 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line331"><span class="token_number"> 331 </span></a>        <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox</span><span class="token_op">.</span><span class="token_name">configure</span><span class="token_op">(</span><span class="token_name">variable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox_StringVar</span><span class="token_op">,</span> <span class="token_name">onvalue</span><span class="token_op">=</span><span class="token_string">"yes"</span><span class="token_op">,</span> <span class="token_name">offvalue</span><span class="token_op">=</span><span class="token_string">"no"</span><span class="token_op">)</span>
<a name="line332"><span class="token_number"> 332 </span></a>        
<a name="line333"><span class="token_number"> 333 </span></a>        <span class="token_comment"># put color picker button</span>
<a name="line334"><span class="token_number"> 334 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span> <span class="token_op">=</span> <span class="token_name">Button</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Put Color on Clipboard"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">18</span><span class="token_op">)</span>
<a name="line335"><span class="token_number"> 335 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line336"><span class="token_number"> 336 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton_Click</span><span class="token_op">)</span>
<a name="line337"><span class="token_number"> 337 </span></a>        
<a name="line338"><span class="token_number"> 338 </span></a>        <span class="token_comment"># put Font picker button</span>
<a name="line339"><span class="token_number"> 339 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton</span> <span class="token_op">=</span> <span class="token_name">Button</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Put Font on Clipboard"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">18</span><span class="token_op">)</span>
<a name="line340"><span class="token_number"> 340 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line341"><span class="token_number"> 341 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton_Click</span><span class="token_op">)</span>
<a name="line342"><span class="token_number"> 342 </span></a>        
<a name="line343"><span class="token_number"> 343 </span></a>        <span class="token_comment"># put All widgets on notebook </span>
<a name="line344"><span class="token_number"> 344 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton = Button(frame2, text="Debug All Widgets", width=18)</span>
<a name="line345"><span class="token_number"> 345 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton.pack(anchor=W, side=TOP)</span>
<a name="line346"><span class="token_number"> 346 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton.bind("&lt;ButtonRelease-1&gt;", self.PlaceAllWidgetsButton_Click)</span>
<a name="line347"><span class="token_number"> 347 </span></a>        
<a name="line348"><span class="token_number"> 348 </span></a>        <span class="token_comment"># append new row or column to current notebook tab</span>
<a name="line349"><span class="token_number"> 349 </span></a>        <span class="token_name">add_frame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span> <span class="token_name">frame2</span> <span class="token_op">)</span>
<a name="line350"><span class="token_number"> 350 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewRowButton</span> <span class="token_op">=</span> <span class="token_name">Button</span><span class="token_op">(</span><span class="token_name">add_frame</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Add Row"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line351"><span class="token_number"> 351 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewRowButton</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line352"><span class="token_number"> 352 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewRowButton</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewRowButton_Click</span><span class="token_op">)</span>
<a name="line353"><span class="token_number"> 353 </span></a>
<a name="line354"><span class="token_number"> 354 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewColButton</span> <span class="token_op">=</span> <span class="token_name">Button</span><span class="token_op">(</span><span class="token_name">add_frame</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_string">"Add Col"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line355"><span class="token_number"> 355 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewColButton</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line356"><span class="token_number"> 356 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewColButton</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">AddNewColButton_Click</span><span class="token_op">)</span>
<a name="line357"><span class="token_number"> 357 </span></a>        <span class="token_name">add_frame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">)</span>
<a name="line358"><span class="token_number"> 358 </span></a>
<a name="line359"><span class="token_number"> 359 </span></a>        <span class="token_comment"># dup_widget_label can be used for set_placement_widget_label, or widget duplication</span>
<a name="line360"><span class="token_number"> 360 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_desc</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">16</span><span class="token_op">)</span>
<a name="line361"><span class="token_number"> 361 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_desc</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"\nduplicate widget\nand its properties"</span>
<a name="line362"><span class="token_number"> 362 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_desc</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line363"><span class="token_number"> 363 </span></a>        
<a name="line364"><span class="token_number"> 364 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">frame2</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">16</span><span class="token_op">)</span>        
<a name="line365"><span class="token_number"> 365 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"\n\n"</span>
<a name="line366"><span class="token_number"> 366 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_string">"Courier"</span><span class="token_op">,</span> <span class="token_number">8</span><span class="token_op">,</span> <span class="token_string">"normal"</span><span class="token_op">)</span>
<a name="line367"><span class="token_number"> 367 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"groove"</span>
<a name="line368"><span class="token_number"> 368 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line369"><span class="token_number"> 369 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_plain_bg</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span>
<a name="line370"><span class="token_number"> 370 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line371"><span class="token_number"> 371 </span></a>        
<a name="line372"><span class="token_number"> 372 </span></a>        <span class="token_comment"># Refresh Preview Window</span>
<a name="line373"><span class="token_number"> 373 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton = Button(frame2, text="Refresh Preview", width=18)</span>
<a name="line374"><span class="token_number"> 374 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton.pack(anchor=W, side=TOP)</span>
<a name="line375"><span class="token_number"> 375 </span></a>        <span class="token_comment">#self.PlaceAllWidgetsButton.bind("&lt;ButtonRelease-1&gt;", self.GeneralDebugButton_Click)</span>
<a name="line376"><span class="token_number"> 376 </span></a>
<a name="line377"><span class="token_number"> 377 </span></a>    <span class="keyword">def</span> <span class="token_name">GeneralDebugButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line378"><span class="token_number"> 378 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line379"><span class="token_number"> 379 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line380"><span class="token_number"> 380 </span></a>
<a name="line381"><span class="token_number"> 381 </span></a>    <span class="keyword">def</span> <span class="token_name">AddNewRowButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line382"><span class="token_number"> 382 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">append_row</span><span class="token_op">()</span>
<a name="line383"><span class="token_number"> 383 </span></a>        
<a name="line384"><span class="token_number"> 384 </span></a>    <span class="keyword">def</span> <span class="token_name">AddNewColButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line385"><span class="token_number"> 385 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">append_column</span><span class="token_op">()</span>
<a name="line386"><span class="token_number"> 386 </span></a>        
<a name="line387"><span class="token_number"> 387 </span></a>
<a name="line388"><span class="token_number"> 388 </span></a>    <span class="keyword">def</span> <span class="token_name">PlaceAllWidgetsButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line389"><span class="token_number"> 389 </span></a><span class="text">        </span><span class="token_string">"""As debug tool, show all widgets in Notebook"""</span>
<a name="line390"><span class="token_number"> 390 </span></a>        
<a name="line391"><span class="token_number"> 391 </span></a>        <span class="token_name">saved_sel</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span>
<a name="line392"><span class="token_number"> 392 </span></a>        <span class="token_name">saved_tab</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line393"><span class="token_number"> 393 </span></a>        
<a name="line394"><span class="token_number"> 394 </span></a>        <span class="token_name">row</span> <span class="token_op">=</span> <span class="token_number">1</span> <span class="token_comment"># row_interface</span>
<a name="line395"><span class="token_number"> 395 </span></a>        <span class="token_name">col</span> <span class="token_op">=</span> <span class="token_number">1</span> <span class="token_comment"># col_interface</span>
<a name="line396"><span class="token_number"> 396 </span></a>        
<a name="line397"><span class="token_number"> 397 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_string">"Main"</span> <span class="token_op">)</span>
<a name="line398"><span class="token_number"> 398 </span></a>        
<a name="line399"><span class="token_number"> 399 </span></a>        <span class="keyword">for</span> <span class="token_name">wname</span><span class="token_op">,</span> <span class="token_name">wcolor</span> <span class="keyword">in</span> <span class="token_name">CONTROLS</span><span class="token_op">:</span>
<a name="line400"><span class="token_number"> 400 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">wname</span> <span class="token_op">)</span>
<a name="line401"><span class="token_number"> 401 </span></a>            <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_string">"Main"</span><span class="token_op">,</span> <span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line402"><span class="token_number"> 402 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line403"><span class="token_number"> 403 </span></a>            
<a name="line404"><span class="token_number"> 404 </span></a>            <span class="keyword">if</span> <span class="token_name">wname</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">:</span>
<a name="line405"><span class="token_number"> 405 </span></a><span class="text">                </span><span class="token_name">new_tab_name</span> <span class="token_op">=</span> <span class="token_name">wname</span> <span class="token_op">+</span> <span class="token_string">"_%i"</span><span class="token_op">%(</span><span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">wname</span><span class="token_op">]</span> <span class="token_op">-</span><span class="token_number">1</span><span class="token_op">,)</span>
<a name="line406"><span class="token_number"> 406 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_name">new_tab_name</span> <span class="token_op">)</span>
<a name="line407"><span class="token_number"> 407 </span></a>                
<a name="line408"><span class="token_number"> 408 </span></a>                <span class="token_comment"># place some widgets on ContainerControlsL tab</span>
<a name="line409"><span class="token_number"> 409 </span></a>                <span class="keyword">if</span> <span class="token_name">wname</span> <span class="token_op">==</span> <span class="token_string">'RadioGroup'</span><span class="token_op">:</span>
<a name="line410"><span class="token_number"> 410 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_string">"Label"</span> <span class="token_op">)</span>
<a name="line411"><span class="token_number"> 411 </span></a>                    <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">new_tab_name</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line412"><span class="token_number"> 412 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line413"><span class="token_number"> 413 </span></a>                    
<a name="line414"><span class="token_number"> 414 </span></a>                    <span class="keyword">for</span> <span class="token_name">n_radio</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span><span class="token_number">3</span><span class="token_op">):</span>
<a name="line415"><span class="token_number"> 415 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_string">"Radiobutton"</span> <span class="token_op">)</span>
<a name="line416"><span class="token_number"> 416 </span></a>                        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">new_tab_name</span><span class="token_op">,</span> <span class="token_number">3</span><span class="token_op">+</span><span class="token_name">n_radio</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line417"><span class="token_number"> 417 </span></a>                        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line418"><span class="token_number"> 418 </span></a>                        
<a name="line419"><span class="token_number"> 419 </span></a>                    
<a name="line420"><span class="token_number"> 420 </span></a>                <span class="keyword">else</span><span class="token_op">:</span>
<a name="line421"><span class="token_number"> 421 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_string">"Button"</span> <span class="token_op">)</span>
<a name="line422"><span class="token_number"> 422 </span></a>                    <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">new_tab_name</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line423"><span class="token_number"> 423 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line424"><span class="token_number"> 424 </span></a>                    
<a name="line425"><span class="token_number"> 425 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_string">"Label"</span> <span class="token_op">)</span>
<a name="line426"><span class="token_number"> 426 </span></a>                    <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">new_tab_name</span><span class="token_op">,</span> <span class="token_number">3</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line427"><span class="token_number"> 427 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line428"><span class="token_number"> 428 </span></a>                    
<a name="line429"><span class="token_number"> 429 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_string">"Entry"</span> <span class="token_op">)</span>
<a name="line430"><span class="token_number"> 430 </span></a>                    <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">new_tab_name</span><span class="token_op">,</span> <span class="token_number">4</span><span class="token_op">,</span> <span class="token_number">2</span><span class="token_op">)]</span><span class="token_comment"># row_interface, col_interface</span>
<a name="line431"><span class="token_number"> 431 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">(</span> <span class="token_name">event</span> <span class="token_op">)</span>
<a name="line432"><span class="token_number"> 432 </span></a>                    
<a name="line433"><span class="token_number"> 433 </span></a>                <span class="token_comment"># restore notebook to Main tab</span>
<a name="line434"><span class="token_number"> 434 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_string">"Main"</span> <span class="token_op">)</span>
<a name="line435"><span class="token_number"> 435 </span></a>                
<a name="line436"><span class="token_number"> 436 </span></a>            
<a name="line437"><span class="token_number"> 437 </span></a>            <span class="token_name">col</span> <span class="token_op">+=</span> <span class="token_number">1</span>
<a name="line438"><span class="token_number"> 438 </span></a>            <span class="keyword">if</span> <span class="token_name">col</span> <span class="token_op">%</span> <span class="token_number">5</span> <span class="token_op">==</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line439"><span class="token_number"> 439 </span></a><span class="text">                </span><span class="token_name">col</span> <span class="token_op">=</span> <span class="token_number">1</span>
<a name="line440"><span class="token_number"> 440 </span></a>                <span class="token_name">row</span> <span class="token_op">+=</span> <span class="token_number">1</span>
<a name="line441"><span class="token_number"> 441 </span></a>                
<a name="line442"><span class="token_number"> 442 </span></a>        <span class="token_comment"># Return Listbox_1 selection to original value</span>
<a name="line443"><span class="token_number"> 443 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">saved_sel</span> <span class="token_op">)</span>
<a name="line444"><span class="token_number"> 444 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_name">saved_tab</span> <span class="token_op">)</span>
<a name="line445"><span class="token_number"> 445 </span></a>        
<a name="line446"><span class="token_number"> 446 </span></a>    <span class="keyword">def</span> <span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">msg</span><span class="token_op">):</span>
<a name="line447"><span class="token_number"> 447 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">msg</span> <span class="token_op">)</span>
<a name="line448"><span class="token_number"> 448 </span></a>
<a name="line449"><span class="token_number"> 449 </span></a>    <span class="keyword">def</span> <span class="token_name">gray_out_listbox</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">omit_list</span><span class="token_op">=</span><span class="token_name">None</span><span class="token_op">):</span>
<a name="line450"><span class="token_number"> 450 </span></a><span class="text">        </span><span class="token_string">"""if omit_list is None, gray all."""</span>
<a name="line451"><span class="token_number"> 451 </span></a>        <span class="keyword">if</span> <span class="token_name">omit_list</span> <span class="keyword">is</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line452"><span class="token_number"> 452 </span></a><span class="text">            </span><span class="token_name">omit_list</span> <span class="token_op">=</span> <span class="token_op">[]</span>
<a name="line453"><span class="token_number"> 453 </span></a>            
<a name="line454"><span class="token_number"> 454 </span></a>        <span class="token_name">n</span> <span class="token_op">=</span> <span class="token_op">-</span><span class="token_number">1</span>
<a name="line455"><span class="token_number"> 455 </span></a>        <span class="keyword">for</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_op">(</span><span class="token_name">wname</span><span class="token_op">,</span> <span class="token_name">wcolor</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">enumerate</span><span class="token_op">(</span><span class="token_name">CONTROLS</span><span class="token_op">):</span>
<a name="line456"><span class="token_number"> 456 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">wname</span> <span class="keyword">in</span> <span class="token_name">omit_list</span><span class="token_op">:</span>
<a name="line457"><span class="token_number"> 457 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">itemconfig</span><span class="token_op">(</span><span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">fg</span><span class="token_op">=</span><span class="token_string">"black"</span><span class="token_op">)</span>
<a name="line458"><span class="token_number"> 458 </span></a>                <span class="token_name">n</span> <span class="token_op">=</span> <span class="token_name">index</span>
<a name="line459"><span class="token_number"> 459 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line460"><span class="token_number"> 460 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">itemconfig</span><span class="token_op">(</span><span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">fg</span><span class="token_op">=</span><span class="token_string">"gray"</span><span class="token_op">)</span>
<a name="line461"><span class="token_number"> 461 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">selection_clear</span><span class="token_op">(</span><span class="token_name">index</span><span class="token_op">)</span>
<a name="line462"><span class="token_number"> 462 </span></a>            
<a name="line463"><span class="token_number"> 463 </span></a>        <span class="keyword">if</span> <span class="token_name">n</span> <span class="token_op">&gt;=</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line464"><span class="token_number"> 464 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">selection_set</span><span class="token_op">(</span><span class="token_name">n</span><span class="token_op">)</span>
<a name="line465"><span class="token_number"> 465 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1_Click</span><span class="token_op">(</span> <span class="token_name">None</span> <span class="token_op">)</span> <span class="token_comment"># event is not used in Listbox_1_Click</span>
<a name="line466"><span class="token_number"> 466 </span></a>    
<a name="line467"><span class="token_number"> 467 </span></a>    <span class="keyword">def</span> <span class="token_name">restore_black_listbox</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line468"><span class="token_number"> 468 </span></a><span class="text">        </span><span class="token_string">"""Make sure all listbox options show up for all other tabs."""</span>
<a name="line469"><span class="token_number"> 469 </span></a>        
<a name="line470"><span class="token_number"> 470 </span></a>        <span class="token_name">n</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line471"><span class="token_number"> 471 </span></a>        <span class="keyword">for</span> <span class="token_name">i</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">curselection</span><span class="token_op">():</span>
<a name="line472"><span class="token_number"> 472 </span></a><span class="text">            </span><span class="token_name">n</span> <span class="token_op">=</span> <span class="token_name">i</span>
<a name="line473"><span class="token_number"> 473 </span></a>            <span class="keyword">break</span> <span class="token_comment"># set to 1st value encountered</span>
<a name="line474"><span class="token_number"> 474 </span></a>    
<a name="line475"><span class="token_number"> 475 </span></a>        <span class="keyword">for</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_op">(</span><span class="token_name">wname</span><span class="token_op">,</span> <span class="token_name">wcolor</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">enumerate</span><span class="token_op">(</span><span class="token_name">CONTROLS</span><span class="token_op">):</span>
<a name="line476"><span class="token_number"> 476 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">itemconfig</span><span class="token_op">(</span><span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">fg</span><span class="token_op">=</span><span class="token_string">"black"</span><span class="token_op">)</span>
<a name="line477"><span class="token_number"> 477 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">selection_clear</span><span class="token_op">(</span><span class="token_name">index</span><span class="token_op">)</span>
<a name="line478"><span class="token_number"> 478 </span></a>            
<a name="line479"><span class="token_number"> 479 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">selection_set</span><span class="token_op">(</span><span class="token_name">n</span><span class="token_op">)</span>
<a name="line480"><span class="token_number"> 480 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1_Click</span><span class="token_op">(</span> <span class="token_name">None</span> <span class="token_op">)</span> <span class="token_comment"># event is not used in Listbox_1_Click</span>
<a name="line481"><span class="token_number"> 481 </span></a>
<a name="line482"><span class="token_number"> 482 </span></a>    <span class="keyword">def</span> <span class="token_name">select_preview_tab</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_name_inp</span><span class="token_op">):</span>
<a name="line483"><span class="token_number"> 483 </span></a>            
<a name="line484"><span class="token_number"> 484 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line485"><span class="token_number"> 485 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># make PreviewWin if not already done.</span>
<a name="line486"><span class="token_number"> 486 </span></a>            
<a name="line487"><span class="token_number"> 487 </span></a>        <span class="token_name">tab_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span><span class="token_name">tab_name_inp</span><span class="token_op">]</span>
<a name="line488"><span class="token_number"> 488 </span></a>        <span class="token_name">notebook_name</span> <span class="token_op">=</span> <span class="token_name">tab_comp</span><span class="token_op">.</span><span class="token_name">tab_label</span>
<a name="line489"><span class="token_number"> 489 </span></a>        <span class="token_name">nb_obj</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">notebook_name</span> <span class="token_op">]</span>
<a name="line490"><span class="token_number"> 490 </span></a>        
<a name="line491"><span class="token_number"> 491 </span></a>        <span class="token_comment"># get index of tab on preview_win        </span>
<a name="line492"><span class="token_number"> 492 </span></a>        <span class="keyword">for</span> <span class="token_name">itab</span><span class="token_op">,</span> <span class="token_op">(</span><span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">,</span> <span class="token_name">tab_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">enumerate</span><span class="token_op">(</span> <span class="token_name">nb_obj</span><span class="token_op">.</span><span class="token_name">tab_nameL</span> <span class="token_op">):</span>
<a name="line493"><span class="token_number"> 493 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">tab_name_inp</span> <span class="token_op">==</span> <span class="token_name">tab_name</span><span class="token_op">:</span>
<a name="line494"><span class="token_number"> 494 </span></a><span class="text">                </span><span class="token_name">nb_obj</span><span class="token_op">.</span><span class="token_name">pw_widget</span><span class="token_op">.</span><span class="token_name">native_widget</span><span class="token_op">.</span><span class="token_name">select</span><span class="token_op">(</span> <span class="token_name">itab</span> <span class="token_op">)</span>
<a name="line495"><span class="token_number"> 495 </span></a>                <span class="token_comment">#print('grid_gui.<strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong>: set PreviewWin Tab to:', itab)</span>
<a name="line496"><span class="token_number"> 496 </span></a>                <span class="keyword">break</span>
<a name="line497"><span class="token_number"> 497 </span></a>
<a name="line498"><span class="token_number"> 498 </span></a>    <span class="keyword">def</span> <span class="token_name"><strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong></span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line499"><span class="token_number"> 499 </span></a><span class="text">        </span><span class="token_name">nb</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">notebook</span>
<a name="line500"><span class="token_number"> 500 </span></a>        <span class="token_comment">#i = nb.index(nb.select())</span>
<a name="line501"><span class="token_number"> 501 </span></a>        <span class="token_name">text</span> <span class="token_op">=</span> <span class="token_name">nb</span><span class="token_op">.</span><span class="token_name">tab</span><span class="token_op">(</span><span class="token_name">nb</span><span class="token_op">.</span><span class="token_name">select</span><span class="token_op">(),</span> <span class="token_string">"text"</span><span class="token_op">)</span>
<a name="line502"><span class="token_number"> 502 </span></a>        <span class="token_comment">#print("GridGUI Notebook Tab Set to:", text )</span>
<a name="line503"><span class="token_number"> 503 </span></a>
<a name="line504"><span class="token_number"> 504 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span> <span class="token_name">state</span><span class="token_op">=</span><span class="token_name">NORMAL</span> <span class="token_op">)</span>
<a name="line505"><span class="token_number"> 505 </span></a>
<a name="line506"><span class="token_number"> 506 </span></a>        <span class="token_comment"># gray out some listbox options for RadioGroup</span>
<a name="line507"><span class="token_number"> 507 </span></a>        <span class="keyword">if</span> <span class="token_name">text</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'RadioGroup'</span><span class="token_op">):</span>
<a name="line508"><span class="token_number"> 508 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">gray_out_listbox</span><span class="token_op">(</span> <span class="token_name">omit_list</span><span class="token_op">=(</span><span class="token_string">"Radiobutton"</span><span class="token_op">,</span><span class="token_string">"Label"</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line509"><span class="token_number"> 509 </span></a>                        
<a name="line510"><span class="token_number"> 510 </span></a>        <span class="keyword">elif</span> <span class="token_name">text</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Notebook'</span><span class="token_op">):</span>
<a name="line511"><span class="token_number"> 511 </span></a>            <span class="token_comment">#print('=========&gt;  Need to add Notebook logic.')</span>
<a name="line512"><span class="token_number"> 512 </span></a>            
<a name="line513"><span class="token_number"> 513 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">gray_out_listbox</span><span class="token_op">(</span> <span class="token_name">omit_list</span><span class="token_op">=</span><span class="token_name">None</span> <span class="token_op">)</span>
<a name="line514"><span class="token_number"> 514 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_placement_widget_label</span><span class="token_op">(</span> <span class="token_string">'Tab'</span> <span class="token_op">)</span>
<a name="line515"><span class="token_number"> 515 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_string">"Only Tabs can be added to Notebook"</span> <span class="token_op">)</span>
<a name="line516"><span class="token_number"> 516 </span></a>            
<a name="line517"><span class="token_number"> 517 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line518"><span class="token_number"> 518 </span></a>            <span class="token_comment"># Make sure all listbox options show up for all other tabs.</span>
<a name="line519"><span class="token_number"> 519 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">restore_black_listbox</span><span class="token_op">()</span>
<a name="line520"><span class="token_number"> 520 </span></a>
<a name="line521"><span class="token_number"> 521 </span></a>        <span class="token_comment"># Cause PreviewWin to switch to same Tab</span>
<a name="line522"><span class="token_number"> 522 </span></a>        <span class="keyword">if</span> <span class="token_name">text</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Tab_'</span><span class="token_op">):</span>
<a name="line523"><span class="token_number"> 523 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">select_preview_tab</span><span class="token_op">(</span> <span class="token_name">text</span> <span class="token_op">)</span> <span class="token_comment"># text is tab_name            </span>
<a name="line524"><span class="token_number"> 524 </span></a>            
<a name="line525"><span class="token_number"> 525 </span></a>
<a name="line526"><span class="token_number"> 526 </span></a>    <span class="keyword">def</span> <span class="token_name">place_widget_selection_listbox</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">frame1</span><span class="token_op">):</span>
<a name="line527"><span class="token_number"> 527 </span></a><span class="text">        </span><span class="token_string">"""frame1 in topFrame contains Widgets selection ListBox"""</span>
<a name="line528"><span class="token_number"> 528 </span></a>        
<a name="line529"><span class="token_number"> 529 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">=</span><span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line530"><span class="token_number"> 530 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'Button'</span><span class="token_op">)</span>
<a name="line531"><span class="token_number"> 531 </span></a>        
<a name="line532"><span class="token_number"> 532 </span></a>        <span class="token_comment"># Notebooks handled seperately</span>
<a name="line533"><span class="token_number"> 533 </span></a>
<a name="line534"><span class="token_number"> 534 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span> <span class="token_op">=</span> <span class="token_name">Listbox</span><span class="token_op">(</span><span class="token_name">frame1</span><span class="token_op">,</span><span class="token_name">width</span><span class="token_op">=</span><span class="token_number">15</span> <span class="token_op">,</span><span class="token_name">height</span><span class="token_op">=</span><span class="token_name">str</span><span class="token_op">(</span><span class="token_name">len</span><span class="token_op">(</span><span class="token_name">CONTROLS</span><span class="token_op">)),</span> <span class="token_name">selectmode</span><span class="token_op">=</span><span class="token_string">'single'</span><span class="token_op">)</span><span class="token_comment">#, selectmode="extended")</span>
<a name="line535"><span class="token_number"> 535 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1_Click</span><span class="token_op">)</span>
<a name="line536"><span class="token_number"> 536 </span></a>
<a name="line537"><span class="token_number"> 537 </span></a>        <span class="keyword">for</span> <span class="token_name">wname</span><span class="token_op">,</span> <span class="token_name">wcolor</span> <span class="keyword">in</span> <span class="token_name">CONTROLS</span><span class="token_op">:</span>
<a name="line538"><span class="token_number"> 538 </span></a>            <span class="token_comment">#b = Radiobutton(frame1, text=text, value=cont, variable=self.MainWin.placementWidgetType_svar)</span>
<a name="line539"><span class="token_number"> 539 </span></a>            <span class="token_comment">#b.pack(anchor=W)</span>
<a name="line540"><span class="token_number"> 540 </span></a>            <span class="token_comment">#print("inserting wname into Listbox_1 "+wname)</span>
<a name="line541"><span class="token_number"> 541 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">insert</span><span class="token_op">(</span><span class="token_name">END</span><span class="token_op">,</span> <span class="token_name">wname</span><span class="token_op">)</span>
<a name="line542"><span class="token_number"> 542 </span></a>        
<a name="line543"><span class="token_number"> 543 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line544"><span class="token_number"> 544 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">select_set</span><span class="token_op">(</span><span class="token_number">0</span><span class="token_op">)</span> <span class="token_comment"># make Top Item highlighted</span>
<a name="line545"><span class="token_number"> 545 </span></a>            
<a name="line546"><span class="token_number"> 546 </span></a>    <span class="keyword">def</span> <span class="token_name">cleanupOnQuit</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line547"><span class="token_number"> 547 </span></a>                
<a name="line548"><span class="token_number"> 548 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">model_has_changed</span><span class="token_op">():</span>
<a name="line549"><span class="token_number"> 549 </span></a><span class="text">            </span><span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">maybe_save_dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_string">"Save Before Exit?"</span><span class="token_op">)</span>
<a name="line550"><span class="token_number"> 550 </span></a>            
<a name="line551"><span class="token_number"> 551 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">'save_file'</span><span class="token_op">]</span> <span class="token_op">==</span> <span class="token_string">"yes"</span><span class="token_op">):</span>
<a name="line552"><span class="token_number"> 552 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">()</span>
<a name="line553"><span class="token_number"> 553 </span></a>                <span class="keyword">return</span>
<a name="line554"><span class="token_number"> 554 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line555"><span class="token_number"> 555 </span></a>                <span class="token_comment"># ignore any other warnings</span>
<a name="line556"><span class="token_number"> 556 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reset_crc_reference</span><span class="token_op">()</span> <span class="token_comment"># for detecting changes to model</span>
<a name="line557"><span class="token_number"> 557 </span></a>        
<a name="line558"><span class="token_number"> 558 </span></a>        
<a name="line559"><span class="token_number"> 559 </span></a>        <span class="token_comment">#print( 'Doing final cleanup before quitting' )</span>
<a name="line560"><span class="token_number"> 560 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">allow_subWindows_to_close</span> <span class="token_op">=</span> <span class="token_number">1</span>
<a name="line561"><span class="token_number"> 561 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">destroy</span><span class="token_op">()</span>
<a name="line562"><span class="token_number"> 562 </span></a>    
<a name="line563"><span class="token_number"> 563 </span></a>    <span class="keyword">def</span> <span class="token_name">set_duplication_widget_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">label_obj</span><span class="token_op">):</span>
<a name="line564"><span class="token_number"> 564 </span></a><span class="text">        </span><span class="token_string">"""Given the widget Label object, set up for making duplicates."""</span>
<a name="line565"><span class="token_number"> 565 </span></a>        
<a name="line566"><span class="token_number"> 566 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label_obj</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">]</span>
<a name="line567"><span class="token_number"> 567 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label_obj</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span>
<a name="line568"><span class="token_number"> 568 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_desc</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"\nduplicate widget\nand its properties"</span>
<a name="line569"><span class="token_number"> 569 </span></a>    
<a name="line570"><span class="token_number"> 570 </span></a>    <span class="keyword">def</span> <span class="token_name">set_placement_widget_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">):</span>
<a name="line571"><span class="token_number"> 571 </span></a><span class="text">        </span><span class="token_string">"""Sets dup_widget_label for a simple Place of widget_type."""</span>
<a name="line572"><span class="token_number"> 572 </span></a>        
<a name="line573"><span class="token_number"> 573 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"\n%s\n"</span><span class="token_op">%</span><span class="token_name">widget_type</span>
<a name="line574"><span class="token_number"> 574 </span></a>        <span class="token_comment">#self.dup_widget_label["background"] = self.dup_widget_label_plain_bg # "#FFFACD"  # lemonchiffon</span>
<a name="line575"><span class="token_number"> 575 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span>
<a name="line576"><span class="token_number"> 576 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_widget_label_desc</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"\n\nPlace %s"</span><span class="token_op">%</span><span class="token_name">widget_type</span>
<a name="line577"><span class="token_number"> 577 </span></a>
<a name="line578"><span class="token_number"> 578 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">dup_source_widget_name</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># not a dup_widget_label event so no dup_source_widget_name</span>
<a name="line579"><span class="token_number"> 579 </span></a>        
<a name="line580"><span class="token_number"> 580 </span></a>        
<a name="line581"><span class="token_number"> 581 </span></a>    <span class="keyword">def</span> <span class="token_name">Listbox_1_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span> <span class="token_comment">#click method for component ID=1</span>
<a name="line582"><span class="token_number"> 582 </span></a>        
<a name="line583"><span class="token_number"> 583 </span></a><span class="text">        </span><span class="token_name">val</span> <span class="token_op">=</span> <span class="token_string">'Button'</span>
<a name="line584"><span class="token_number"> 584 </span></a>        <span class="keyword">for</span> <span class="token_name">i</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">curselection</span><span class="token_op">():</span>
<a name="line585"><span class="token_number"> 585 </span></a><span class="text">            </span><span class="token_name">val</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_name">i</span><span class="token_op">)</span><span class="token_comment"># .lower()</span>
<a name="line586"><span class="token_number"> 586 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Selected Widget: "</span><span class="token_op">+</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">Listbox_1</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_name">i</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line587"><span class="token_number"> 587 </span></a>                
<a name="line588"><span class="token_number"> 588 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_name">val</span><span class="token_op">)</span>
<a name="line589"><span class="token_number"> 589 </span></a>
<a name="line590"><span class="token_number"> 590 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line591"><span class="token_number"> 591 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">tab_label</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Notebook'</span><span class="token_op">):</span>
<a name="line592"><span class="token_number"> 592 </span></a>            <span class="token_comment"># set duplicate widget text and background to indicate normal placement</span>
<a name="line593"><span class="token_number"> 593 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_placement_widget_label</span><span class="token_op">(</span> <span class="token_name">val</span> <span class="token_op">)</span>
<a name="line594"><span class="token_number"> 594 </span></a>
<a name="line595"><span class="token_number"> 595 </span></a>    <span class="keyword">def</span> <span class="token_name">hideOkChkBox_Callback</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">varName</span><span class="token_op">,</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">mode</span><span class="token_op">):</span>
<a name="line596"><span class="token_number"> 596 </span></a>        <span class="token_comment">#print( 'Hide OK Button in Dialog =',self.MainWin.hideOkChkBox_StringVar.get(), end="\n")</span>
<a name="line597"><span class="token_number"> 597 </span></a>        
<a name="line598"><span class="token_number"> 598 </span></a><span class="text">        </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line599"><span class="token_number"> 599 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'hideokbutton'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">())</span>
<a name="line600"><span class="token_number"> 600 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line601"><span class="token_number"> 601 </span></a><span class="text">            </span><span class="keyword">pass</span>
<a name="line602"><span class="token_number"> 602 </span></a>
<a name="line603"><span class="token_number"> 603 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">==</span> <span class="token_string">"yes"</span><span class="token_op">:</span>
<a name="line604"><span class="token_number"> 604 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">remove_mock_OK_Cancel_Buttons</span><span class="token_op">()</span>
<a name="line605"><span class="token_number"> 605 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line606"><span class="token_number"> 606 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_mock_OK_Cancel_Buttons</span><span class="token_op">()</span>
<a name="line607"><span class="token_number"> 607 </span></a>
<a name="line608"><span class="token_number"> 608 </span></a>    <span class="keyword">def</span> <span class="token_name">menuChkBox_Callback</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">varName</span><span class="token_op">,</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">mode</span><span class="token_op">):</span>
<a name="line609"><span class="token_number"> 609 </span></a>        <span class="token_comment">#print( 'make menu =',self.MainWin.menuChkBox_StringVar.get(), end="\n")</span>
<a name="line610"><span class="token_number"> 610 </span></a>        
<a name="line611"><span class="token_number"> 611 </span></a><span class="text">        </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line612"><span class="token_number"> 612 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'hasmenu'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">())</span>
<a name="line613"><span class="token_number"> 613 </span></a>            <span class="token_comment">#print('Setting Menu "hasmenu" Option To:',self.MainWin.menuChkBox_StringVar.get())</span>
<a name="line614"><span class="token_number"> 614 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line615"><span class="token_number"> 615 </span></a><span class="text">            </span><span class="keyword">print</span><span class="token_op">(</span><span class="token_string">'WARNING... Failed To Properly Set "hasmenu" Option.'</span><span class="token_op">)</span>
<a name="line616"><span class="token_number"> 616 </span></a>        
<a name="line617"><span class="token_number"> 617 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">in_reading_mode</span><span class="token_op">:</span>
<a name="line618"><span class="token_number"> 618 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'yes'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line619"><span class="token_number"> 619 </span></a><span class="text">                </span><span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">Menumaker</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_string">"Define Menu Structure"</span><span class="token_op">,</span>
<a name="line620"><span class="token_number"> 620 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span><span class="token_string">'menu'</span><span class="token_op">))</span>
<a name="line621"><span class="token_number"> 621 </span></a>                <span class="token_comment">#print( dialog.result, end="\n")</span>
<a name="line622"><span class="token_number"> 622 </span></a>                
<a name="line623"><span class="token_number"> 623 </span></a>                <span class="keyword">if</span> <span class="token_name">type</span><span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">)</span> <span class="token_op">==</span> <span class="token_name">type</span><span class="token_op">({}):</span>
<a name="line624"><span class="token_number"> 624 </span></a>
<a name="line625"><span class="token_number"> 625 </span></a><span class="text">                    </span><span class="token_name">add_menu_ctrl_keys</span> <span class="token_op">=</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'add_menu_ctrl_keys'</span><span class="token_op">,</span><span class="token_string">'yes'</span><span class="token_op">)</span>
<a name="line626"><span class="token_number"> 626 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'add_menu_ctrl_keys'</span><span class="token_op">,</span> <span class="token_name">add_menu_ctrl_keys</span><span class="token_op">)</span>
<a name="line627"><span class="token_number"> 627 </span></a>
<a name="line628"><span class="token_number"> 628 </span></a>                    <span class="token_name">menuStr</span> <span class="token_op">=</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'menu'</span><span class="token_op">,</span><span class="token_string">''</span><span class="token_op">).</span><span class="token_name">strip</span><span class="token_op">()</span>
<a name="line629"><span class="token_number"> 629 </span></a>                    <span class="keyword">if</span> <span class="token_name">len</span><span class="token_op">(</span> <span class="token_name">menuStr</span> <span class="token_op">)</span> <span class="token_op">&gt;</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line630"><span class="token_number"> 630 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'menu'</span><span class="token_op">,</span><span class="token_name">menuStr</span><span class="token_op">)</span>
<a name="line631"><span class="token_number"> 631 </span></a>                        <span class="token_comment">#print( 'Recording new Menu Definition', end="\n")</span>
<a name="line632"><span class="token_number"> 632 </span></a>                        
<a name="line633"><span class="token_number"> 633 </span></a>                        
<a name="line634"><span class="token_number"> 634 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line635"><span class="token_number"> 635 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># make PreviewWin if not already done.</span>
<a name="line636"><span class="token_number"> 636 </span></a>
<a name="line637"><span class="token_number"> 637 </span></a>        <span class="token_comment"># delete menuBar</span>
<a name="line638"><span class="token_number"> 638 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'no'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line639"><span class="token_number"> 639 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line640"><span class="token_number"> 640 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">:</span>
<a name="line641"><span class="token_number"> 641 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">delete_menu</span><span class="token_op">()</span>
<a name="line642"><span class="token_number"> 642 </span></a>
<a name="line643"><span class="token_number"> 643 </span></a>        <span class="token_comment"># create menuBar</span>
<a name="line644"><span class="token_number"> 644 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'yes'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line645"><span class="token_number"> 645 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line646"><span class="token_number"> 646 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">:</span>
<a name="line647"><span class="token_number"> 647 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">delete_menu</span><span class="token_op">()</span> <span class="token_comment"># delete so menuBar can be recreated</span>
<a name="line648"><span class="token_number"> 648 </span></a>                    
<a name="line649"><span class="token_number"> 649 </span></a>                <span class="token_name">menuL</span> <span class="token_op">=</span> <span class="token_name">buildMenuSource</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'menu'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line650"><span class="token_number"> 650 </span></a>                <span class="token_name">menuSrcL</span> <span class="token_op">=</span> <span class="token_name">getMenuSource</span><span class="token_op">(</span> <span class="token_name">menuL</span><span class="token_op">,</span> <span class="token_name">rootName</span><span class="token_op">=</span><span class="token_string">'self'</span>  <span class="token_op">)</span>
<a name="line651"><span class="token_number"> 651 </span></a>                    
<a name="line652"><span class="token_number"> 652 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_menu</span><span class="token_op">(</span> <span class="token_name">menuSrcL</span> <span class="token_op">)</span>
<a name="line653"><span class="token_number"> 653 </span></a>        
<a name="line654"><span class="token_number"> 654 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># redraw the form window showing menu state.</span>
<a name="line655"><span class="token_number"> 655 </span></a>
<a name="line656"><span class="token_number"> 656 </span></a>        
<a name="line657"><span class="token_number"> 657 </span></a>    <span class="keyword">def</span> <span class="token_name">statusBarChkBox_Callback</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">varName</span><span class="token_op">,</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">mode</span><span class="token_op">):</span>
<a name="line658"><span class="token_number"> 658 </span></a>        <span class="token_comment">#print( 'Status Bar =',self.MainWin.statusBarChkBox_StringVar.get(), end="\n")</span>
<a name="line659"><span class="token_number"> 659 </span></a>        
<a name="line660"><span class="token_number"> 660 </span></a><span class="text">        </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line661"><span class="token_number"> 661 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'hasstatusbar'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">())</span>
<a name="line662"><span class="token_number"> 662 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line663"><span class="token_number"> 663 </span></a><span class="text">            </span><span class="keyword">pass</span>
<a name="line664"><span class="token_number"> 664 </span></a>            
<a name="line665"><span class="token_number"> 665 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line666"><span class="token_number"> 666 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># make PreviewWin if not already done.</span>
<a name="line667"><span class="token_number"> 667 </span></a>        
<a name="line668"><span class="token_number"> 668 </span></a>        <span class="token_comment"># add statusbar to PreviewWin</span>
<a name="line669"><span class="token_number"> 669 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'yes'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line670"><span class="token_number"> 670 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line671"><span class="token_number"> 671 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">:</span>
<a name="line672"><span class="token_number"> 672 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_mock_statusbar</span><span class="token_op">()</span>
<a name="line673"><span class="token_number"> 673 </span></a>                    
<a name="line674"><span class="token_number"> 674 </span></a>        <span class="token_comment"># remove statusbar from PreviewWin</span>
<a name="line675"><span class="token_number"> 675 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'no'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line676"><span class="token_number"> 676 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line677"><span class="token_number"> 677 </span></a><span class="text">                </span><span class="keyword">if</span>  <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">:</span>
<a name="line678"><span class="token_number"> 678 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">remove_mock_statusbar</span><span class="token_op">()</span>
<a name="line679"><span class="token_number"> 679 </span></a>                    
<a name="line680"><span class="token_number"> 680 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># redraw the form window showing menu state.</span>
<a name="line681"><span class="token_number"> 681 </span></a>
<a name="line682"><span class="token_number"> 682 </span></a>    <span class="keyword">def</span> <span class="token_name">resizableChkBox_Callback</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">varName</span><span class="token_op">,</span> <span class="token_name">index</span><span class="token_op">,</span> <span class="token_name">mode</span><span class="token_op">):</span>
<a name="line683"><span class="token_number"> 683 </span></a>        <span class="token_comment">#print( 'Status Bar =',self.MainWin.resizableChkBox_StringVar.get(), end="\n")</span>
<a name="line684"><span class="token_number"> 684 </span></a>        
<a name="line685"><span class="token_number"> 685 </span></a><span class="text">        </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line686"><span class="token_number"> 686 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span><span class="token_string">'resizable'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">())</span>
<a name="line687"><span class="token_number"> 687 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line688"><span class="token_number"> 688 </span></a><span class="text">            </span><span class="keyword">pass</span>
<a name="line689"><span class="token_number"> 689 </span></a>                    
<a name="line690"><span class="token_number"> 690 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># redraw the form window showing menu state.</span>
<a name="line691"><span class="token_number"> 691 </span></a>        
<a name="line692"><span class="token_number"> 692 </span></a>                
<a name="line693"><span class="token_number"> 693 </span></a>    <span class="keyword">def</span> <span class="token_name">ColorPickButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span> <span class="token_comment">#put selected color on clipboard</span>
<a name="line694"><span class="token_number"> 694 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton_Select</span><span class="token_op">()</span>
<a name="line695"><span class="token_number"> 695 </span></a>        
<a name="line696"><span class="token_number"> 696 </span></a>    <span class="keyword">def</span> <span class="token_name">ColorPickButton_Select</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span> <span class="token_comment">#put selected color on clipboard</span>
<a name="line697"><span class="token_number"> 697 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Place Selected Color on Clipboard'</span><span class="token_op">)</span>
<a name="line698"><span class="token_number"> 698 </span></a>        <span class="token_name">ctup</span><span class="token_op">,</span><span class="token_name">cstr</span> <span class="token_op">=</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">colorchooser</span><span class="token_op">.</span><span class="token_name">askcolor</span><span class="token_op">(</span><span class="token_name">title</span><span class="token_op">=</span><span class="token_string">'Place Selected Color on Clipboard'</span><span class="token_op">)</span>
<a name="line699"><span class="token_number"> 699 </span></a>        <span class="keyword">if</span> <span class="token_name">cstr</span> <span class="token_op">!=</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line700"><span class="token_number"> 700 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'%s is on Clipboard'</span><span class="token_op">%</span><span class="token_name">cstr</span><span class="token_op">)</span>
<a name="line701"><span class="token_number"> 701 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">clipboard_clear</span><span class="token_op">()</span>
<a name="line702"><span class="token_number"> 702 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">clipboard_append</span><span class="token_op">(</span><span class="token_name">cstr</span><span class="token_op">)</span>
<a name="line703"><span class="token_number"> 703 </span></a>            
<a name="line704"><span class="token_number"> 704 </span></a>            <span class="token_comment">#print( 'color chosen=',cstr, end="\n")</span>
<a name="line705"><span class="token_number"> 705 </span></a>    
<a name="line706"><span class="token_number"> 706 </span></a>    <span class="keyword">def</span> <span class="token_name">FontPickButton_Click</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line707"><span class="token_number"> 707 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">FontPickButton_Select</span><span class="token_op">()</span>
<a name="line708"><span class="token_number"> 708 </span></a>    
<a name="line709"><span class="token_number"> 709 </span></a>    <span class="keyword">def</span> <span class="token_name">FontPickButton_Select</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line710"><span class="token_number"> 710 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Place Selected Font on Clipboard'</span><span class="token_op">)</span>
<a name="line711"><span class="token_number"> 711 </span></a>        <span class="token_name">font</span> <span class="token_op">=</span> <span class="token_name">askfont</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">root</span><span class="token_op">)</span>
<a name="line712"><span class="token_number"> 712 </span></a>        <span class="keyword">if</span> <span class="token_name">font</span><span class="token_op">:</span>
<a name="line713"><span class="token_number"> 713 </span></a>            <span class="token_comment"># spaces in the family name need to be escaped</span>
<a name="line714"><span class="token_number"> 714 </span></a><span class="text">            </span><span class="token_name">font</span><span class="token_op">[</span><span class="token_string">'family'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">font</span><span class="token_op">[</span><span class="token_string">'family'</span><span class="token_op">].</span><span class="token_name">replace</span><span class="token_op">(</span><span class="token_string">' '</span><span class="token_op">,</span> <span class="token_string">'\ '</span><span class="token_op">)</span>
<a name="line715"><span class="token_number"> 715 </span></a>            <span class="token_name">font_str</span> <span class="token_op">=</span> <span class="token_string">"%(family)s %(size)i %(weight)s %(slant)s"</span> <span class="token_op">%</span> <span class="token_name">font</span>
<a name="line716"><span class="token_number"> 716 </span></a>            <span class="keyword">if</span> <span class="token_name">font</span><span class="token_op">[</span><span class="token_string">'underline'</span><span class="token_op">]:</span>
<a name="line717"><span class="token_number"> 717 </span></a><span class="text">                </span><span class="token_name">font_str</span> <span class="token_op">+=</span> <span class="token_string">' underline'</span>
<a name="line718"><span class="token_number"> 718 </span></a>            <span class="keyword">if</span> <span class="token_name">font</span><span class="token_op">[</span><span class="token_string">'overstrike'</span><span class="token_op">]:</span>
<a name="line719"><span class="token_number"> 719 </span></a><span class="text">                </span><span class="token_name">font_str</span> <span class="token_op">+=</span> <span class="token_string">' overstrike'</span>
<a name="line720"><span class="token_number"> 720 </span></a>                
<a name="line721"><span class="token_number"> 721 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'%s is on Clipboard'</span><span class="token_op">%</span><span class="token_name">font_str</span><span class="token_op">)</span>
<a name="line722"><span class="token_number"> 722 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">clipboard_clear</span><span class="token_op">()</span>
<a name="line723"><span class="token_number"> 723 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">ColorPickButton</span><span class="token_op">.</span><span class="token_name">clipboard_append</span><span class="token_op">(</span><span class="token_name">font_str</span><span class="token_op">)</span>
<a name="line724"><span class="token_number"> 724 </span></a>            
<a name="line725"><span class="token_number"> 725 </span></a>            <span class="token_comment">#print( 'font chosen=',font_str, end="\n")</span>
<a name="line726"><span class="token_number"> 726 </span></a>            
<a name="line727"><span class="token_number"> 727 </span></a>
<a name="line728"><span class="token_number"> 728 </span></a>    <span class="keyword">def</span> <span class="token_name">Help</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line729"><span class="token_number"> 729 </span></a>        
<a name="line730"><span class="token_number"> 730 </span></a><span class="text">        </span><span class="token_name">usage</span> <span class="token_op">=</span> <span class="token_string">"""</span>
<a name="line731"><span class="token_number"> 731 </span></a><span class="token_string">        </span>
<a name="line732"><span class="token_number"> 732 </span></a><span class="token_string">Basic Usage: </span>
<a name="line733"><span class="token_number"> 733 </span></a><span class="token_string">  Select Widget in Listbox with Left Click.</span>
<a name="line734"><span class="token_number"> 734 </span></a><span class="token_string">  Place Widget with Left Click in grid.</span>
<a name="line735"><span class="token_number"> 735 </span></a>
<a name="line736"><span class="token_number"> 736 </span></a><span class="token_string">Edit Widget:</span>
<a name="line737"><span class="token_number"> 737 </span></a><span class="token_string">  Right Click Widget in Grid or Preview Window.</span>
<a name="line738"><span class="token_number"> 738 </span></a>
<a name="line739"><span class="token_number"> 739 </span></a><span class="token_string">Move Widget:</span>
<a name="line740"><span class="token_number"> 740 </span></a><span class="token_string">  Left Button Drag and Drop in Grid.</span>
<a name="line741"><span class="token_number"> 741 </span></a>
<a name="line742"><span class="token_number"> 742 </span></a><span class="token_string">Duplicate Widget: </span>
<a name="line743"><span class="token_number"> 743 </span></a><span class="token_string">  Left Click Widget in Grid.</span>
<a name="line744"><span class="token_number"> 744 </span></a><span class="token_string">  Left Click in grid to place the duplicate.</span>
<a name="line745"><span class="token_number"> 745 </span></a>
<a name="line746"><span class="token_number"> 746 </span></a><span class="token_string">Insert Row or Column with Left Click on "+" control.</span>
<a name="line747"><span class="token_number"> 747 </span></a>
<a name="line748"><span class="token_number"> 748 </span></a><span class="token_string">Add Weight to row or column with "wt" control.</span>
<a name="line749"><span class="token_number"> 749 </span></a>
<a name="line750"><span class="token_number"> 750 </span></a><span class="token_string">Select Corresponding Tab for Widgets in Frames, RadioGroups etc.</span>
<a name="line751"><span class="token_number"> 751 </span></a><span class="token_string">"""</span>
<a name="line752"><span class="token_number"> 752 </span></a>        
<a name="line753"><span class="token_number"> 753 </span></a>        <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span><span class="token_op">.</span><span class="token_name">showinfo</span><span class="token_op">(</span>
<a name="line754"><span class="token_number"> 754 </span></a>            <span class="token_string">"Help for TkGridGUI"</span><span class="token_op">,</span>
<a name="line755"><span class="token_number"> 755 </span></a>            <span class="token_name">usage</span><span class="token_op">)</span>
<a name="line756"><span class="token_number"> 756 </span></a>
<a name="line757"><span class="token_number"> 757 </span></a>    <span class="keyword">def</span> <span class="token_name">About</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line758"><span class="token_number"> 758 </span></a><span class="text">        </span><span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span><span class="token_op">.</span><span class="token_name">showinfo</span><span class="token_op">(</span>
<a name="line759"><span class="token_number"> 759 </span></a>            <span class="token_string">"About TkGridGUI"</span><span class="token_op">,</span>
<a name="line760"><span class="token_number"> 760 </span></a>            <span class="token_string">"TkGridGUI is:\n\n"</span><span class="token_op">+</span>\
<a name="line761"><span class="token_number"> 761 </span></a>            <span class="token_string">"A quick approach to\n"</span><span class="token_op">+</span>\
<a name="line762"><span class="token_number"> 762 </span></a>            <span class="token_string">"building Tkinter applications.\n"</span><span class="token_op">+</span>\
<a name="line763"><span class="token_number"> 763 </span></a>            <span class="token_string">"Written by Charlie Taylor\n"</span>
<a name="line764"><span class="token_number"> 764 </span></a>        <span class="token_op">)</span>
<a name="line765"><span class="token_number"> 765 </span></a>    
<a name="line766"><span class="token_number"> 766 </span></a>    <span class="keyword">def</span> <span class="token_name">newForm</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line767"><span class="token_number"> 767 </span></a>        <span class="token_comment">#print( "New Form" )</span>
<a name="line768"><span class="token_number"> 768 </span></a>        
<a name="line769"><span class="token_number"> 769 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">model_has_changed</span><span class="token_op">():</span>
<a name="line770"><span class="token_number"> 770 </span></a><span class="text">            </span><span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">maybe_save_dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_string">"Save Current File?"</span><span class="token_op">)</span>
<a name="line771"><span class="token_number"> 771 </span></a>            
<a name="line772"><span class="token_number"> 772 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">'save_file'</span><span class="token_op">]</span> <span class="token_op">==</span> <span class="token_string">"yes"</span> <span class="token_op">):</span>
<a name="line773"><span class="token_number"> 773 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">()</span>
<a name="line774"><span class="token_number"> 774 </span></a>                <span class="keyword">return</span>
<a name="line775"><span class="token_number"> 775 </span></a>
<a name="line776"><span class="token_number"> 776 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileFullName</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line777"><span class="token_number"> 777 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_filePath</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line778"><span class="token_number"> 778 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">=</span> <span class="token_string">''</span> <span class="token_comment"># no file for now</span>
<a name="line779"><span class="token_number"> 779 </span></a>
<a name="line780"><span class="token_number"> 780 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">title</span><span class="token_op">(</span> <span class="token_string">'TkGridGUI: '</span> <span class="token_op">+</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">)</span>
<a name="line781"><span class="token_number"> 781 </span></a>        
<a name="line782"><span class="token_number"> 782 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line783"><span class="token_number"> 783 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">delete_menu</span><span class="token_op">()</span>
<a name="line784"><span class="token_number"> 784 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">remove_mock_statusbar</span><span class="token_op">()</span>
<a name="line785"><span class="token_number"> 785 </span></a>
<a name="line786"><span class="token_number"> 786 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reinitialize</span><span class="token_op">()</span>
<a name="line787"><span class="token_number"> 787 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">initialize_NotebookGridDes</span><span class="token_op">()</span>
<a name="line788"><span class="token_number"> 788 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;&lt;NotebookTabChanged&gt;&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name"><strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong></span><span class="token_op">)</span>
<a name="line789"><span class="token_number"> 789 </span></a>        
<a name="line790"><span class="token_number"> 790 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line791"><span class="token_number"> 791 </span></a>        
<a name="line792"><span class="token_number"> 792 </span></a>        <span class="token_comment"># ignore any other warnings</span>
<a name="line793"><span class="token_number"> 793 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reset_crc_reference</span><span class="token_op">()</span> <span class="token_comment"># for detecting changes to model</span>
<a name="line794"><span class="token_number"> 794 </span></a>        
<a name="line795"><span class="token_number"> 795 </span></a>
<a name="line796"><span class="token_number"> 796 </span></a>    <span class="keyword">def</span> <span class="token_name">openFile</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">fName</span><span class="token_op">=</span><span class="token_name">None</span><span class="token_op">):</span>
<a name="line797"><span class="token_number"> 797 </span></a>        <span class="token_comment">#print( 'Open File' )</span>
<a name="line798"><span class="token_number"> 798 </span></a>                
<a name="line799"><span class="token_number"> 799 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">model_has_changed</span><span class="token_op">():</span>
<a name="line800"><span class="token_number"> 800 </span></a><span class="text">            </span><span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">maybe_save_dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_string">"Save Current File?"</span><span class="token_op">)</span>
<a name="line801"><span class="token_number"> 801 </span></a>            
<a name="line802"><span class="token_number"> 802 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">'save_file'</span><span class="token_op">]</span> <span class="token_op">==</span> <span class="token_string">"yes"</span><span class="token_op">):</span>
<a name="line803"><span class="token_number"> 803 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">saveasFile</span><span class="token_op">()</span>
<a name="line804"><span class="token_number"> 804 </span></a>                <span class="keyword">return</span>
<a name="line805"><span class="token_number"> 805 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line806"><span class="token_number"> 806 </span></a>                <span class="token_comment"># ignore any other warnings</span>
<a name="line807"><span class="token_number"> 807 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reset_crc_reference</span><span class="token_op">()</span> <span class="token_comment"># for detecting changes to model</span>
<a name="line808"><span class="token_number"> 808 </span></a>
<a name="line809"><span class="token_number"> 809 </span></a>        
<a name="line810"><span class="token_number"> 810 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">in_reading_mode</span> <span class="token_op">=</span> <span class="token_name">True</span> <span class="token_comment"># when True, suppresses some automatic trace actions.</span>
<a name="line811"><span class="token_number"> 811 </span></a>        <span class="keyword">if</span> <span class="token_name">fName</span> <span class="keyword">is</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line812"><span class="token_number"> 812 </span></a><span class="text">            </span><span class="token_name">filetypes</span> <span class="token_op">=</span> <span class="token_op">[</span>
<a name="line813"><span class="token_number"> 813 </span></a>                <span class="token_op">(</span><span class="token_string">'tkGridGUI definition'</span><span class="token_op">,</span><span class="token_string">'*.def'</span><span class="token_op">),</span>
<a name="line814"><span class="token_number"> 814 </span></a>                <span class="token_op">(</span><span class="token_string">'Any File'</span><span class="token_op">,</span><span class="token_string">'*.*'</span><span class="token_op">)]</span>
<a name="line815"><span class="token_number"> 815 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pathopen</span> <span class="token_op">=</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">filedialog</span><span class="token_op">.</span><span class="token_name">askopenfilename</span><span class="token_op">(</span><span class="token_name">parent</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">title</span><span class="token_op">=</span><span class="token_string">'Open tkGridGUI file'</span><span class="token_op">,</span> 
<a name="line816"><span class="token_number"> 816 </span></a>                <span class="token_name">filetypes</span><span class="token_op">=</span><span class="token_name">filetypes</span><span class="token_op">)</span>
<a name="line817"><span class="token_number"> 817 </span></a>            <span class="token_comment">#print('self.pathopen =',self.pathopen)</span>
<a name="line818"><span class="token_number"> 818 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line819"><span class="token_number"> 819 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pathopen</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">abspath</span><span class="token_op">(</span><span class="token_name">fName</span><span class="token_op">)</span>
<a name="line820"><span class="token_number"> 820 </span></a>        
<a name="line821"><span class="token_number"> 821 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pathopen</span><span class="token_op">:</span>
<a name="line822"><span class="token_number"> 822 </span></a>            
<a name="line823"><span class="token_number"> 823 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">newForm</span><span class="token_op">()</span> <span class="token_comment"># clean up any leftovers from another job</span>
<a name="line824"><span class="token_number"> 824 </span></a>            
<a name="line825"><span class="token_number"> 825 </span></a>            <span class="token_name">full_fname</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">abspath</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pathopen</span> <span class="token_op">)</span>
<a name="line826"><span class="token_number"> 826 </span></a>            <span class="token_name">head</span><span class="token_op">,</span><span class="token_name">tail</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">split</span><span class="token_op">(</span> <span class="token_name">full_fname</span> <span class="token_op">)</span>
<a name="line827"><span class="token_number"> 827 </span></a>            
<a name="line828"><span class="token_number"> 828 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileFullName</span> <span class="token_op">=</span> <span class="token_name">full_fname</span>
<a name="line829"><span class="token_number"> 829 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_filePath</span> <span class="token_op">=</span> <span class="token_name">head</span>
<a name="line830"><span class="token_number"> 830 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">=</span> <span class="token_name">tail</span>
<a name="line831"><span class="token_number"> 831 </span></a>                        
<a name="line832"><span class="token_number"> 832 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">readAppDefFile</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pathopen</span> <span class="token_op">)</span>
<a name="line833"><span class="token_number"> 833 </span></a>
<a name="line834"><span class="token_number"> 834 </span></a>            <span class="token_comment">#'hasmenu':'no', </span>
<a name="line835"><span class="token_number"> 835 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasmenu'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line836"><span class="token_number"> 836 </span></a>
<a name="line837"><span class="token_number"> 837 </span></a>            <span class="token_comment">#'hasstatusbar':'no',</span>
<a name="line838"><span class="token_number"> 838 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstatusbar'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line839"><span class="token_number"> 839 </span></a>
<a name="line840"><span class="token_number"> 840 </span></a>            <span class="token_comment">#'resizable':'no'</span>
<a name="line841"><span class="token_number"> 841 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'resizable'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line842"><span class="token_number"> 842 </span></a>            
<a name="line843"><span class="token_number"> 843 </span></a>            <span class="token_comment">#'hideokbutton':'no'</span>
<a name="line844"><span class="token_number"> 844 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hideokbutton'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line845"><span class="token_number"> 845 </span></a>
<a name="line846"><span class="token_number"> 846 </span></a>            <span class="token_comment">#'guitype':'main',</span>
<a name="line847"><span class="token_number"> 847 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'guitype'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line848"><span class="token_number"> 848 </span></a>
<a name="line849"><span class="token_number"> 849 </span></a>            <span class="token_comment">#'hasstddialmess':'no', </span>
<a name="line850"><span class="token_number"> 850 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialmess'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line851"><span class="token_number"> 851 </span></a>
<a name="line852"><span class="token_number"> 852 </span></a>            <span class="token_comment">#'hasstddialcolor':'no', </span>
<a name="line853"><span class="token_number"> 853 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialcolor'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line854"><span class="token_number"> 854 </span></a>
<a name="line855"><span class="token_number"> 855 </span></a>            <span class="token_comment">#'hasstddialfile':'no', </span>
<a name="line856"><span class="token_number"> 856 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialfile'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line857"><span class="token_number"> 857 </span></a>
<a name="line858"><span class="token_number"> 858 </span></a>            <span class="token_comment">#'hasstdalarm':'no', </span>
<a name="line859"><span class="token_number"> 859 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstdalarm'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line860"><span class="token_number"> 860 </span></a>
<a name="line861"><span class="token_number"> 861 </span></a>
<a name="line862"><span class="token_number"> 862 </span></a>            <span class="token_comment">#for key,val in self.target_app.app_attrD.items():</span>
<a name="line863"><span class="token_number"> 863 </span></a>            <span class="token_comment">#    print('%20s %s'%(key, str(val).replace('\t','    ')))</span>
<a name="line864"><span class="token_number"> 864 </span></a>            
<a name="line865"><span class="token_number"> 865 </span></a>            <span class="token_name">widgetL</span> <span class="token_op">=</span> <span class="token_op">[(</span><span class="token_name">c</span><span class="token_op">.</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">col</span><span class="token_op">)</span> <span class="keyword">for</span> <span class="token_name">widget_name</span><span class="token_op">,</span><span class="token_name">c</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">())]</span>
<a name="line866"><span class="token_number"> 866 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">set_complete_list_of_widgets</span><span class="token_op">(</span> <span class="token_name">widgetL</span> <span class="token_op">)</span>
<a name="line867"><span class="token_number"> 867 </span></a>            
<a name="line868"><span class="token_number"> 868 </span></a>            <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line869"><span class="token_number"> 869 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># make PreviewWin if not already done.</span>
<a name="line870"><span class="token_number"> 870 </span></a>            
<a name="line871"><span class="token_number"> 871 </span></a>            <span class="token_comment"># maybe create menuBar</span>
<a name="line872"><span class="token_number"> 872 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'yes'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line873"><span class="token_number"> 873 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line874"><span class="token_number"> 874 </span></a><span class="text">                    </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">menuBar</span><span class="token_op">:</span>
<a name="line875"><span class="token_number"> 875 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">delete_menu</span><span class="token_op">()</span> <span class="token_comment"># delete so menuBar can be recreated</span>
<a name="line876"><span class="token_number"> 876 </span></a>                        
<a name="line877"><span class="token_number"> 877 </span></a>                    <span class="token_name">menuL</span> <span class="token_op">=</span> <span class="token_name">buildMenuSource</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'menu'</span> <span class="token_op">)</span> <span class="token_op">)</span>
<a name="line878"><span class="token_number"> 878 </span></a>                    <span class="token_name">menuSrcL</span> <span class="token_op">=</span> <span class="token_name">getMenuSource</span><span class="token_op">(</span> <span class="token_name">menuL</span><span class="token_op">,</span> <span class="token_name">rootName</span><span class="token_op">=</span><span class="token_string">'self'</span>  <span class="token_op">)</span>
<a name="line879"><span class="token_number"> 879 </span></a>                        
<a name="line880"><span class="token_number"> 880 </span></a>                    <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_menu</span><span class="token_op">(</span> <span class="token_name">menuSrcL</span> <span class="token_op">)</span>
<a name="line881"><span class="token_number"> 881 </span></a>            
<a name="line882"><span class="token_number"> 882 </span></a>            
<a name="line883"><span class="token_number"> 883 </span></a>            <span class="token_comment"># maybe add statusbar to PreviewWin</span>
<a name="line884"><span class="token_number"> 884 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()==</span><span class="token_string">'yes'</span> <span class="keyword">and</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">:</span>
<a name="line885"><span class="token_number"> 885 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">):</span>
<a name="line886"><span class="token_number"> 886 </span></a><span class="text">                    </span><span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">:</span>
<a name="line887"><span class="token_number"> 887 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">add_mock_statusbar</span><span class="token_op">()</span>
<a name="line888"><span class="token_number"> 888 </span></a>            
<a name="line889"><span class="token_number"> 889 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">:</span>
<a name="line890"><span class="token_number"> 890 </span></a><span class="text">                </span><span class="token_name">w</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'width'</span> <span class="token_op">)</span>
<a name="line891"><span class="token_number"> 891 </span></a>                <span class="token_name">h</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'height'</span> <span class="token_op">)</span>
<a name="line892"><span class="token_number"> 892 </span></a>                <span class="token_name">x</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'x'</span> <span class="token_op">)</span>
<a name="line893"><span class="token_number"> 893 </span></a>                <span class="token_name">y</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">getSpecialOption</span><span class="token_op">(</span> <span class="token_string">'y'</span> <span class="token_op">)</span>
<a name="line894"><span class="token_number"> 894 </span></a>                
<a name="line895"><span class="token_number"> 895 </span></a>                <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">:</span>
<a name="line896"><span class="token_number"> 896 </span></a><span class="text">                    </span><span class="token_name">y</span> <span class="token_op">+=</span> <span class="token_number">30</span>
<a name="line897"><span class="token_number"> 897 </span></a>                
<a name="line898"><span class="token_number"> 898 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">geometry</span><span class="token_op">(</span> <span class="token_string">'%ix%i+%i+%i'</span><span class="token_op">%(</span><span class="token_name">w</span><span class="token_op">,</span><span class="token_name">h</span><span class="token_op">,</span><span class="token_name">x</span><span class="token_op">,</span><span class="token_name">y</span><span class="token_op">))</span>
<a name="line899"><span class="token_number"> 899 </span></a>                <span class="token_comment">#self.PreviewWin.geometry( '' ) # allow to resize after set to x,y</span>
<a name="line900"><span class="token_number"> 900 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">update_idletasks</span><span class="token_op">()</span>
<a name="line901"><span class="token_number"> 901 </span></a>                
<a name="line902"><span class="token_number"> 902 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">title</span><span class="token_op">(</span> <span class="token_string">'TkGridGUI: '</span> <span class="token_op">+</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">)</span>
<a name="line903"><span class="token_number"> 903 </span></a>
<a name="line904"><span class="token_number"> 904 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reset_crc_reference</span><span class="token_op">()</span> <span class="token_comment"># for detecting changes to model</span>
<a name="line905"><span class="token_number"> 905 </span></a>
<a name="line906"><span class="token_number"> 906 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">in_reading_mode</span> <span class="token_op">=</span> <span class="token_name">False</span> <span class="token_comment"># when True, suppresses some automatic trace actions.</span>
<a name="line907"><span class="token_number"> 907 </span></a>        
<a name="line908"><span class="token_number"> 908 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span> <span class="token_comment"># redraw the form window showing menu state</span>
<a name="line909"><span class="token_number"> 909 </span></a>        
<a name="line910"><span class="token_number"> 910 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;&lt;NotebookTabChanged&gt;&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name"><strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong></span><span class="token_op">)</span>
<a name="line911"><span class="token_number"> 911 </span></a>        
<a name="line912"><span class="token_number"> 912 </span></a>
<a name="line913"><span class="token_number"> 913 </span></a>        
<a name="line914"><span class="token_number"> 914 </span></a>    <span class="keyword">def</span> <span class="token_name">saveasFile</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line915"><span class="token_number"> 915 </span></a>        <span class="token_comment">#print( 'Save File to Disk' )</span>
<a name="line916"><span class="token_number"> 916 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Save File to Disk'</span><span class="token_op">)</span>
<a name="line917"><span class="token_number"> 917 </span></a>        
<a name="line918"><span class="token_number"> 918 </span></a>        <span class="token_name">filetypes</span> <span class="token_op">=</span> <span class="token_op">[</span>
<a name="line919"><span class="token_number"> 919 </span></a>            <span class="token_op">(</span><span class="token_string">'TkGridGUI'</span><span class="token_op">,</span><span class="token_string">'*.def'</span><span class="token_op">),</span>
<a name="line920"><span class="token_number"> 920 </span></a>            <span class="token_op">(</span><span class="token_string">'Any File'</span><span class="token_op">,</span><span class="token_string">'*.*'</span><span class="token_op">)]</span>
<a name="line921"><span class="token_number"> 921 </span></a>        
<a name="line922"><span class="token_number"> 922 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span><span class="token_op">:</span>
<a name="line923"><span class="token_number"> 923 </span></a><span class="text">            </span><span class="token_name">fname</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span>
<a name="line924"><span class="token_number"> 924 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line925"><span class="token_number"> 925 </span></a><span class="text">            </span><span class="token_name">fname</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line926"><span class="token_number"> 926 </span></a>                        
<a name="line927"><span class="token_number"> 927 </span></a>            
<a name="line928"><span class="token_number"> 928 </span></a>        <span class="token_name">fsave</span> <span class="token_op">=</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">filedialog</span><span class="token_op">.</span><span class="token_name">asksaveasfilename</span><span class="token_op">(</span><span class="token_name">parent</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">title</span><span class="token_op">=</span><span class="token_string">'Saving TkGridGUI Definition File'</span><span class="token_op">,</span> 
<a name="line929"><span class="token_number"> 929 </span></a>            <span class="token_name">initialfile</span><span class="token_op">=</span><span class="token_name">fname</span><span class="token_op">,</span> <span class="token_name">filetypes</span><span class="token_op">=</span><span class="token_name">filetypes</span><span class="token_op">)</span>
<a name="line930"><span class="token_number"> 930 </span></a>        
<a name="line931"><span class="token_number"> 931 </span></a>        <span class="keyword">if</span> <span class="token_name">fsave</span><span class="token_op">:</span>
<a name="line932"><span class="token_number"> 932 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">fsave</span><span class="token_op">.</span><span class="token_name">lower</span><span class="token_op">().</span><span class="token_name">endswith</span><span class="token_op">(</span><span class="token_string">'.def'</span><span class="token_op">):</span>
<a name="line933"><span class="token_number"> 933 </span></a><span class="text">                </span><span class="token_name">fsave</span> <span class="token_op">+=</span> <span class="token_string">'.def'</span>
<a name="line934"><span class="token_number"> 934 </span></a>                    
<a name="line935"><span class="token_number"> 935 </span></a>            <span class="token_name">full_fname</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">abspath</span><span class="token_op">(</span> <span class="token_name">fsave</span> <span class="token_op">)</span>
<a name="line936"><span class="token_number"> 936 </span></a>            <span class="token_name">head</span><span class="token_op">,</span><span class="token_name">tail</span> <span class="token_op">=</span> <span class="token_name">os</span><span class="token_op">.</span><span class="token_name">path</span><span class="token_op">.</span><span class="token_name">split</span><span class="token_op">(</span> <span class="token_name">full_fname</span> <span class="token_op">)</span>
<a name="line937"><span class="token_number"> 937 </span></a>            
<a name="line938"><span class="token_number"> 938 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileFullName</span> <span class="token_op">=</span> <span class="token_name">full_fname</span>
<a name="line939"><span class="token_number"> 939 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_filePath</span> <span class="token_op">=</span> <span class="token_name">head</span>
<a name="line940"><span class="token_number"> 940 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">=</span> <span class="token_name">tail</span>
<a name="line941"><span class="token_number"> 941 </span></a>            
<a name="line942"><span class="token_number"> 942 </span></a>            <span class="token_comment"># set values in target_app</span>
<a name="line943"><span class="token_number"> 943 </span></a>
<a name="line944"><span class="token_number"> 944 </span></a>            <span class="token_comment">#'hasmenu':'no', </span>
<a name="line945"><span class="token_number"> 945 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasmenu'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">menuChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line946"><span class="token_number"> 946 </span></a>
<a name="line947"><span class="token_number"> 947 </span></a>            <span class="token_comment">#'hasstatusbar':'no',</span>
<a name="line948"><span class="token_number"> 948 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstatusbar'</span> <span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusBarChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line949"><span class="token_number"> 949 </span></a>
<a name="line950"><span class="token_number"> 950 </span></a>            <span class="token_comment">#'resizable':'no'</span>
<a name="line951"><span class="token_number"> 951 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'resizable'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">resizableChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line952"><span class="token_number"> 952 </span></a>
<a name="line953"><span class="token_number"> 953 </span></a>            <span class="token_comment">#'guitype':'main',</span>
<a name="line954"><span class="token_number"> 954 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'guitype'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainOrDialog</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line955"><span class="token_number"> 955 </span></a>            
<a name="line956"><span class="token_number"> 956 </span></a>            <span class="token_comment">#'hideokbutton':'no'</span>
<a name="line957"><span class="token_number"> 957 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hideokbutton'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">hideOkChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line958"><span class="token_number"> 958 </span></a>
<a name="line959"><span class="token_number"> 959 </span></a>            <span class="token_comment">#'hasstddialmess':'no', </span>
<a name="line960"><span class="token_number"> 960 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialmess'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialMessChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line961"><span class="token_number"> 961 </span></a>
<a name="line962"><span class="token_number"> 962 </span></a>            <span class="token_comment">#'hasstddialcolor':'no', </span>
<a name="line963"><span class="token_number"> 963 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialcolor'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialColorChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line964"><span class="token_number"> 964 </span></a>
<a name="line965"><span class="token_number"> 965 </span></a>            <span class="token_comment">#'hasstddialfile':'no', </span>
<a name="line966"><span class="token_number"> 966 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstddialfile'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdDialFileChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line967"><span class="token_number"> 967 </span></a>
<a name="line968"><span class="token_number"> 968 </span></a>            <span class="token_comment">#'hasstdalarm':'no', </span>
<a name="line969"><span class="token_number"> 969 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">setSpecialOption</span><span class="token_op">(</span> <span class="token_string">'hasstdalarm'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">stdAlarmChkBox_StringVar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span> <span class="token_op">)</span>
<a name="line970"><span class="token_number"> 970 </span></a>            
<a name="line971"><span class="token_number"> 971 </span></a>            <span class="token_comment"># first save *.def file</span>
<a name="line972"><span class="token_number"> 972 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">saveAppDefFile</span><span class="token_op">(</span> <span class="token_name">savePathName</span><span class="token_op">=</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileFullName</span> <span class="token_op">):</span>
<a name="line973"><span class="token_number"> 973 </span></a>                <span class="token_comment"># if that goes OK, then save *.py file</span>
<a name="line974"><span class="token_number"> 974 </span></a>                                
<a name="line975"><span class="token_number"> 975 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">title</span><span class="token_op">(</span> <span class="token_string">'TkGridGUI: '</span> <span class="token_op">+</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span> <span class="token_op">)</span>
<a name="line976"><span class="token_number"> 976 </span></a>                
<a name="line977"><span class="token_number"> 977 </span></a>                <span class="token_name">sf</span> <span class="token_op">=</span> <span class="token_name">FormSource</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">self</span> <span class="token_op">)</span>
<a name="line978"><span class="token_number"> 978 </span></a>                <span class="token_name">sf</span><span class="token_op">.</span><span class="token_name">saveToFile</span><span class="token_op">()</span> <span class="token_comment"># save *.py file</span>
<a name="line979"><span class="token_number"> 979 </span></a>                
<a name="line980"><span class="token_number"> 980 </span></a>
<a name="line981"><span class="token_number"> 981 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Saved File: "%s"'</span><span class="token_op">%</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_fileName</span><span class="token_op">)</span>
<a name="line982"><span class="token_number"> 982 </span></a>                
<a name="line983"><span class="token_number"> 983 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">reset_crc_reference</span><span class="token_op">()</span> <span class="token_comment"># for detecting changes to model</span>
<a name="line984"><span class="token_number"> 984 </span></a>                
<a name="line985"><span class="token_number"> 985 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line986"><span class="token_number"> 986 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"WARNING... *.def file save failed.  NO SAVE PERFORMED."</span><span class="token_op">)</span>
<a name="line987"><span class="token_number"> 987 </span></a>
<a name="line988"><span class="token_number"> 988 </span></a>
<a name="line989"><span class="token_number"> 989 </span></a><span class="keyword">def</span> <span class="token_name">main</span><span class="token_op">():</span>
<a name="line990"><span class="token_number"> 990 </span></a>    
<a name="line991"><span class="token_number"> 991 </span></a><span class="text">    </span><span class="token_name">root</span> <span class="token_op">=</span> <span class="token_name">Tk</span><span class="token_op">()</span>
<a name="line992"><span class="token_number"> 992 </span></a>    <span class="token_name">MainWin</span> <span class="token_op">=</span> <span class="token_name">root</span>
<a name="line993"><span class="token_number"> 993 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">title</span><span class="token_op">(</span><span class="token_string">'Main Window'</span><span class="token_op">)</span>
<a name="line994"><span class="token_number"> 994 </span></a>    <span class="token_comment">#MainWin.geometry('320x320+10+10')</span>
<a name="line995"><span class="token_number"> 995 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">background</span><span class="token_op">=</span><span class="token_string">'#FFFACD'</span><span class="token_op">)</span><span class="token_comment">#'lemonchiffon': '#FFFACD'</span>
<a name="line996"><span class="token_number"> 996 </span></a>
<a name="line997"><span class="token_number"> 997 </span></a>    <span class="token_name">grid_gui</span> <span class="token_op">=</span> <span class="token_name">GridGUI</span><span class="token_op">(</span> <span class="token_name">MainWin</span> <span class="token_op">)</span>
<a name="line998"><span class="token_number"> 998 </span></a>    
<a name="line999"><span class="token_number"> 999 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainloop</span><span class="token_op">()</span>
<a name="line1000"><span class="token_number">1000 </span></a>
<a name="line1001"><span class="token_number">1001 </span></a><span class="keyword">if</span> <span class="token_name">__name__</span><span class="token_op">==</span><span class="token_string">"__main__"</span><span class="token_op">:</span>
<a name="line1002"><span class="token_number">1002 </span></a>    
<a name="line1003"><span class="token_number">1003 </span></a><span class="text">    </span><span class="token_name">main</span><span class="token_op">()    </pre></body>
</html>