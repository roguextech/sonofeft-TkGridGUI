<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
<title>grid_notebook.py</title>

<style type="text/css">
@media print { body { -webkit-print-color-adjust: exact; font-size: 9pt; } }
</style>

<style type="text/css">

pre
{
    font-face: verdana, arial, helvetica, sans-serif;
    font-size: 1.2em;
    
    word-break: break-all; /* webkit /
    white-space: pre;
    white-space: pre\9; / IE7+ */   

    white-space: pre-wrap;       /* css-3 */
    white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
    white-space: -pre-wrap;      /* Opera 4-6 */
    white-space: -o-pre-wrap;    /* Opera 7 */
    word-wrap: break-word;       /* Internet Explorer 5.5+ */

}
.token_number
{
    color: #0077b3;
    font-weight:500;
}
.token_op
{
    color: #000000;
    font-weight:bold;
}
.token_string
{
    color: #cc0000;
    font-weight:500;
}
.token_comment
{
    color: #007F00;
    font-weight:500;
}
.token_name
{
    color: #000000;
    font-weight:500;
}
.token_error
{
    color: #e40000;
    font-weight:500;
}
.keyword
{
    color: blue;
    font-weight:bold;
}
.text
{
    color: #000000;
    font-weight:500;
}

</style>
<body><h2>grid_notebook.py</h2>
<pre><font face="Lucida,Courier New">
directory : D:\2018_py_proj\TkGridGUI\tkgridgui
Line Count : 1490
Line Clip Size : No Clipping

<strong style="background-color:#ffe0e0">tab_of_notebook_changed</strong>  <strong style="background-color:#b4ffb2">Word</strong> <strong style="background-color:#b4ffb2">MatchCase</strong> <strong style="background-color:yellow">(0)</strong> <BR>
<a name="line1"><span class="token_number">   1 </span></a><span class="token_comment">#!/usr/bin/env python</span>
<a name="line2"><span class="token_number">   2 </span></a><span class="token_comment"># -*- coding: ascii -*-</span>
<a name="line3"><span class="token_number">   3 </span></a><span class="keyword">from</span> <span class="token_name">__future__</span> <span class="keyword">import</span> <span class="token_name">print_function</span>
<a name="line4"><span class="token_number">   4 </span></a><span class="keyword">from</span> <span class="token_name">__future__</span> <span class="keyword">import</span> <span class="token_name">unicode_literals</span>
<a name="line5"><span class="token_number">   5 </span></a>
<a name="line6"><span class="token_number">   6 </span></a><span class="keyword">from</span> <span class="token_name">future</span> <span class="keyword">import</span> <span class="token_name">standard_library</span>
<a name="line7"><span class="token_number">   7 </span></a><span class="token_name">standard_library</span><span class="token_op">.</span><span class="token_name">install_aliases</span><span class="token_op">()</span>
<a name="line8"><span class="token_number">   8 </span></a><span class="keyword">from</span> <span class="token_name">builtins</span> <span class="keyword">import</span> <span class="token_name">range</span>
<a name="line9"><span class="token_number">   9 </span></a><span class="keyword">from</span> <span class="token_name">builtins</span> <span class="keyword">import</span> <span class="token_name">object</span>
<a name="line10"><span class="token_number">  10 </span></a><span class="token_string">"""</span>
<a name="line11"><span class="token_number">  11 </span></a><span class="token_string">Notebook widget where grid geometry manager layout is defined.</span>
<a name="line12"><span class="token_number">  12 </span></a>
<a name="line13"><span class="token_number">  13 </span></a><span class="token_string">Each target position on the target GUI has a Tk widget type and generic name (like Button_1).</span>
<a name="line14"><span class="token_number">  14 </span></a>
<a name="line15"><span class="token_number">  15 </span></a><span class="token_string">More proper names can be added later (e.g. Button_1 can be named as Button_SaveFile)</span>
<a name="line16"><span class="token_number">  16 </span></a><span class="token_string">Detailed widget properties like color, style or text are assigned outside this file.</span>
<a name="line17"><span class="token_number">  17 </span></a><span class="token_string">These widgets only define locations and widget type.</span>
<a name="line18"><span class="token_number">  18 </span></a><span class="token_string">"""</span>
<a name="line19"><span class="token_number">  19 </span></a>
<a name="line20"><span class="token_number">  20 </span></a><span class="keyword">import</span> <span class="token_name">sys</span>
<a name="line21"><span class="token_number">  21 </span></a>
<a name="line22"><span class="token_number">  22 </span></a>    
<a name="line23"><span class="token_number">  23 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_op">*</span>
<a name="line24"><span class="token_number">  24 </span></a><span class="keyword">import</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span>
<a name="line25"><span class="token_number">  25 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">Button</span><span class="token_op">,</span> <span class="token_name">Canvas</span><span class="token_op">,</span> <span class="token_name">Checkbutton</span><span class="token_op">,</span> <span class="token_name">Entry</span><span class="token_op">,</span> <span class="token_name">Frame</span><span class="token_op">,</span> <span class="token_name">Label</span><span class="token_op">,</span> <span class="token_name">LabelFrame</span>
<a name="line26"><span class="token_number">  26 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">Listbox</span><span class="token_op">,</span> <span class="token_name">Message</span><span class="token_op">,</span> <span class="token_name">Radiobutton</span><span class="token_op">,</span> <span class="token_name">Spinbox</span><span class="token_op">,</span> <span class="token_name">Text</span>
<a name="line27"><span class="token_number">  27 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span> <span class="keyword">import</span> <span class="token_name">OptionMenu</span> <span class="token_comment"># ttk OptionMenu seems to be broken</span>
<a name="line28"><span class="token_number">  28 </span></a><span class="keyword">from</span> <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">ttk</span> <span class="keyword">import</span> <span class="token_name">Combobox</span><span class="token_op">,</span> <span class="token_name">Progressbar</span><span class="token_op">,</span> <span class="token_name">Separator</span><span class="token_op">,</span> <span class="token_name">Treeview</span><span class="token_op">,</span> <span class="token_name">Style</span><span class="token_op">,</span> <span class="token_name">Notebook</span>
<a name="line29"><span class="token_number">  29 </span></a>
<a name="line30"><span class="token_number">  30 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">edit_Dialog</span> <span class="keyword">import</span> <span class="token_name">Edit_Properties_Dialog</span>
<a name="line31"><span class="token_number">  31 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">wt_select_Dialog</span> <span class="keyword">import</span> <span class="token_name">Wt_Select_Dialog</span>
<a name="line32"><span class="token_number">  32 </span></a><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">comp_tree</span> <span class="keyword">import</span> <span class="token_name">CNode</span><span class="token_op">,</span> <span class="token_name">ComponentTree</span>
<a name="line33"><span class="token_number">  33 </span></a>
<a name="line34"><span class="token_number">  34 </span></a><span class="token_name">supportedTkWidgetSet</span> <span class="token_op">=</span> <span class="token_name">set</span><span class="token_op">(</span> <span class="token_op">[</span><span class="token_string">'Button'</span><span class="token_op">,</span> <span class="token_string">'Canvas'</span><span class="token_op">,</span> <span class="token_string">'Checkbutton'</span><span class="token_op">,</span> 
<a name="line35"><span class="token_number">  35 </span></a>    <span class="token_string">'Combobox'</span><span class="token_op">,</span> <span class="token_string">'Entry'</span><span class="token_op">,</span> <span class="token_string">'Frame'</span><span class="token_op">,</span><span class="token_string">'Label'</span><span class="token_op">,</span> <span class="token_string">'LabelFrame'</span><span class="token_op">,</span><span class="token_string">'Listbox'</span><span class="token_op">,</span> <span class="token_string">'Message'</span><span class="token_op">,</span> 
<a name="line36"><span class="token_number">  36 </span></a>    <span class="token_string">'Menubutton'</span><span class="token_op">,</span> <span class="token_string">'Notebook'</span> <span class="token_op">,</span><span class="token_string">'OptionMenu'</span><span class="token_op">,</span><span class="token_string">'Progressbar'</span><span class="token_op">,</span>
<a name="line37"><span class="token_number">  37 </span></a>    <span class="token_string">'Radiobutton'</span><span class="token_op">,</span> <span class="token_string">"RadioGroup"</span><span class="token_op">,</span> <span class="token_string">'Scale'</span><span class="token_op">,</span> <span class="token_string">'Separator'</span><span class="token_op">,</span> <span class="token_string">'Spinbox'</span><span class="token_op">,</span> <span class="token_string">'Text'</span><span class="token_op">,</span> <span class="token_string">'Treeview'</span><span class="token_op">,</span> <span class="token_string">'Tab'</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line38"><span class="token_number">  38 </span></a>
<a name="line39"><span class="token_number">  39 </span></a>
<a name="line40"><span class="token_number">  40 </span></a><span class="token_name">CONTROLS</span> <span class="token_op">=</span> <span class="token_op">[</span>
<a name="line41"><span class="token_number">  41 </span></a>    <span class="token_op">(</span><span class="token_string">"Button"</span><span class="token_op">,</span>      <span class="token_string">"#7CFC00"</span><span class="token_op">),</span> <span class="token_comment"># lawngreen</span>
<a name="line42"><span class="token_number">  42 </span></a>    <span class="token_op">(</span><span class="token_string">"Canvas"</span><span class="token_op">,</span>      <span class="token_string">"#40E0D0"</span><span class="token_op">),</span> <span class="token_comment"># turquiose</span>
<a name="line43"><span class="token_number">  43 </span></a>    <span class="token_op">(</span><span class="token_string">"Checkbutton"</span><span class="token_op">,</span> <span class="token_string">"#66CDAA"</span><span class="token_op">),</span> <span class="token_comment"># mediumaquamarine</span>
<a name="line44"><span class="token_number">  44 </span></a>    <span class="token_op">(</span><span class="token_string">"Combobox"</span><span class="token_op">,</span>    <span class="token_string">"#CD853F"</span><span class="token_op">),</span> <span class="token_comment"># peru</span>
<a name="line45"><span class="token_number">  45 </span></a>    <span class="token_op">(</span><span class="token_string">"Entry"</span><span class="token_op">,</span>       <span class="token_string">"#3CB371"</span><span class="token_op">),</span> <span class="token_comment"># mediumseagreen</span>
<a name="line46"><span class="token_number">  46 </span></a>    <span class="token_op">(</span><span class="token_string">"Frame"</span><span class="token_op">,</span>       <span class="token_string">"#F0E68C"</span><span class="token_op">),</span> <span class="token_comment"># khaki</span>
<a name="line47"><span class="token_number">  47 </span></a>    <span class="token_op">(</span><span class="token_string">"Label"</span><span class="token_op">,</span>       <span class="token_string">"#FFA500"</span><span class="token_op">),</span> <span class="token_comment"># orange</span>
<a name="line48"><span class="token_number">  48 </span></a>    <span class="token_op">(</span><span class="token_string">"LabelFrame"</span><span class="token_op">,</span>  <span class="token_string">"#FF7F50"</span><span class="token_op">),</span> <span class="token_comment"># coral</span>
<a name="line49"><span class="token_number">  49 </span></a>    <span class="token_op">(</span><span class="token_string">"Listbox"</span><span class="token_op">,</span>     <span class="token_string">"#F08080"</span><span class="token_op">),</span> <span class="token_comment"># lightcoral</span>
<a name="line50"><span class="token_number">  50 </span></a>    <span class="token_op">(</span><span class="token_string">"Message"</span><span class="token_op">,</span>     <span class="token_string">"#D8BFD8"</span><span class="token_op">),</span> <span class="token_comment"># thistle</span>
<a name="line51"><span class="token_number">  51 </span></a>    <span class="token_op">(</span><span class="token_string">"Menubutton"</span><span class="token_op">,</span>  <span class="token_string">"#DA70D6"</span><span class="token_op">),</span> <span class="token_comment"># orchid</span>
<a name="line52"><span class="token_number">  52 </span></a>    <span class="token_op">(</span><span class="token_string">"Notebook"</span><span class="token_op">,</span>    <span class="token_string">"#FA8072"</span><span class="token_op">),</span> <span class="token_comment"># salmon</span>
<a name="line53"><span class="token_number">  53 </span></a>    <span class="token_op">(</span><span class="token_string">"OptionMenu"</span><span class="token_op">,</span>  <span class="token_string">"#9370DB"</span><span class="token_op">),</span> <span class="token_comment"># mediumpurple</span>
<a name="line54"><span class="token_number">  54 </span></a>    <span class="token_op">(</span><span class="token_string">"Progressbar"</span><span class="token_op">,</span> <span class="token_string">"#FF69B4"</span><span class="token_op">),</span> <span class="token_comment"># hotpink</span>
<a name="line55"><span class="token_number">  55 </span></a>    <span class="token_op">(</span><span class="token_string">"Radiobutton"</span><span class="token_op">,</span> <span class="token_string">"#FFFF00"</span><span class="token_op">),</span> <span class="token_comment"># yellow:    also alternate form</span>
<a name="line56"><span class="token_number">  56 </span></a>    <span class="token_op">(</span><span class="token_string">"RadioGroup"</span><span class="token_op">,</span>  <span class="token_string">"#FFD700"</span><span class="token_op">),</span> <span class="token_comment"># gold:      also alternate form</span>
<a name="line57"><span class="token_number">  57 </span></a>    <span class="token_op">(</span><span class="token_string">"Scale"</span><span class="token_op">,</span>       <span class="token_string">"#FF4500"</span><span class="token_op">),</span> <span class="token_comment"># orangered  both vertical and horizontal</span>
<a name="line58"><span class="token_number">  58 </span></a>    <span class="token_op">(</span><span class="token_string">"Separator"</span><span class="token_op">,</span>   <span class="token_string">"#DC143C"</span><span class="token_op">),</span> <span class="token_comment"># crimson    both vertical and horizontal</span>
<a name="line59"><span class="token_number">  59 </span></a>    <span class="token_op">(</span><span class="token_string">"Spinbox"</span><span class="token_op">,</span>     <span class="token_string">"#1E90FF"</span><span class="token_op">),</span> <span class="token_comment"># dodgerblue</span>
<a name="line60"><span class="token_number">  60 </span></a>    <span class="token_op">(</span><span class="token_string">"Text"</span><span class="token_op">,</span>        <span class="token_string">"#D2B48C"</span><span class="token_op">),</span> <span class="token_comment"># tan</span>
<a name="line61"><span class="token_number">  61 </span></a>    <span class="token_op">(</span><span class="token_string">"Treeview"</span><span class="token_op">,</span>    <span class="token_string">"#BC8F8F"</span><span class="token_op">),</span> <span class="token_comment"># rosybrown</span>
<a name="line62"><span class="token_number">  62 </span></a>    <span class="token_op">]</span>
<a name="line63"><span class="token_number">  63 </span></a>
<a name="line64"><span class="token_number">  64 </span></a><span class="token_name">ContainerControlsL</span> <span class="token_op">=</span> <span class="token_op">[</span><span class="token_string">'Frame'</span><span class="token_op">,</span><span class="token_string">'LabelFrame'</span><span class="token_op">,</span><span class="token_string">'Notebook'</span><span class="token_op">,</span><span class="token_string">'RadioGroup'</span><span class="token_op">,</span><span class="token_string">'Tab'</span><span class="token_op">]</span>
<a name="line65"><span class="token_number">  65 </span></a>
<a name="line66"><span class="token_number">  66 </span></a><span class="token_name">CONTROL_COLOR_D</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=Control Name: value=color hex string (initialized from CONTROLS)</span>
<a name="line67"><span class="token_number">  67 </span></a><span class="token_name">CONTROL_NEXT_NUMBER_D</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=Control Name, value=next number for generic names</span>
<a name="line68"><span class="token_number">  68 </span></a>
<a name="line69"><span class="token_number">  69 </span></a><span class="keyword">for</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">color</span> <span class="keyword">in</span> <span class="token_name">CONTROLS</span><span class="token_op">:</span>
<a name="line70"><span class="token_number">  70 </span></a><span class="text">    </span><span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">color</span>
<a name="line71"><span class="token_number">  71 </span></a>    <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_number">1</span> <span class="token_comment"># all start with 1</span>
<a name="line72"><span class="token_number">  72 </span></a>
<a name="line73"><span class="token_number">  73 </span></a><span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span><span class="token_string">'Tab'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">'#cccccc'</span>
<a name="line74"><span class="token_number">  74 </span></a><span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_string">'Tab'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_number">1</span>
<a name="line75"><span class="token_number">  75 </span></a>
<a name="line76"><span class="token_number">  76 </span></a><span class="keyword">def</span> <span class="token_name">intCast</span><span class="token_op">(</span> <span class="token_name">val</span><span class="token_op">=</span><span class="token_number">0</span> <span class="token_op">):</span>
<a name="line77"><span class="token_number">  77 </span></a><span class="text">    </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line78"><span class="token_number">  78 </span></a><span class="text">        </span><span class="keyword">return</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">val</span><span class="token_op">)</span>
<a name="line79"><span class="token_number">  79 </span></a>    <span class="keyword">except</span><span class="token_op">:</span>
<a name="line80"><span class="token_number">  80 </span></a><span class="text">        </span><span class="keyword">return</span> <span class="token_number">0</span>
<a name="line81"><span class="token_number">  81 </span></a>
<a name="line82"><span class="token_number">  82 </span></a><span class="token_name">MAX_NUM_COLS</span> <span class="token_op">=</span> <span class="token_number">10</span>
<a name="line83"><span class="token_number">  83 </span></a><span class="token_name">MAX_NUM_ROWS</span> <span class="token_op">=</span> <span class="token_number">15</span>
<a name="line84"><span class="token_number">  84 </span></a>
<a name="line85"><span class="token_number">  85 </span></a><span class="keyword">class</span> <span class="token_name">NotebookGridDes</span><span class="token_op">(</span> <span class="token_name">Frame</span> <span class="token_op">):</span>
<a name="line86"><span class="token_number">  86 </span></a><span class="text">    </span><span class="token_string">"""A ttk.Notebook used to design grid geometry manager layouts"""</span>
<a name="line87"><span class="token_number">  87 </span></a>    
<a name="line88"><span class="token_number">  88 </span></a>
<a name="line89"><span class="token_number">  89 </span></a>    <span class="keyword">def</span> <span class="token_name">__init__</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">grid_gui</span><span class="token_op">,</span> <span class="token_name">mainFrame</span><span class="token_op">,</span>  <span class="token_name">MainWin</span><span class="token_op">,</span>  <span class="token_name">name</span><span class="token_op">=</span><span class="token_string">'grid_notebook'</span><span class="token_op">,</span> <span class="token_name">num_cols</span><span class="token_op">=</span><span class="token_number">5</span><span class="token_op">,</span> <span class="token_name">num_rows</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">):</span>
<a name="line90"><span class="token_number">  90 </span></a><span class="text">        </span><span class="token_string">"""Create ttk.Notebook used to design grid geometry manager layouts"""</span>
<a name="line91"><span class="token_number">  91 </span></a>        
<a name="line92"><span class="token_number">  92 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span> <span class="token_op">=</span> <span class="token_name">grid_gui</span>
<a name="line93"><span class="token_number">  93 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">mainFrame</span> <span class="token_op">=</span> <span class="token_name">mainFrame</span>
<a name="line94"><span class="token_number">  94 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span> <span class="token_op">=</span> <span class="token_name">MainWin</span>
<a name="line95"><span class="token_number">  95 </span></a>        
<a name="line96"><span class="token_number">  96 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_cols_inp</span> <span class="token_op">=</span> <span class="token_name">num_cols</span>
<a name="line97"><span class="token_number">  97 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_rows_inp</span> <span class="token_op">=</span> <span class="token_name">num_rows</span>
<a name="line98"><span class="token_number">  98 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=tab_label: value=(num_row, num_cols)</span>
<a name="line99"><span class="token_number">  99 </span></a>        
<a name="line100"><span class="token_number"> 100 </span></a>        <span class="token_name">Frame</span><span class="token_op">.</span><span class="token_name">__init__</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">mainFrame</span><span class="token_op">,</span> <span class="token_name">name</span><span class="token_op">=</span><span class="token_name">name</span><span class="token_op">)</span>
<a name="line101"><span class="token_number"> 101 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">expand</span><span class="token_op">=</span><span class="token_name">Y</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">BOTH</span><span class="token_op">)</span>
<a name="line102"><span class="token_number"> 102 </span></a>        
<a name="line103"><span class="token_number"> 103 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span> <span class="token_op">=</span> <span class="token_name">None</span>
<a name="line104"><span class="token_number"> 104 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">initialize_NotebookGridDes</span><span class="token_op">()</span>
<a name="line105"><span class="token_number"> 105 </span></a>    
<a name="line106"><span class="token_number"> 106 </span></a>    <span class="keyword">def</span> <span class="token_name">initialize_NotebookGridDes</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line107"><span class="token_number"> 107 </span></a><span class="text">        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span> <span class="token_op">=</span> <span class="token_op">[]</span> <span class="token_comment"># list of notebook tabs in order of addition</span>
<a name="line108"><span class="token_number"> 108 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">nbFrameL</span> <span class="token_op">=</span> <span class="token_op">[]</span> <span class="token_comment"># list of Frame objects for each tab in notebook</span>
<a name="line109"><span class="token_number"> 109 </span></a>        
<a name="line110"><span class="token_number"> 110 </span></a>        <span class="token_comment"># need to have widget dictionaries for each tab of notebook</span>
<a name="line111"><span class="token_number"> 111 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">colInsertWidgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=(tab_label, col_interface): value=Label Widget</span>
<a name="line112"><span class="token_number"> 112 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">rowInsertWidgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=(tab_label, row_interface): value=Label Widget</span>
<a name="line113"><span class="token_number"> 113 </span></a>
<a name="line114"><span class="token_number"> 114 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">colWeightsWidgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=(tab_label, col_interface): value=Label Widget</span>
<a name="line115"><span class="token_number"> 115 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">rowWeightsWidgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=(tab_label, row_interface): value=Label Widget</span>
<a name="line116"><span class="token_number"> 116 </span></a>
<a name="line117"><span class="token_number"> 117 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span> <span class="token_comment"># index=(tab_label, row_interface, col_interface): value=Label Widget</span>
<a name="line118"><span class="token_number"> 118 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_string">"Courier"</span><span class="token_op">,</span> <span class="token_number">8</span><span class="token_op">,</span> <span class="token_string">"normal"</span><span class="token_op">)</span> <span class="token_comment"># will be set when interface_gridBoxWidgetD is initialized</span>
<a name="line119"><span class="token_number"> 119 </span></a>        
<a name="line120"><span class="token_number"> 120 </span></a>        <span class="token_comment"># NOTE: row_target, col_target for defined_target_widgetD</span>
<a name="line121"><span class="token_number"> 121 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span>   <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType or ''</span>
<a name="line122"><span class="token_number"> 122 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span> <span class="token_op">=</span> <span class="token_op">{}</span>     <span class="token_comment"># index=widget_name (e.g. Button_1): </span>
<a name="line123"><span class="token_number"> 123 </span></a>        <span class="token_comment">#                                    value=(tab_label, row_target, col_target, placementWidgetType, Labelobj)</span>
<a name="line124"><span class="token_number"> 124 </span></a>        
<a name="line125"><span class="token_number"> 125 </span></a>        <span class="keyword">del</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span> <span class="token_comment"># start over</span>
<a name="line126"><span class="token_number"> 126 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span> <span class="token_op">=</span> <span class="token_name">Notebook</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">name</span><span class="token_op">=</span><span class="token_string">'main'</span><span class="token_op">)</span>
<a name="line127"><span class="token_number"> 127 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">BOTH</span><span class="token_op">,</span> <span class="token_name">expand</span><span class="token_op">=</span><span class="token_name">Y</span><span class="token_op">,</span> <span class="token_name">padx</span><span class="token_op">=</span><span class="token_number">2</span><span class="token_op">,</span> <span class="token_name">pady</span><span class="token_op">=</span><span class="token_number">3</span><span class="token_op">)</span>
<a name="line128"><span class="token_number"> 128 </span></a>        
<a name="line129"><span class="token_number"> 129 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_label_being_edited</span> <span class="token_op">=</span> <span class="token_name">None</span> <span class="token_comment"># used as flag in onGridBoxLeave to maintain hightlight</span>
<a name="line130"><span class="token_number"> 130 </span></a>        
<a name="line131"><span class="token_number"> 131 </span></a>        
<a name="line132"><span class="token_number"> 132 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_h</span> <span class="token_op">=</span> <span class="token_name">True</span>
<a name="line133"><span class="token_number"> 133 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">=</span> <span class="token_number">46</span>  <span class="token_comment"># initial guesstimate of widget height</span>
<a name="line134"><span class="token_number"> 134 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line135"><span class="token_number"> 135 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line136"><span class="token_number"> 136 </span></a>        
<a name="line137"><span class="token_number"> 137 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_w</span> <span class="token_op">=</span> <span class="token_name">True</span>
<a name="line138"><span class="token_number"> 138 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">=</span> <span class="token_number">116</span>  <span class="token_comment"># initial guesstimate of widget width</span>
<a name="line139"><span class="token_number"> 139 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line140"><span class="token_number"> 140 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line141"><span class="token_number"> 141 </span></a>        
<a name="line142"><span class="token_number"> 142 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">drag_set</span> <span class="token_op">=</span> <span class="token_name">set</span><span class="token_op">()</span> <span class="token_comment"># set of possible target widgets for drag and drop</span>
<a name="line143"><span class="token_number"> 143 </span></a>
<a name="line144"><span class="token_number"> 144 </span></a>        
<a name="line145"><span class="token_number"> 145 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">create_tab</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_string">"Main"</span><span class="token_op">)</span>
<a name="line146"><span class="token_number"> 146 </span></a>        <span class="token_comment">#self.create_tab(tab_label="Test Frame")</span>
<a name="line147"><span class="token_number"> 147 </span></a>        
<a name="line148"><span class="token_number"> 148 </span></a>    
<a name="line149"><span class="token_number"> 149 </span></a>    <span class="keyword">def</span> <span class="token_name">highlight_grid_widget</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">):</span>
<a name="line150"><span class="token_number"> 150 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">:</span>
<a name="line151"><span class="token_number"> 151 </span></a><span class="text">            </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line152"><span class="token_number"> 152 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">'font'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_string">"Helvetica"</span><span class="token_op">,</span> <span class="token_number">12</span><span class="token_op">,</span> <span class="token_string">"bold italic underline"</span><span class="token_op">)</span>
<a name="line153"><span class="token_number"> 153 </span></a>
<a name="line154"><span class="token_number"> 154 </span></a>    <span class="keyword">def</span> <span class="token_name">unhighlight_grid_widget</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">):</span>
<a name="line155"><span class="token_number"> 155 </span></a><span class="text">        </span><span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">:</span>
<a name="line156"><span class="token_number"> 156 </span></a><span class="text">            </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line157"><span class="token_number"> 157 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">'font'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line158"><span class="token_number"> 158 </span></a>
<a name="line159"><span class="token_number"> 159 </span></a>    
<a name="line160"><span class="token_number"> 160 </span></a>    <span class="keyword">def</span> <span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">Labelobj</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line161"><span class="token_number"> 161 </span></a><span class="text">        </span><span class="token_string">"""Try to add some helpful info onto line3 of labels"""</span>
<a name="line162"><span class="token_number"> 162 </span></a>
<a name="line163"><span class="token_number"> 163 </span></a>        <span class="token_name">Labelobj</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span> <span class="token_name">placementWidgetType</span> <span class="token_op">]</span> <span class="token_comment"># aka widget_type</span>
<a name="line164"><span class="token_number"> 164 </span></a>
<a name="line165"><span class="token_number"> 165 </span></a>        <span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">:</span>
<a name="line166"><span class="token_number"> 166 </span></a>            
<a name="line167"><span class="token_number"> 167 </span></a><span class="text">            </span><span class="token_name">Labelobj</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n%s\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">)</span>
<a name="line168"><span class="token_number"> 168 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line169"><span class="token_number"> 169 </span></a><span class="text">            </span><span class="keyword">def</span> <span class="token_name">fitted_line3</span><span class="token_op">(</span> <span class="token_name">s</span> <span class="token_op">):</span>
<a name="line170"><span class="token_number"> 170 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">len</span><span class="token_op">(</span><span class="token_name">s</span><span class="token_op">)&lt;</span><span class="token_number">15</span><span class="token_op">:</span>
<a name="line171"><span class="token_number"> 171 </span></a><span class="text">                    </span><span class="keyword">return</span> <span class="token_name">s</span>
<a name="line172"><span class="token_number"> 172 </span></a>                <span class="keyword">return</span> <span class="token_name">s</span><span class="token_op">[:</span><span class="token_number">12</span><span class="token_op">]</span> <span class="token_op">+</span> <span class="token_string">'...'</span>
<a name="line173"><span class="token_number"> 173 </span></a>            
<a name="line174"><span class="token_number"> 174 </span></a>            <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line175"><span class="token_number"> 175 </span></a>            
<a name="line176"><span class="token_number"> 176 </span></a>            <span class="token_comment"># only works if target_app has widget_name</span>
<a name="line177"><span class="token_number"> 177 </span></a>            <span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">:</span>
<a name="line178"><span class="token_number"> 178 </span></a><span class="text">                </span><span class="token_name">c</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line179"><span class="token_number"> 179 </span></a>                <span class="token_name">text</span> <span class="token_op">=</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'text'</span><span class="token_op">,</span><span class="token_string">''</span><span class="token_op">)</span>
<a name="line180"><span class="token_number"> 180 </span></a>                
<a name="line181"><span class="token_number"> 181 </span></a>                <span class="keyword">if</span> <span class="token_name">text</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">text</span> <span class="token_op">!=</span> <span class="token_name">widget_name</span><span class="token_op">):</span>
<a name="line182"><span class="token_number"> 182 </span></a><span class="text">                    </span><span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">fitted_line3</span><span class="token_op">(</span> <span class="token_name">text</span> <span class="token_op">)</span>
<a name="line183"><span class="token_number"> 183 </span></a>                <span class="keyword">elif</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'docstring'</span><span class="token_op">,</span><span class="token_string">''</span><span class="token_op">):</span>
<a name="line184"><span class="token_number"> 184 </span></a><span class="text">                    </span><span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">fitted_line3</span><span class="token_op">(</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'docstring'</span><span class="token_op">,</span><span class="token_string">''</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line185"><span class="token_number"> 185 </span></a>            
<a name="line186"><span class="token_number"> 186 </span></a>            <span class="token_name">Labelobj</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n%s\n%s"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span><span class="token_op">)</span>
<a name="line187"><span class="token_number"> 187 </span></a>        
<a name="line188"><span class="token_number"> 188 </span></a>    
<a name="line189"><span class="token_number"> 189 </span></a>    <span class="keyword">def</span> <span class="token_name">set_row_column_weights_from_target_app</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line190"><span class="token_number"> 190 </span></a><span class="text">        </span><span class="token_string">"""Needs to set all weight Label widgets to show row/col weights"""</span>
<a name="line191"><span class="token_number"> 191 </span></a>        <span class="token_comment"># self.colWeightsWidgetD = {} # index=(tab_label, col_interface): value=Label Widget</span>
<a name="line192"><span class="token_number"> 192 </span></a>        
<a name="line193"><span class="token_number"> 193 </span></a>        <span class="token_comment"># rowD and colD: index=(tab_label,row_target), value=wt</span>
<a name="line194"><span class="token_number"> 194 </span></a>        <span class="token_name">rowD</span><span class="token_op">,</span> <span class="token_name">colD</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">get_a_full_desc_of_weights</span><span class="token_op">()</span>
<a name="line195"><span class="token_number"> 195 </span></a>        
<a name="line196"><span class="token_number"> 196 </span></a>        <span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">),</span> <span class="token_name">label</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">colWeightsWidgetD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line197"><span class="token_number"> 197 </span></a><span class="text">            </span><span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">col_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line198"><span class="token_number"> 198 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">colD</span><span class="token_op">:</span>
<a name="line199"><span class="token_number"> 199 </span></a><span class="text">                </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_name">colD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line200"><span class="token_number"> 200 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line201"><span class="token_number"> 201 </span></a><span class="text">                </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line202"><span class="token_number"> 202 </span></a>            
<a name="line203"><span class="token_number"> 203 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"col:%i\nwt:%s"</span><span class="token_op">%(</span><span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line204"><span class="token_number"> 204 </span></a>            <span class="keyword">if</span> <span class="token_name">wt</span> <span class="token_op">&gt;</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line205"><span class="token_number"> 205 </span></a><span class="text">                </span><span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#ff6060"</span>
<a name="line206"><span class="token_number"> 206 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line207"><span class="token_number"> 207 </span></a><span class="text">                </span><span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line208"><span class="token_number"> 208 </span></a>        
<a name="line209"><span class="token_number"> 209 </span></a>        <span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">),</span> <span class="token_name">label</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">rowWeightsWidgetD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line210"><span class="token_number"> 210 </span></a><span class="text">            </span><span class="token_name">row_target</span> <span class="token_op">=</span> <span class="token_name">row_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line211"><span class="token_number"> 211 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">rowD</span><span class="token_op">:</span>
<a name="line212"><span class="token_number"> 212 </span></a><span class="text">                </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_name">rowD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line213"><span class="token_number"> 213 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line214"><span class="token_number"> 214 </span></a><span class="text">                </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line215"><span class="token_number"> 215 </span></a>            
<a name="line216"><span class="token_number"> 216 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"row:%i\nwt:%s"</span><span class="token_op">%(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line217"><span class="token_number"> 217 </span></a>            <span class="keyword">if</span> <span class="token_name">wt</span> <span class="token_op">&gt;</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line218"><span class="token_number"> 218 </span></a><span class="text">                </span><span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#ff6060"</span>
<a name="line219"><span class="token_number"> 219 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line220"><span class="token_number"> 220 </span></a><span class="text">                </span><span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line221"><span class="token_number"> 221 </span></a>            
<a name="line222"><span class="token_number"> 222 </span></a>    <span class="keyword">def</span> <span class="token_name">repaint_all_labels</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line223"><span class="token_number"> 223 </span></a>        
<a name="line224"><span class="token_number"> 224 </span></a>        <span class="token_comment"># start by painting all label widgets lemonchiffon</span>
<a name="line225"><span class="token_number"> 225 </span></a><span class="text">        </span><span class="keyword">for</span> <span class="token_name">tab_label</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">:</span>
<a name="line226"><span class="token_number"> 226 </span></a><span class="text">            </span><span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line227"><span class="token_number"> 227 </span></a>            
<a name="line228"><span class="token_number"> 228 </span></a>            <span class="keyword">for</span> <span class="token_name">row_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_rows</span> <span class="token_op">):</span>
<a name="line229"><span class="token_number"> 229 </span></a><span class="text">                </span><span class="token_name">row_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line230"><span class="token_number"> 230 </span></a>                <span class="keyword">for</span> <span class="token_name">col_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_cols</span> <span class="token_op">):</span>
<a name="line231"><span class="token_number"> 231 </span></a><span class="text">                    </span><span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">col_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line232"><span class="token_number"> 232 </span></a>                    <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line233"><span class="token_number"> 233 </span></a>                    <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line234"><span class="token_number"> 234 </span></a>                    <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line235"><span class="token_number"> 235 </span></a>            
<a name="line236"><span class="token_number"> 236 </span></a>        <span class="token_comment"># place defined widgets where they belong        </span>
<a name="line237"><span class="token_number"> 237 </span></a>        
<a name="line238"><span class="token_number"> 238 </span></a>        <span class="token_comment"># save any info on rowspan and columnspan</span>
<a name="line239"><span class="token_number"> 239 </span></a>        <span class="token_name">row_col_spanL</span> <span class="token_op">=</span> <span class="token_op">[]</span> <span class="token_comment"># do not place rowspan or columnspan on 1st pass. Save for 2nd pass.</span>
<a name="line240"><span class="token_number"> 240 </span></a>        
<a name="line241"><span class="token_number"> 241 </span></a>        <span class="keyword">for</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line242"><span class="token_number"> 242 </span></a>            
<a name="line243"><span class="token_number"> 243 </span></a><span class="text">            </span><span class="token_name">row_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line244"><span class="token_number"> 244 </span></a>            <span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">col_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line245"><span class="token_number"> 245 </span></a>            <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line246"><span class="token_number"> 246 </span></a>            
<a name="line247"><span class="token_number"> 247 </span></a>            <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line248"><span class="token_number"> 248 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line249"><span class="token_number"> 249 </span></a>            <span class="token_comment">#    label["text"      ] = "(%d,%d)\n%s\n" % (row_target, col_target, widget_name)</span>
<a name="line250"><span class="token_number"> 250 </span></a>            <span class="token_comment">#    label["background"] = CONTROL_COLOR_D[ widget_type ]</span>
<a name="line251"><span class="token_number"> 251 </span></a>
<a name="line252"><span class="token_number"> 252 </span></a>            
<a name="line253"><span class="token_number"> 253 </span></a>            <span class="token_comment"># if any rowspan/columnspan, show them</span>
<a name="line254"><span class="token_number"> 254 </span></a>            <span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line255"><span class="token_number"> 255 </span></a>            <span class="token_name">rowspan</span>    <span class="token_op">=</span> <span class="token_name">max</span><span class="token_op">(</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">intCast</span><span class="token_op">(</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'rowspan'</span><span class="token_op">,</span><span class="token_number">1</span><span class="token_op">)</span> <span class="token_op">))</span>
<a name="line256"><span class="token_number"> 256 </span></a>            <span class="token_name">columnspan</span> <span class="token_op">=</span> <span class="token_name">max</span><span class="token_op">(</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">intCast</span><span class="token_op">(</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span><span class="token_string">'columnspan'</span><span class="token_op">,</span><span class="token_number">1</span><span class="token_op">)</span> <span class="token_op">))</span>
<a name="line257"><span class="token_number"> 257 </span></a>            <span class="keyword">if</span> <span class="token_name">rowspan</span><span class="token_op">&gt;</span><span class="token_number">1</span> <span class="keyword">or</span> <span class="token_name">columnspan</span><span class="token_op">&gt;</span><span class="token_number">1</span><span class="token_op">:</span>
<a name="line258"><span class="token_number"> 258 </span></a>                <span class="token_comment"># need to show rowspan/columnspan grid labels.</span>
<a name="line259"><span class="token_number"> 259 </span></a><span class="text">                </span><span class="keyword">for</span> <span class="token_name">i</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">columnspan</span><span class="token_op">)</span> <span class="token_op">):</span>
<a name="line260"><span class="token_number"> 260 </span></a><span class="text">                    </span><span class="keyword">for</span> <span class="token_name">j</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">rowspan</span><span class="token_op">)</span> <span class="token_op">):</span>
<a name="line261"><span class="token_number"> 261 </span></a><span class="text">                        </span><span class="keyword">if</span> <span class="token_name">i</span><span class="token_op">!=</span><span class="token_number">0</span> <span class="keyword">or</span> <span class="token_name">j</span><span class="token_op">!=</span><span class="token_number">0</span><span class="token_op">:</span>
<a name="line262"><span class="token_number"> 262 </span></a><span class="text">                            </span><span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">col_target</span> <span class="token_op">+</span> <span class="token_number">1</span> <span class="token_op">+</span> <span class="token_name">i</span>
<a name="line263"><span class="token_number"> 263 </span></a>                            <span class="token_name">row_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span> <span class="token_op">+</span> <span class="token_number">1</span> <span class="token_op">+</span> <span class="token_name">j</span>
<a name="line264"><span class="token_number"> 264 </span></a>                            
<a name="line265"><span class="token_number"> 265 </span></a>                            <span class="token_name">ctarg</span> <span class="token_op">=</span> <span class="token_name">col_target</span> <span class="token_op">+</span> <span class="token_name">i</span>
<a name="line266"><span class="token_number"> 266 </span></a>                            <span class="token_name">rtarg</span> <span class="token_op">=</span> <span class="token_name">row_target</span> <span class="token_op">+</span> <span class="token_name">j</span>
<a name="line267"><span class="token_number"> 267 </span></a>                            
<a name="line268"><span class="token_number"> 268 </span></a>                            <span class="token_comment"># Make sure grid is big enough to hold span labels</span>
<a name="line269"><span class="token_number"> 269 </span></a>                            
<a name="line270"><span class="token_number"> 270 </span></a>                            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">ctarg</span> <span class="token_op">&lt;</span> <span class="token_name">num_cols</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">rtarg</span> <span class="token_op">&lt;</span> <span class="token_name">num_rows</span><span class="token_op">):</span>
<a name="line271"><span class="token_number"> 271 </span></a>                                <span class="token_comment"># ignore any rowspan or columnspan that falls off the grid</span>
<a name="line272"><span class="token_number"> 272 </span></a>                            
<a name="line273"><span class="token_number"> 273 </span></a><span class="text">                                </span><span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line274"><span class="token_number"> 274 </span></a>                                <span class="token_comment">#label["text"      ] = "(%d,%d)\n%s\n%s" % (row_target, col_target, widget_name, '---SPAN---')</span>
<a name="line275"><span class="token_number"> 275 </span></a>                                <span class="token_comment">#label["background"] = CONTROL_COLOR_D[widget_type]</span>
<a name="line276"><span class="token_number"> 276 </span></a>                                
<a name="line277"><span class="token_number"> 277 </span></a>                                <span class="keyword">if</span> <span class="token_name">rowspan</span><span class="token_op">&gt;</span><span class="token_number">1</span> <span class="keyword">and</span> <span class="token_name">columnspan</span><span class="token_op">&gt;</span><span class="token_number">1</span><span class="token_op">:</span>
<a name="line278"><span class="token_number"> 278 </span></a><span class="text">                                    </span><span class="token_name">text</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n%s\n%s"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">'col+rowspan'</span><span class="token_op">)</span>
<a name="line279"><span class="token_number"> 279 </span></a>                                <span class="keyword">elif</span> <span class="token_name">rowspan</span><span class="token_op">&gt;</span><span class="token_number">1</span><span class="token_op">:</span>
<a name="line280"><span class="token_number"> 280 </span></a><span class="text">                                    </span><span class="token_name">text</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n%s\n%s"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">'rowspan'</span><span class="token_op">)</span>
<a name="line281"><span class="token_number"> 281 </span></a>                                <span class="keyword">else</span><span class="token_op">:</span>
<a name="line282"><span class="token_number"> 282 </span></a><span class="text">                                    </span><span class="token_name">text</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n%s\n%s"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">'columnspan'</span><span class="token_op">)</span>
<a name="line283"><span class="token_number"> 283 </span></a>                                
<a name="line284"><span class="token_number"> 284 </span></a>                                <span class="token_name">bg</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span>
<a name="line285"><span class="token_number"> 285 </span></a>                                
<a name="line286"><span class="token_number"> 286 </span></a>                                <span class="token_name">row_col_spanL</span><span class="token_op">.</span><span class="token_name">append</span><span class="token_op">(</span> <span class="token_op">(</span><span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">,</span> <span class="token_name">bg</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line287"><span class="token_number"> 287 </span></a>                        
<a name="line288"><span class="token_number"> 288 </span></a>        <span class="keyword">if</span> <span class="token_name">row_col_spanL</span><span class="token_op">:</span>
<a name="line289"><span class="token_number"> 289 </span></a><span class="text">            </span><span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">,</span> <span class="token_name">bg</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">row_col_spanL</span><span class="token_op">:</span>
<a name="line290"><span class="token_number"> 290 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_empty</span><span class="token_op">(</span><span class="token_name">label</span><span class="token_op">):</span>
<a name="line291"><span class="token_number"> 291 </span></a><span class="text">                    </span><span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">text</span>
<a name="line292"><span class="token_number"> 292 </span></a>                    <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">bg</span>
<a name="line293"><span class="token_number"> 293 </span></a>                <span class="keyword">else</span><span class="token_op">:</span>
<a name="line294"><span class="token_number"> 294 </span></a><span class="text">                    </span><span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line295"><span class="token_number"> 295 </span></a>                    <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span>
<a name="line296"><span class="token_number"> 296 </span></a>                    <span class="token_name">sL</span><span class="token_op">[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">'???SPAN ERROR???'</span>
<a name="line297"><span class="token_number"> 297 </span></a>                    <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">'\n'</span><span class="token_op">.</span><span class="token_name">join</span><span class="token_op">(</span><span class="token_name">sL</span><span class="token_op">)</span>
<a name="line298"><span class="token_number"> 298 </span></a>                    <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#ff9797"</span>
<a name="line299"><span class="token_number"> 299 </span></a>        
<a name="line300"><span class="token_number"> 300 </span></a>    
<a name="line301"><span class="token_number"> 301 </span></a>    <span class="keyword">def</span> <span class="token_name">set_complete_list_of_widgets</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widgetL</span><span class="token_op">):</span>
<a name="line302"><span class="token_number"> 302 </span></a><span class="text">        </span><span class="token_string">"""</span>
<a name="line303"><span class="token_number"> 303 </span></a><span class="token_string">        Start over with full list of tuples describing all the widgets.</span>
<a name="line304"><span class="token_number"> 304 </span></a><span class="token_string">        Tuples = (widget_type, widget_name, tab_label, row_target, col_target)</span>
<a name="line305"><span class="token_number"> 305 </span></a><span class="token_string">        """</span>
<a name="line306"><span class="token_number"> 306 </span></a>        
<a name="line307"><span class="token_number"> 307 </span></a>        <span class="token_comment"># put the widgets into order of dependency</span>
<a name="line308"><span class="token_number"> 308 </span></a>        <span class="token_comment"># widgetL = list of (c.widget_type, c.widget_name, c.tab_label, c.row, c.col)</span>
<a name="line309"><span class="token_number"> 309 </span></a>        <span class="token_name">ct</span> <span class="token_op">=</span> <span class="token_name">ComponentTree</span><span class="token_op">()</span>
<a name="line310"><span class="token_number"> 310 </span></a>        <span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">widgetL</span><span class="token_op">:</span>
<a name="line311"><span class="token_number"> 311 </span></a><span class="text">            </span><span class="token_name">c</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line312"><span class="token_number"> 312 </span></a>            <span class="token_name">ct</span><span class="token_op">.</span><span class="token_name">add_node</span><span class="token_op">(</span> <span class="token_name">CNode</span><span class="token_op">(</span><span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line313"><span class="token_number"> 313 </span></a>            
<a name="line314"><span class="token_number"> 314 </span></a>        <span class="token_name">cnodeL</span> <span class="token_op">=</span> <span class="token_name">ct</span><span class="token_op">.</span><span class="token_name">get_ordered_components</span><span class="token_op">()</span>
<a name="line315"><span class="token_number"> 315 </span></a>        <span class="token_name">cL</span> <span class="token_op">=</span> <span class="token_op">[</span><span class="token_name">cnode</span><span class="token_op">.</span><span class="token_name">component</span> <span class="keyword">for</span> <span class="token_name">cnode</span> <span class="keyword">in</span> <span class="token_name">cnodeL</span><span class="token_op">]</span>
<a name="line316"><span class="token_number"> 316 </span></a>        <span class="token_name">widgetL</span> <span class="token_op">=</span> <span class="token_op">[(</span><span class="token_name">c</span><span class="token_op">.</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">c</span><span class="token_op">.</span><span class="token_name">col</span><span class="token_op">)</span> <span class="keyword">for</span> <span class="token_name">c</span> <span class="keyword">in</span> <span class="token_name">cL</span> <span class="token_op">]</span>
<a name="line317"><span class="token_number"> 317 </span></a>        
<a name="line318"><span class="token_number"> 318 </span></a>        <span class="token_comment">#print("NOTE... called set_complete_list_of_widgets.")</span>
<a name="line319"><span class="token_number"> 319 </span></a>        <span class="token_comment">#print( widgetL )</span>
<a name="line320"><span class="token_number"> 320 </span></a>        
<a name="line321"><span class="token_number"> 321 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">initialize_NotebookGridDes</span><span class="token_op">()</span>
<a name="line322"><span class="token_number"> 322 </span></a>
<a name="line323"><span class="token_number"> 323 </span></a>        <span class="keyword">for</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">color</span> <span class="keyword">in</span> <span class="token_name">CONTROLS</span><span class="token_op">:</span>
<a name="line324"><span class="token_number"> 324 </span></a><span class="text">            </span><span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_number">1</span> <span class="token_comment"># all start with 1</span>
<a name="line325"><span class="token_number"> 325 </span></a>        <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_string">'Tab'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_number">1</span>
<a name="line326"><span class="token_number"> 326 </span></a>        
<a name="line327"><span class="token_number"> 327 </span></a>        <span class="token_comment"># set CONTROL_NEXT_NUMBER_D values to match input list of widgets</span>
<a name="line328"><span class="token_number"> 328 </span></a>        <span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">widgetL</span><span class="token_op">:</span>
<a name="line329"><span class="token_number"> 329 </span></a><span class="text">            </span><span class="keyword">try</span><span class="token_op">:</span>
<a name="line330"><span class="token_number"> 330 </span></a><span class="text">                </span><span class="token_name">num</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">.</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'_'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line331"><span class="token_number"> 331 </span></a>                <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">max</span><span class="token_op">(</span><span class="token_name">num</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">widget_type</span><span class="token_op">])</span>
<a name="line332"><span class="token_number"> 332 </span></a>            <span class="keyword">except</span><span class="token_op">:</span>
<a name="line333"><span class="token_number"> 333 </span></a><span class="text">                </span><span class="keyword">print</span><span class="token_op">(</span><span class="token_string">"ERROR... Widget Number is SURELY Screwed Up."</span><span class="token_op">)</span>
<a name="line334"><span class="token_number"> 334 </span></a>                <span class="keyword">print</span><span class="token_op">(</span> <span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line335"><span class="token_number"> 335 </span></a>                
<a name="line336"><span class="token_number"> 336 </span></a>        <span class="token_comment"># create any widgets and/or tabs</span>
<a name="line337"><span class="token_number"> 337 </span></a>        <span class="token_name">row_col_spanL</span> <span class="token_op">=</span> <span class="token_op">[]</span> <span class="token_comment"># do not place rowspan or columnspan on 1st pass. Save for 2nd pass.</span>
<a name="line338"><span class="token_number"> 338 </span></a>        <span class="keyword">for</span> <span class="token_op">(</span><span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">widgetL</span><span class="token_op">:</span>
<a name="line339"><span class="token_number"> 339 </span></a>            
<a name="line340"><span class="token_number"> 340 </span></a>            <span class="token_comment"># If widget is a ContainerControlsL, then create a tab on Notebook </span>
<a name="line341"><span class="token_number"> 341 </span></a>            <span class="token_comment">#                ['Frame','LabelFrame','Notebook','RadioGroup']</span>
<a name="line342"><span class="token_number"> 342 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">placementWidgetType</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">widget_name</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">):</span>
<a name="line343"><span class="token_number"> 343 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">create_tab</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_name">widget_name</span><span class="token_op">)</span>
<a name="line344"><span class="token_number"> 344 </span></a>            <span class="keyword">elif</span> <span class="token_name">tab_label</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">:</span>
<a name="line345"><span class="token_number"> 345 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">create_tab</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_name">tab_label</span><span class="token_op">)</span>
<a name="line346"><span class="token_number"> 346 </span></a>
<a name="line347"><span class="token_number"> 347 </span></a>            <span class="token_comment"># make sure the grid is big enough</span>
<a name="line348"><span class="token_number"> 348 </span></a>            <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line349"><span class="token_number"> 349 </span></a>            <span class="keyword">if</span> <span class="token_name">col_target</span> <span class="token_op">&gt;=</span> <span class="token_name">num_cols</span><span class="token_op">:</span>
<a name="line350"><span class="token_number"> 350 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line351"><span class="token_number"> 351 </span></a>                <span class="keyword">for</span> <span class="token_name">ic</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span><span class="token_name">num_cols</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">):</span>
<a name="line352"><span class="token_number"> 352 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_column</span><span class="token_op">(</span> <span class="token_name">ic</span> <span class="token_op">)</span>
<a name="line353"><span class="token_number"> 353 </span></a>            <span class="keyword">if</span> <span class="token_name">row_target</span> <span class="token_op">&gt;=</span> <span class="token_name">num_rows</span><span class="token_op">:</span>
<a name="line354"><span class="token_number"> 354 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line355"><span class="token_number"> 355 </span></a>                <span class="keyword">for</span> <span class="token_name">ir</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span><span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">):</span>
<a name="line356"><span class="token_number"> 356 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_row</span><span class="token_op">(</span> <span class="token_name">ir</span> <span class="token_op">)</span>
<a name="line357"><span class="token_number"> 357 </span></a>
<a name="line358"><span class="token_number"> 358 </span></a>
<a name="line359"><span class="token_number"> 359 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line360"><span class="token_number"> 360 </span></a>            <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span>
<a name="line361"><span class="token_number"> 361 </span></a>            
<a name="line362"><span class="token_number"> 362 </span></a>            <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line363"><span class="token_number"> 363 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line364"><span class="token_number"> 364 </span></a>            <span class="token_comment">#    label["text"      ] = "(%d,%d)\n%s\n" % (row_target, col_target, widget_name)</span>
<a name="line365"><span class="token_number"> 365 </span></a>            <span class="token_comment">#    label["background"] = CONTROL_COLOR_D[placementWidgetType]</span>
<a name="line366"><span class="token_number"> 366 </span></a>            
<a name="line367"><span class="token_number"> 367 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">)</span>
<a name="line368"><span class="token_number"> 368 </span></a>                    
<a name="line369"><span class="token_number"> 369 </span></a>
<a name="line370"><span class="token_number"> 370 </span></a>        <span class="token_comment"># repaint the NotebookGridDes Labels</span>
<a name="line371"><span class="token_number"> 371 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line372"><span class="token_number"> 372 </span></a>        
<a name="line373"><span class="token_number"> 373 </span></a>        <span class="token_comment"># refresh the PreviewWin</span>
<a name="line374"><span class="token_number"> 374 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line375"><span class="token_number"> 375 </span></a>            
<a name="line376"><span class="token_number"> 376 </span></a>    
<a name="line377"><span class="token_number"> 377 </span></a>    <span class="keyword">def</span> <span class="token_name">make_complete_list_of_widgets</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line378"><span class="token_number"> 378 </span></a><span class="text">        </span><span class="token_string">"""Return info about all of the placed widgets"""</span>
<a name="line379"><span class="token_number"> 379 </span></a>        <span class="token_name">widgetL</span> <span class="token_op">=</span> <span class="token_op">[]</span>
<a name="line380"><span class="token_number"> 380 </span></a>        
<a name="line381"><span class="token_number"> 381 </span></a>        <span class="keyword">for</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line382"><span class="token_number"> 382 </span></a><span class="text">            </span><span class="token_name">widgetL</span><span class="token_op">.</span><span class="token_name">append</span><span class="token_op">(</span> <span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line383"><span class="token_number"> 383 </span></a>        
<a name="line384"><span class="token_number"> 384 </span></a>        <span class="keyword">return</span> <span class="token_name">widgetL</span>
<a name="line385"><span class="token_number"> 385 </span></a>        
<a name="line386"><span class="token_number"> 386 </span></a>    <span class="keyword">def</span> <span class="token_name">current_tab_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line387"><span class="token_number"> 387 </span></a><span class="text">        </span><span class="token_string">"""return the label of the current tab."""</span>
<a name="line388"><span class="token_number"> 388 </span></a>        <span class="keyword">return</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">tab</span><span class="token_op">(</span>  <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">select</span><span class="token_op">(),</span> <span class="token_string">'text'</span> <span class="token_op">)</span>
<a name="line389"><span class="token_number"> 389 </span></a>    
<a name="line390"><span class="token_number"> 390 </span></a>    <span class="keyword">def</span> <span class="token_name">current_tab_index</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line391"><span class="token_number"> 391 </span></a><span class="text">        </span><span class="token_string">"""return the index of the current tab."""</span>
<a name="line392"><span class="token_number"> 392 </span></a>        <span class="keyword">return</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">index</span><span class="token_op">(</span><span class="token_string">'current'</span><span class="token_op">)</span>
<a name="line393"><span class="token_number"> 393 </span></a>    
<a name="line394"><span class="token_number"> 394 </span></a>    <span class="keyword">def</span> <span class="token_name">set_current_tab_by_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">):</span>
<a name="line395"><span class="token_number"> 395 </span></a><span class="text">        </span><span class="token_string">"""Switch to the tab with label "tab_label"."""</span>
<a name="line396"><span class="token_number"> 396 </span></a>        <span class="keyword">try</span><span class="token_op">:</span>
<a name="line397"><span class="token_number"> 397 </span></a><span class="text">            </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">.</span><span class="token_name">index</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line398"><span class="token_number"> 398 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line399"><span class="token_number"> 399 </span></a><span class="text">            </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line400"><span class="token_number"> 400 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_string">"Error... could not find tab label "</span> <span class="token_op">+</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line401"><span class="token_number"> 401 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">select</span><span class="token_op">(</span><span class="token_name">i</span><span class="token_op">)</span>
<a name="line402"><span class="token_number"> 402 </span></a>    
<a name="line403"><span class="token_number"> 403 </span></a>    <span class="keyword">def</span> <span class="token_name">get_tab_index_by_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">):</span>
<a name="line404"><span class="token_number"> 404 </span></a><span class="text">        </span><span class="token_string">"""return the tab index for label "tab_label"."""</span>
<a name="line405"><span class="token_number"> 405 </span></a>        <span class="keyword">try</span><span class="token_op">:</span>
<a name="line406"><span class="token_number"> 406 </span></a><span class="text">            </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">.</span><span class="token_name">index</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line407"><span class="token_number"> 407 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line408"><span class="token_number"> 408 </span></a><span class="text">            </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_number">0</span>
<a name="line409"><span class="token_number"> 409 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_string">"Error... could not find tab label "</span> <span class="token_op">+</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line410"><span class="token_number"> 410 </span></a>        <span class="keyword">return</span> <span class="token_name">i</span>
<a name="line411"><span class="token_number"> 411 </span></a>
<a name="line412"><span class="token_number"> 412 </span></a>    
<a name="line413"><span class="token_number"> 413 </span></a>    <span class="keyword">def</span> <span class="token_name">find_empty_space_on_tab</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">):</span>
<a name="line414"><span class="token_number"> 414 </span></a><span class="text">        </span><span class="token_string">"""return a (row_target, col_target) on "tab_label" notebook page."""</span>
<a name="line415"><span class="token_number"> 415 </span></a>        <span class="keyword">try</span><span class="token_op">:</span>
<a name="line416"><span class="token_number"> 416 </span></a><span class="text">            </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">.</span><span class="token_name">index</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line417"><span class="token_number"> 417 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line418"><span class="token_number"> 418 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_string">"Error... could not find tab label OR empty space "</span> <span class="token_op">+</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line419"><span class="token_number"> 419 </span></a>            <span class="keyword">return</span> <span class="token_op">(</span><span class="token_name">None</span><span class="token_op">,</span> <span class="token_name">None</span><span class="token_op">)</span>
<a name="line420"><span class="token_number"> 420 </span></a>        
<a name="line421"><span class="token_number"> 421 </span></a>        <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line422"><span class="token_number"> 422 </span></a>        
<a name="line423"><span class="token_number"> 423 </span></a>        <span class="token_comment"># search all locations for an empty spot</span>
<a name="line424"><span class="token_number"> 424 </span></a>        <span class="keyword">for</span> <span class="token_name">col_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_cols</span> <span class="token_op">):</span>
<a name="line425"><span class="token_number"> 425 </span></a><span class="text">            </span><span class="keyword">for</span> <span class="token_name">row_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_rows</span> <span class="token_op">):</span>
<a name="line426"><span class="token_number"> 426 </span></a>                <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType</span>
<a name="line427"><span class="token_number"> 427 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span> <span class="token_op">==</span> <span class="token_string">''</span><span class="token_op">:</span>
<a name="line428"><span class="token_number"> 428 </span></a><span class="text">                    </span><span class="keyword">return</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line429"><span class="token_number"> 429 </span></a>
<a name="line430"><span class="token_number"> 430 </span></a>        <span class="token_comment"># if nothing found, then issue a warning and return (None, None)</span>
<a name="line431"><span class="token_number"> 431 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_string">"Error... could not empty space on: "</span> <span class="token_op">+</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line432"><span class="token_number"> 432 </span></a>        <span class="keyword">return</span> <span class="token_op">(</span><span class="token_name">None</span><span class="token_op">,</span> <span class="token_name">None</span><span class="token_op">)</span>
<a name="line433"><span class="token_number"> 433 </span></a>        
<a name="line434"><span class="token_number"> 434 </span></a>        
<a name="line435"><span class="token_number"> 435 </span></a>
<a name="line436"><span class="token_number"> 436 </span></a>    <span class="keyword">def</span> <span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">msg</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">False</span><span class="token_op">):</span>
<a name="line437"><span class="token_number"> 437 </span></a><span class="text">        </span><span class="token_string">"""Set the status message in the  main window"""</span>
<a name="line438"><span class="token_number"> 438 </span></a>        <span class="keyword">if</span> <span class="token_name">also_print</span><span class="token_op">:</span>
<a name="line439"><span class="token_number"> 439 </span></a><span class="text">            </span><span class="keyword">print</span><span class="token_op">(</span> <span class="token_name">msg</span> <span class="token_op">)</span>
<a name="line440"><span class="token_number"> 440 </span></a>        
<a name="line441"><span class="token_number"> 441 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">msg</span> <span class="token_op">)</span>
<a name="line442"><span class="token_number"> 442 </span></a>    
<a name="line443"><span class="token_number"> 443 </span></a>    <span class="keyword">def</span> <span class="token_name">make_col_control</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">):</span>
<a name="line444"><span class="token_number"> 444 </span></a><span class="text">        </span><span class="token_string">"""Make a control Label on "tab_label" for column."""</span>
<a name="line445"><span class="token_number"> 445 </span></a>        
<a name="line446"><span class="token_number"> 446 </span></a>        <span class="token_name">i_tab</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_tab_index_by_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line447"><span class="token_number"> 447 </span></a>        <span class="token_name">nbFrame</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">nbFrameL</span><span class="token_op">[</span> <span class="token_name">i_tab</span> <span class="token_op">]</span>
<a name="line448"><span class="token_number"> 448 </span></a>        
<a name="line449"><span class="token_number"> 449 </span></a>        <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">col_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line450"><span class="token_number"> 450 </span></a>        
<a name="line451"><span class="token_number"> 451 </span></a>        <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">16</span><span class="token_op">)</span>
<a name="line452"><span class="token_number"> 452 </span></a>        <span class="token_name">s</span> <span class="token_op">=</span> <span class="token_string">"col:%i"</span><span class="token_op">%</span><span class="token_name">col_target</span>
<a name="line453"><span class="token_number"> 453 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"+"</span> <span class="token_op">+</span> <span class="token_name">s</span><span class="token_op">.</span><span class="token_name">center</span><span class="token_op">(</span><span class="token_number">14</span><span class="token_op">,</span><span class="token_string">" "</span><span class="token_op">)</span> <span class="token_op">+</span> <span class="token_string">"+"</span>
<a name="line454"><span class="token_number"> 454 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line455"><span class="token_number"> 455 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#87CEFA"</span> <span class="token_comment"># lightskyblue</span>
<a name="line456"><span class="token_number"> 456 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"raised"</span>
<a name="line457"><span class="token_number"> 457 </span></a>        
<a name="line458"><span class="token_number"> 458 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">colInsertWidgetD</span><span class="token_op">[</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label</span>
<a name="line459"><span class="token_number"> 459 </span></a>        
<a name="line460"><span class="token_number"> 460 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">grid</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span> <span class="token_name">column</span><span class="token_op">=</span><span class="token_name">col_interface</span><span class="token_op">)</span>
<a name="line461"><span class="token_number"> 461 </span></a>
<a name="line462"><span class="token_number"> 462 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onColInsertClicked</span><span class="token_op">)</span>
<a name="line463"><span class="token_number"> 463 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Enter&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onColControlEnter</span><span class="token_op">)</span>
<a name="line464"><span class="token_number"> 464 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Leave&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onControlLeave</span><span class="token_op">)</span>
<a name="line465"><span class="token_number"> 465 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Motion&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onColControlMove</span><span class="token_op">)</span>
<a name="line466"><span class="token_number"> 466 </span></a>        
<a name="line467"><span class="token_number"> 467 </span></a>        <span class="token_comment"># Put column weight controls below widget labels</span>
<a name="line468"><span class="token_number"> 468 </span></a>        <span class="token_name">row_weight_controls</span> <span class="token_op">=</span> <span class="token_number">99</span>
<a name="line469"><span class="token_number"> 469 </span></a>        
<a name="line470"><span class="token_number"> 470 </span></a>        <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line471"><span class="token_number"> 471 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"col:%i\nwt:0"</span><span class="token_op">%</span><span class="token_name">col_target</span>
<a name="line472"><span class="token_number"> 472 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_string">"Courier"</span><span class="token_op">,</span> <span class="token_number">10</span><span class="token_op">,</span> <span class="token_string">"normal"</span><span class="token_op">)</span>
<a name="line473"><span class="token_number"> 473 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line474"><span class="token_number"> 474 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"raised"</span>
<a name="line475"><span class="token_number"> 475 </span></a>        
<a name="line476"><span class="token_number"> 476 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">colWeightsWidgetD</span><span class="token_op">[</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label</span>
<a name="line477"><span class="token_number"> 477 </span></a>        
<a name="line478"><span class="token_number"> 478 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">grid</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_weight_controls</span><span class="token_op">,</span> <span class="token_name">column</span><span class="token_op">=</span><span class="token_name">col_interface</span><span class="token_op">)</span>
<a name="line479"><span class="token_number"> 479 </span></a>        
<a name="line480"><span class="token_number"> 480 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onSetColumnWeightClicked</span><span class="token_op">)</span>
<a name="line481"><span class="token_number"> 481 </span></a>        
<a name="line482"><span class="token_number"> 482 </span></a>        
<a name="line483"><span class="token_number"> 483 </span></a>    
<a name="line484"><span class="token_number"> 484 </span></a>    <span class="keyword">def</span> <span class="token_name">make_row_control</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">):</span>
<a name="line485"><span class="token_number"> 485 </span></a><span class="text">        </span><span class="token_string">"""Make a control Label on "tab_label" for row."""</span>
<a name="line486"><span class="token_number"> 486 </span></a>        
<a name="line487"><span class="token_number"> 487 </span></a>        <span class="token_name">i_tab</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_tab_index_by_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line488"><span class="token_number"> 488 </span></a>        <span class="token_name">nbFrame</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">nbFrameL</span><span class="token_op">[</span> <span class="token_name">i_tab</span> <span class="token_op">]</span>
<a name="line489"><span class="token_number"> 489 </span></a>        
<a name="line490"><span class="token_number"> 490 </span></a>        <span class="token_name">row_target</span> <span class="token_op">=</span> <span class="token_name">row_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line491"><span class="token_number"> 491 </span></a>        
<a name="line492"><span class="token_number"> 492 </span></a>        <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line493"><span class="token_number"> 493 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span>  <span class="token_string">"+\nrow:%i\n+"</span><span class="token_op">%</span><span class="token_name">row_target</span>
<a name="line494"><span class="token_number"> 494 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line495"><span class="token_number"> 495 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#87CEFA"</span> <span class="token_comment"># lightskyblue</span>
<a name="line496"><span class="token_number"> 496 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"raised"</span>
<a name="line497"><span class="token_number"> 497 </span></a>        
<a name="line498"><span class="token_number"> 498 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">rowInsertWidgetD</span><span class="token_op">[</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label</span>
<a name="line499"><span class="token_number"> 499 </span></a>        
<a name="line500"><span class="token_number"> 500 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">grid</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">column</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">)</span>
<a name="line501"><span class="token_number"> 501 </span></a>
<a name="line502"><span class="token_number"> 502 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onRowInsertClicked</span><span class="token_op">)</span>   
<a name="line503"><span class="token_number"> 503 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Enter&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onRowControlEnter</span><span class="token_op">)</span>
<a name="line504"><span class="token_number"> 504 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Leave&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onControlLeave</span><span class="token_op">)</span>
<a name="line505"><span class="token_number"> 505 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Motion&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onRowControlMove</span><span class="token_op">)</span>
<a name="line506"><span class="token_number"> 506 </span></a>        
<a name="line507"><span class="token_number"> 507 </span></a>        <span class="token_comment"># Put row weight controls below widget labels</span>
<a name="line508"><span class="token_number"> 508 </span></a>        <span class="token_name">col_weight_controls</span> <span class="token_op">=</span> <span class="token_number">99</span>
<a name="line509"><span class="token_number"> 509 </span></a>        
<a name="line510"><span class="token_number"> 510 </span></a>        <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">8</span><span class="token_op">)</span>
<a name="line511"><span class="token_number"> 511 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span>  <span class="token_string">"row:%i\nwt:0"</span><span class="token_op">%</span><span class="token_name">row_target</span>
<a name="line512"><span class="token_number"> 512 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_string">"Courier"</span><span class="token_op">,</span> <span class="token_number">10</span><span class="token_op">,</span> <span class="token_string">"normal"</span><span class="token_op">)</span>
<a name="line513"><span class="token_number"> 513 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line514"><span class="token_number"> 514 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"raised"</span>
<a name="line515"><span class="token_number"> 515 </span></a>        
<a name="line516"><span class="token_number"> 516 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">rowWeightsWidgetD</span><span class="token_op">[</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">label</span>
<a name="line517"><span class="token_number"> 517 </span></a>        
<a name="line518"><span class="token_number"> 518 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">grid</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">column</span><span class="token_op">=</span><span class="token_name">col_weight_controls</span><span class="token_op">)</span>
<a name="line519"><span class="token_number"> 519 </span></a>        
<a name="line520"><span class="token_number"> 520 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onSetRowWeightClicked</span><span class="token_op">)</span>
<a name="line521"><span class="token_number"> 521 </span></a>
<a name="line522"><span class="token_number"> 522 </span></a>
<a name="line523"><span class="token_number"> 523 </span></a>    <span class="keyword">def</span> <span class="token_name">target_grid_is_empty</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line524"><span class="token_number"> 524 </span></a><span class="text">        </span><span class="token_string">"""See if position on notebook tab_label is empty"""</span>
<a name="line525"><span class="token_number"> 525 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]:</span>
<a name="line526"><span class="token_number"> 526 </span></a><span class="text">            </span><span class="keyword">return</span> <span class="token_name">False</span>
<a name="line527"><span class="token_number"> 527 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line528"><span class="token_number"> 528 </span></a><span class="text">            </span><span class="keyword">return</span> <span class="token_name">True</span>
<a name="line529"><span class="token_number"> 529 </span></a>            
<a name="line530"><span class="token_number"> 530 </span></a>    <span class="keyword">def</span> <span class="token_name">current_grid_is_empty</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line531"><span class="token_number"> 531 </span></a><span class="text">        </span><span class="token_string">"""See if position on CURRENT notebook tab_label is empty"""</span>
<a name="line532"><span class="token_number"> 532 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line533"><span class="token_number"> 533 </span></a>        <span class="keyword">return</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_grid_is_empty</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line534"><span class="token_number"> 534 </span></a>    
<a name="line535"><span class="token_number"> 535 </span></a>    <span class="keyword">def</span> <span class="token_name">widget_is_empty</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget</span><span class="token_op">):</span>
<a name="line536"><span class="token_number"> 536 </span></a><span class="text">        </span><span class="token_string">"""Given a Label widget, see if it is available for widget placement"""</span>
<a name="line537"><span class="token_number"> 537 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span>
<a name="line538"><span class="token_number"> 538 </span></a>        <span class="keyword">if</span> <span class="token_name">len</span><span class="token_op">(</span><span class="token_name">sL</span><span class="token_op">)==</span><span class="token_number">3</span><span class="token_op">:</span>
<a name="line539"><span class="token_number"> 539 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">].</span><span class="token_name">strip</span><span class="token_op">()</span> <span class="token_op">==</span> <span class="token_string">''</span><span class="token_op">:</span>
<a name="line540"><span class="token_number"> 540 </span></a><span class="text">                </span><span class="keyword">return</span> <span class="token_name">True</span>
<a name="line541"><span class="token_number"> 541 </span></a>        <span class="keyword">return</span> <span class="token_name">False</span>
<a name="line542"><span class="token_number"> 542 </span></a>    
<a name="line543"><span class="token_number"> 543 </span></a>    <span class="keyword">def</span> <span class="token_name">widget_is_container</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">label_widget</span><span class="token_op">):</span>
<a name="line544"><span class="token_number"> 544 </span></a><span class="text">        </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">label_widget</span> <span class="token_op">)</span>
<a name="line545"><span class="token_number"> 545 </span></a>        <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">''</span> <span class="token_op">)</span>
<a name="line546"><span class="token_number"> 546 </span></a>        
<a name="line547"><span class="token_number"> 547 </span></a>        <span class="keyword">if</span> <span class="token_name">widget_type</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">:</span>
<a name="line548"><span class="token_number"> 548 </span></a><span class="text">            </span><span class="keyword">return</span> <span class="token_name">True</span>
<a name="line549"><span class="token_number"> 549 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line550"><span class="token_number"> 550 </span></a><span class="text">            </span><span class="keyword">return</span> <span class="token_name">False</span>
<a name="line551"><span class="token_number"> 551 </span></a>    
<a name="line552"><span class="token_number"> 552 </span></a>    <span class="keyword">def</span> <span class="token_name">get_widget_type</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">label_widget</span><span class="token_op">):</span>
<a name="line553"><span class="token_number"> 553 </span></a><span class="text">        </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">label_widget</span> <span class="token_op">)</span>
<a name="line554"><span class="token_number"> 554 </span></a>        <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">''</span> <span class="token_op">)</span>
<a name="line555"><span class="token_number"> 555 </span></a>        <span class="keyword">return</span> <span class="token_name">widget_type</span>
<a name="line556"><span class="token_number"> 556 </span></a>    
<a name="line557"><span class="token_number"> 557 </span></a>    <span class="keyword">def</span> <span class="token_name">get_widget_rc_target</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget</span><span class="token_op">):</span>
<a name="line558"><span class="token_number"> 558 </span></a><span class="text">        </span><span class="token_string">"""Given a Label widget, get the row_target, col_target from the "text" string."""</span>
<a name="line559"><span class="token_number"> 559 </span></a>        
<a name="line560"><span class="token_number"> 560 </span></a>        <span class="token_comment"># assume that the Label is in the field of target widgets</span>
<a name="line561"><span class="token_number"> 561 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span>
<a name="line562"><span class="token_number"> 562 </span></a>        <span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">col</span> <span class="token_op">=</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">0</span><span class="token_op">][</span><span class="token_number">1</span><span class="token_op">:-</span><span class="token_number">1</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">','</span><span class="token_op">)</span>  <span class="token_comment"># get row col from string like "(7,8)"</span>
<a name="line563"><span class="token_number"> 563 </span></a>        <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">),</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">col</span><span class="token_op">)</span>
<a name="line564"><span class="token_number"> 564 </span></a>        <span class="keyword">return</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span>
<a name="line565"><span class="token_number"> 565 </span></a>
<a name="line566"><span class="token_number"> 566 </span></a>    <span class="token_comment">#def get_widget_rc_target_from_name(self, name): # name is like Button_3</span>
<a name="line567"><span class="token_number"> 567 </span></a>    <span class="token_comment">#    """Given a Label widget, get the row_target, col_target from the "text" string."""</span>
<a name="line568"><span class="token_number"> 568 </span></a>    <span class="token_comment">#    (tab_label, rtarg, col_target, placementWidgetType, label) = self.label_obj_from_nameD[name]</span>
<a name="line569"><span class="token_number"> 569 </span></a>    <span class="token_comment">#    return self.get_widget_rc_target( label )</span>
<a name="line570"><span class="token_number"> 570 </span></a>
<a name="line571"><span class="token_number"> 571 </span></a>    
<a name="line572"><span class="token_number"> 572 </span></a>    <span class="keyword">def</span> <span class="token_name">get_all_widget_info</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">label_widget</span><span class="token_op">):</span>
<a name="line573"><span class="token_number"> 573 </span></a><span class="text">        </span><span class="token_string">"""Given a Label widget, get the row_target, col_target, name and line3 from the "text" string."""</span>
<a name="line574"><span class="token_number"> 574 </span></a>        
<a name="line575"><span class="token_number"> 575 </span></a>        <span class="token_comment"># assume that the Label is in the field of target widgets</span>
<a name="line576"><span class="token_number"> 576 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">label_widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span>
<a name="line577"><span class="token_number"> 577 </span></a>        <span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">col</span> <span class="token_op">=</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">0</span><span class="token_op">][</span><span class="token_number">1</span><span class="token_op">:-</span><span class="token_number">1</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">','</span><span class="token_op">)</span>  <span class="token_comment"># get row col from string like "(7,8)"</span>
<a name="line578"><span class="token_number"> 578 </span></a>        <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">),</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">col</span><span class="token_op">)</span>
<a name="line579"><span class="token_number"> 579 </span></a>        
<a name="line580"><span class="token_number"> 580 </span></a>        <span class="token_name">widget_name</span> <span class="token_op">=</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">]</span>
<a name="line581"><span class="token_number"> 581 </span></a>        <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">2</span><span class="token_op">]</span>
<a name="line582"><span class="token_number"> 582 </span></a>        
<a name="line583"><span class="token_number"> 583 </span></a>        <span class="keyword">return</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span>
<a name="line584"><span class="token_number"> 584 </span></a>        
<a name="line585"><span class="token_number"> 585 </span></a>    <span class="token_comment">#def get_all_widget_info_from_name(self, name): # name is like Button_3</span>
<a name="line586"><span class="token_number"> 586 </span></a>    <span class="token_comment">#    """Given a widget name, get the row_target, col_target, name and line3 from the "text" string."""</span>
<a name="line587"><span class="token_number"> 587 </span></a>    <span class="token_comment">#    (tab_label, rtarg, col_target, placementWidgetType, label) = self.label_obj_from_nameD[name]</span>
<a name="line588"><span class="token_number"> 588 </span></a>    <span class="token_comment">#    return self.get_all_widget_info( label )</span>
<a name="line589"><span class="token_number"> 589 </span></a>
<a name="line590"><span class="token_number"> 590 </span></a>    <span class="keyword">def</span> <span class="token_name">make_target_grid_label</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line591"><span class="token_number"> 591 </span></a><span class="text">        </span><span class="token_string">"""</span>
<a name="line592"><span class="token_number"> 592 </span></a><span class="token_string">        Add a Label object to represent target GUI grid location.</span>
<a name="line593"><span class="token_number"> 593 </span></a><span class="token_string">        These positions are all empty right now.</span>
<a name="line594"><span class="token_number"> 594 </span></a><span class="token_string">        """</span>
<a name="line595"><span class="token_number"> 595 </span></a>        
<a name="line596"><span class="token_number"> 596 </span></a>        <span class="token_name">i_tab</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_tab_index_by_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line597"><span class="token_number"> 597 </span></a>        <span class="token_name">nbFrame</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">nbFrameL</span><span class="token_op">[</span> <span class="token_name">i_tab</span> <span class="token_op">]</span>
<a name="line598"><span class="token_number"> 598 </span></a>        
<a name="line599"><span class="token_number"> 599 </span></a>        <span class="token_name">row_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line600"><span class="token_number"> 600 </span></a>        <span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">col_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line601"><span class="token_number"> 601 </span></a>
<a name="line602"><span class="token_number"> 602 </span></a>        <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_number">16</span><span class="token_op">)</span>
<a name="line603"><span class="token_number"> 603 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line604"><span class="token_number"> 604 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line605"><span class="token_number"> 605 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line606"><span class="token_number"> 606 </span></a>        <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"groove"</span>
<a name="line607"><span class="token_number"> 607 </span></a>        
<a name="line608"><span class="token_number"> 608 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span><span class="token_name">col_interface</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_name">label</span>
<a name="line609"><span class="token_number"> 609 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line610"><span class="token_number"> 610 </span></a>        
<a name="line611"><span class="token_number"> 611 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">grid</span><span class="token_op">(</span><span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">column</span><span class="token_op">=</span><span class="token_name">col_interface</span><span class="token_op">)</span>
<a name="line612"><span class="token_number"> 612 </span></a>
<a name="line613"><span class="token_number"> 613 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Enter&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onGridBoxEnter</span><span class="token_op">)</span>
<a name="line614"><span class="token_number"> 614 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Leave&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onGridBoxLeave</span><span class="token_op">)</span>
<a name="line615"><span class="token_number"> 615 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onGridBoxClicked</span><span class="token_op">)</span>   
<a name="line616"><span class="token_number"> 616 </span></a>
<a name="line617"><span class="token_number"> 617 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Button-3&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onGridBoxRightClicked</span><span class="token_op">)</span>   
<a name="line618"><span class="token_number"> 618 </span></a>
<a name="line619"><span class="token_number"> 619 </span></a>
<a name="line620"><span class="token_number"> 620 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">'&lt;B1-Motion&gt;'</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onLeftDrag</span><span class="token_op">)</span>
<a name="line621"><span class="token_number"> 621 </span></a>        <span class="token_name">label</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;ButtonRelease-1&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">onLeftDrop</span><span class="token_op">)</span>
<a name="line622"><span class="token_number"> 622 </span></a>
<a name="line623"><span class="token_number"> 623 </span></a>  
<a name="line624"><span class="token_number"> 624 </span></a>    <span class="keyword">def</span> <span class="token_name">onLeftDrag</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line625"><span class="token_number"> 625 </span></a>        <span class="token_comment">#print( 'Got left mouse button drag:',)</span>
<a name="line626"><span class="token_number"> 626 </span></a>        <span class="token_comment">#print( 'Widget=%s X=%s Y=%s' % (event.widget["text"].replace('\n',' '), event.x, event.y))</span>
<a name="line627"><span class="token_number"> 627 </span></a>        
<a name="line628"><span class="token_number"> 628 </span></a><span class="text">        </span><span class="token_name">xroot</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_rootx</span><span class="token_op">()</span>
<a name="line629"><span class="token_number"> 629 </span></a>        <span class="token_name">yroot</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_rooty</span><span class="token_op">()</span>
<a name="line630"><span class="token_number"> 630 </span></a>        
<a name="line631"><span class="token_number"> 631 </span></a>        <span class="keyword">try</span><span class="token_op">:</span>
<a name="line632"><span class="token_number"> 632 </span></a><span class="text">            </span><span class="token_name">w2</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">winfo_containing</span><span class="token_op">(</span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">x</span><span class="token_op">+</span><span class="token_name">xroot</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">y</span><span class="token_op">+</span><span class="token_name">yroot</span><span class="token_op">)</span>
<a name="line633"><span class="token_number"> 633 </span></a>            <span class="token_comment">#print( '... Widget#2=%s' % (w2["text"].replace('\n',' '),))</span>
<a name="line634"><span class="token_number"> 634 </span></a>        <span class="keyword">except</span><span class="token_op">:</span>
<a name="line635"><span class="token_number"> 635 </span></a><span class="text">            </span><span class="token_name">w2</span> <span class="token_op">=</span> <span class="token_name">None</span>
<a name="line636"><span class="token_number"> 636 </span></a>        
<a name="line637"><span class="token_number"> 637 </span></a>        <span class="token_comment"># restore any Labels that were dragged over</span>
<a name="line638"><span class="token_number"> 638 </span></a>        <span class="keyword">for</span> <span class="token_name">w</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">drag_set</span><span class="token_op">:</span>
<a name="line639"><span class="token_number"> 639 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">w</span> <span class="token_op">!=</span> <span class="token_name">w2</span><span class="token_op">:</span>
<a name="line640"><span class="token_number"> 640 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_empty</span><span class="token_op">(</span> <span class="token_name">w</span> <span class="token_op">):</span>
<a name="line641"><span class="token_number"> 641 </span></a><span class="text">                    </span><span class="token_name">w</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line642"><span class="token_number"> 642 </span></a>                    <span class="token_comment">#print('Restore Empty',w["text"].replace('\n',' '))</span>
<a name="line643"><span class="token_number"> 643 </span></a>                <span class="keyword">else</span><span class="token_op">:</span>
<a name="line644"><span class="token_number"> 644 </span></a><span class="text">                    </span><span class="token_name">widget_type</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_type</span><span class="token_op">(</span><span class="token_name">w</span><span class="token_op">)</span>
<a name="line645"><span class="token_number"> 645 </span></a>                    <span class="token_name">w</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span> <span class="token_name">widget_type</span> <span class="token_op">]</span>
<a name="line646"><span class="token_number"> 646 </span></a>                    <span class="token_comment">#print('Restore Widget',w["text"].replace('\n',' '))</span>
<a name="line647"><span class="token_number"> 647 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">drag_set</span><span class="token_op">.</span><span class="token_name">clear</span><span class="token_op">()</span>
<a name="line648"><span class="token_number"> 648 </span></a>        
<a name="line649"><span class="token_number"> 649 </span></a>        <span class="token_comment"># set background of potential drop target Label</span>
<a name="line650"><span class="token_number"> 650 </span></a>        <span class="keyword">if</span> <span class="token_name">w2</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">w2</span> <span class="token_op">!=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">):</span>
<a name="line651"><span class="token_number"> 651 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">drag_set</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span>
<a name="line652"><span class="token_number"> 652 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_empty</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span> <span class="keyword">or</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_container</span><span class="token_op">(</span><span class="token_name">w2</span><span class="token_op">):</span>
<a name="line653"><span class="token_number"> 653 </span></a><span class="text">                </span><span class="token_name">w2</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span>  <span class="token_string">"#FF00FF"</span>  <span class="token_comment"># magenta</span>
<a name="line654"><span class="token_number"> 654 </span></a>         
<a name="line655"><span class="token_number"> 655 </span></a>    <span class="keyword">def</span> <span class="token_name">onLeftDrop</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line656"><span class="token_number"> 656 </span></a>        
<a name="line657"><span class="token_number"> 657 </span></a><span class="text">        </span><span class="token_name">xroot</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_rootx</span><span class="token_op">()</span>
<a name="line658"><span class="token_number"> 658 </span></a>        <span class="token_name">yroot</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_rooty</span><span class="token_op">()</span>
<a name="line659"><span class="token_number"> 659 </span></a>        
<a name="line660"><span class="token_number"> 660 </span></a>        <span class="token_comment"># w2 is Label object that event.widget is dropped upon</span>
<a name="line661"><span class="token_number"> 661 </span></a>        <span class="token_name">w2</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">winfo_containing</span><span class="token_op">(</span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">x</span><span class="token_op">+</span><span class="token_name">xroot</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">y</span><span class="token_op">+</span><span class="token_name">yroot</span><span class="token_op">)</span>
<a name="line662"><span class="token_number"> 662 </span></a>        <span class="token_comment">#print('xxxDropped Widget=%s on %s'% (event.widget["text"].replace('\n',' '), w2["text"].replace('\n',' ')))</span>
<a name="line663"><span class="token_number"> 663 </span></a>        
<a name="line664"><span class="token_number"> 664 </span></a>        <span class="token_comment"># Might be here from simple Click. Check for any drag_set members before using Drop Logic.</span>
<a name="line665"><span class="token_number"> 665 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">drag_set</span><span class="token_op">:</span>
<a name="line666"><span class="token_number"> 666 </span></a>            
<a name="line667"><span class="token_number"> 667 </span></a><span class="text">            </span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line668"><span class="token_number"> 668 </span></a>            <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_rc_target</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span>
<a name="line669"><span class="token_number"> 669 </span></a>            
<a name="line670"><span class="token_number"> 670 </span></a>            <span class="token_comment"># only try to move if there is an actual movement</span>
<a name="line671"><span class="token_number"> 671 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">old_row_target</span> <span class="token_op">!=</span> <span class="token_name">new_row_target</span><span class="token_op">)</span> <span class="keyword">or</span> <span class="token_op">(</span> <span class="token_name">old_col_target</span> <span class="token_op">!=</span> <span class="token_name">new_col_target</span><span class="token_op">):</span>
<a name="line672"><span class="token_number"> 672 </span></a>                
<a name="line673"><span class="token_number"> 673 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_name">widget_name</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Tab_'</span><span class="token_op">):</span>
<a name="line674"><span class="token_number"> 674 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">arrange_notebook_tabs</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">)</span>
<a name="line675"><span class="token_number"> 675 </span></a>                
<a name="line676"><span class="token_number"> 676 </span></a>                <span class="token_name">s</span> <span class="token_op">=</span> <span class="token_string">'Dropped Widget=%s on %s'</span><span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">replace</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">,</span><span class="token_string">' '</span><span class="token_op">),</span> <span class="token_name">w2</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">replace</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">,</span><span class="token_string">' '</span><span class="token_op">))</span>
<a name="line677"><span class="token_number"> 677 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_name">s</span><span class="token_op">)</span>
<a name="line678"><span class="token_number"> 678 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">move_widget_on_current_tab</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">,</span> <span class="token_name">w2</span><span class="token_op">)</span>
<a name="line679"><span class="token_number"> 679 </span></a>                
<a name="line680"><span class="token_number"> 680 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line681"><span class="token_number"> 681 </span></a>        
<a name="line682"><span class="token_number"> 682 </span></a>    <span class="keyword">def</span> <span class="token_name">move_widget_on_current_tab</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">,</span> <span class="token_name">w2</span><span class="token_op">):</span>
<a name="line683"><span class="token_number"> 683 </span></a><span class="text">        </span><span class="token_string">"""Move widget from current location to new location. (might move to another tab)"""</span>
<a name="line684"><span class="token_number"> 684 </span></a>        
<a name="line685"><span class="token_number"> 685 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line686"><span class="token_number"> 686 </span></a>
<a name="line687"><span class="token_number"> 687 </span></a>        <span class="token_comment"># w2 is Label object that widget is dropped upon</span>
<a name="line688"><span class="token_number"> 688 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_grid_is_empty</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">):</span>
<a name="line689"><span class="token_number"> 689 </span></a><span class="text">            </span><span class="token_name">w2_type</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line690"><span class="token_number"> 690 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line691"><span class="token_number"> 691 </span></a><span class="text">            </span><span class="token_name">w2_row_target</span><span class="token_op">,</span> <span class="token_name">w2_col_target</span><span class="token_op">,</span> <span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">w2_line3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span>
<a name="line692"><span class="token_number"> 692 </span></a>            <span class="token_name">w2_type</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">w2_row_target</span><span class="token_op">,</span> <span class="token_name">w2_col_target</span><span class="token_op">)]</span>
<a name="line693"><span class="token_number"> 693 </span></a>        
<a name="line694"><span class="token_number"> 694 </span></a>        
<a name="line695"><span class="token_number"> 695 </span></a>        <span class="token_comment"># can only move to target location if it is empty.</span>
<a name="line696"><span class="token_number"> 696 </span></a>        <span class="keyword">if</span> <span class="token_name">w2_type</span> <span class="token_op">==</span> <span class="token_string">''</span><span class="token_op">:</span>
<a name="line697"><span class="token_number"> 697 </span></a>        
<a name="line698"><span class="token_number"> 698 </span></a><span class="text">            </span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line699"><span class="token_number"> 699 </span></a>            <span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)]</span>
<a name="line700"><span class="token_number"> 700 </span></a>            
<a name="line701"><span class="token_number"> 701 </span></a>            <span class="token_comment"># clear the old location</span>
<a name="line702"><span class="token_number"> 702 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line703"><span class="token_number"> 703 </span></a>            <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)</span>
<a name="line704"><span class="token_number"> 704 </span></a>            <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line705"><span class="token_number"> 705 </span></a>            <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line706"><span class="token_number"> 706 </span></a>            
<a name="line707"><span class="token_number"> 707 </span></a>            <span class="token_comment"># set up the new location</span>
<a name="line708"><span class="token_number"> 708 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line709"><span class="token_number"> 709 </span></a>            <span class="token_name">new_row_interface</span><span class="token_op">,</span> <span class="token_name">new_col_interface</span> <span class="token_op">=</span> <span class="token_name">new_row_target</span> <span class="token_op">+</span> <span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line710"><span class="token_number"> 710 </span></a>            
<a name="line711"><span class="token_number"> 711 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">widget</span><span class="token_op">)</span>
<a name="line712"><span class="token_number"> 712 </span></a>            
<a name="line713"><span class="token_number"> 713 </span></a>            <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">new_row_interface</span><span class="token_op">,</span> <span class="token_name">new_col_interface</span><span class="token_op">)]</span>
<a name="line714"><span class="token_number"> 714 </span></a>            
<a name="line715"><span class="token_number"> 715 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">)</span>
<a name="line716"><span class="token_number"> 716 </span></a>            <span class="token_comment">#    label["text"      ] = "(%d,%d)\n%s\n" % (row_target, col_target, widget_name)</span>
<a name="line717"><span class="token_number"> 717 </span></a>            <span class="token_comment">#    label["background"] = CONTROL_COLOR_D[placementWidgetType]</span>
<a name="line718"><span class="token_number"> 718 </span></a>        
<a name="line719"><span class="token_number"> 719 </span></a>            <span class="token_name">s</span> <span class="token_op">=</span> <span class="token_string">"Moved widget "</span><span class="token_op">+</span><span class="token_name">widget_name</span><span class="token_op">+</span><span class="token_string">" at (%s,%i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)</span> <span class="token_op">+</span>\
<a name="line720"><span class="token_number"> 720 </span></a>                <span class="token_string">" to (%s,%i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">)</span>
<a name="line721"><span class="token_number"> 721 </span></a>            <span class="token_comment">#print(s)</span>
<a name="line722"><span class="token_number"> 722 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_name">s</span><span class="token_op">)</span>
<a name="line723"><span class="token_number"> 723 </span></a>            
<a name="line724"><span class="token_number"> 724 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line725"><span class="token_number"> 725 </span></a>        
<a name="line726"><span class="token_number"> 726 </span></a>        <span class="keyword">elif</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_container</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">w2</span> <span class="token_op">!=</span> <span class="token_name">widget</span><span class="token_op">)</span> <span class="token_op">:</span> <span class="token_comment"># move to container's tab</span>
<a name="line727"><span class="token_number"> 727 </span></a>            
<a name="line728"><span class="token_number"> 728 </span></a><span class="text">            </span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line729"><span class="token_number"> 729 </span></a>            
<a name="line730"><span class="token_number"> 730 </span></a>            <span class="token_name">w2_type</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_type</span><span class="token_op">(</span> <span class="token_name">w2</span> <span class="token_op">)</span>
<a name="line731"><span class="token_number"> 731 </span></a>            <span class="token_name">w2</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span> <span class="token_name">w2_type</span> <span class="token_op">]</span>
<a name="line732"><span class="token_number"> 732 </span></a>            
<a name="line733"><span class="token_number"> 733 </span></a>            <span class="token_comment"># if current position on current tab is open on new tab, put it there</span>
<a name="line734"><span class="token_number"> 734 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_grid_is_empty</span><span class="token_op">(</span> <span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">):</span>
<a name="line735"><span class="token_number"> 735 </span></a><span class="text">                </span><span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">=</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span>
<a name="line736"><span class="token_number"> 736 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line737"><span class="token_number"> 737 </span></a><span class="text">                </span><span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">find_empty_space_on_tab</span><span class="token_op">(</span> <span class="token_name">w2_name</span> <span class="token_op">)</span>
<a name="line738"><span class="token_number"> 738 </span></a>            
<a name="line739"><span class="token_number"> 739 </span></a>            <span class="keyword">if</span> <span class="token_name">new_row_target</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span> <span class="token_comment"># i.e. if a place was found on the other tab.</span>
<a name="line740"><span class="token_number"> 740 </span></a>                
<a name="line741"><span class="token_number"> 741 </span></a><span class="text">                </span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">line3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line742"><span class="token_number"> 742 </span></a>                <span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)]</span>
<a name="line743"><span class="token_number"> 743 </span></a>                
<a name="line744"><span class="token_number"> 744 </span></a>                <span class="token_comment"># clear the old location</span>
<a name="line745"><span class="token_number"> 745 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line746"><span class="token_number"> 746 </span></a>                <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">old_row_target</span><span class="token_op">,</span> <span class="token_name">old_col_target</span><span class="token_op">)</span>
<a name="line747"><span class="token_number"> 747 </span></a>                <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"font"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">default_label_font</span>
<a name="line748"><span class="token_number"> 748 </span></a>                <span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line749"><span class="token_number"> 749 </span></a>                
<a name="line750"><span class="token_number"> 750 </span></a>                <span class="token_comment"># set up the new location</span>
<a name="line751"><span class="token_number"> 751 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line752"><span class="token_number"> 752 </span></a>                <span class="token_name">new_row_interface</span><span class="token_op">,</span> <span class="token_name">new_col_interface</span> <span class="token_op">=</span> <span class="token_name">new_row_target</span> <span class="token_op">+</span> <span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">new_col_target</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line753"><span class="token_number"> 753 </span></a>                
<a name="line754"><span class="token_number"> 754 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">widget</span><span class="token_op">)</span>
<a name="line755"><span class="token_number"> 755 </span></a>                
<a name="line756"><span class="token_number"> 756 </span></a>                <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">new_row_interface</span><span class="token_op">,</span> <span class="token_name">new_col_interface</span><span class="token_op">)]</span>
<a name="line757"><span class="token_number"> 757 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line758"><span class="token_number"> 758 </span></a>                <span class="token_comment">#    label["text"      ] = "(%d,%d)\n%s\n" % (row_target, col_target, widget_name)</span>
<a name="line759"><span class="token_number"> 759 </span></a>                <span class="token_comment">#    label["background"] = CONTROL_COLOR_D[placementWidgetType]</span>
<a name="line760"><span class="token_number"> 760 </span></a>                
<a name="line761"><span class="token_number"> 761 </span></a>            
<a name="line762"><span class="token_number"> 762 </span></a>            <span class="token_name">s</span> <span class="token_op">=</span> <span class="token_string">'Moved widget "%s" to tab_label "%s" (%s,%s)'</span><span class="token_op">%(</span><span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">w2_name</span><span class="token_op">,</span> <span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">)</span>
<a name="line763"><span class="token_number"> 763 </span></a>            <span class="token_comment">#print("="*55)</span>
<a name="line764"><span class="token_number"> 764 </span></a>            <span class="token_comment">#print( s )</span>
<a name="line765"><span class="token_number"> 765 </span></a>            <span class="token_comment">#print("="*55)</span>
<a name="line766"><span class="token_number"> 766 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_name">s</span> <span class="token_op">)</span>
<a name="line767"><span class="token_number"> 767 </span></a>            
<a name="line768"><span class="token_number"> 768 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line769"><span class="token_number"> 769 </span></a>        
<a name="line770"><span class="token_number"> 770 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line771"><span class="token_number"> 771 </span></a><span class="text">            </span><span class="token_name">s</span> <span class="token_op">=</span> <span class="token_string">"Error... tried to move widget to Occupied Target Location (%i,%i)"</span><span class="token_op">%(</span><span class="token_name">new_row_target</span><span class="token_op">,</span> <span class="token_name">new_col_target</span><span class="token_op">)</span>
<a name="line772"><span class="token_number"> 772 </span></a>            <span class="token_comment">#print( s )</span>
<a name="line773"><span class="token_number"> 773 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span> <span class="token_name">s</span> <span class="token_op">)</span>
<a name="line774"><span class="token_number"> 774 </span></a>        
<a name="line775"><span class="token_number"> 775 </span></a>
<a name="line776"><span class="token_number"> 776 </span></a>    <span class="keyword">def</span> <span class="token_name">create_tab</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_string">"New Tab"</span><span class="token_op">):</span>
<a name="line777"><span class="token_number"> 777 </span></a><span class="text">        </span><span class="token_string">"""Add new tab to grid notebook for Label objects."""</span>
<a name="line778"><span class="token_number"> 778 </span></a>        
<a name="line779"><span class="token_number"> 779 </span></a>        <span class="token_name">nbFrame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">,</span> <span class="token_name">name</span><span class="token_op">=</span><span class="token_string">'panel_%i'</span><span class="token_op">%</span><span class="token_name">len</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line780"><span class="token_number"> 780 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tabLabelL</span><span class="token_op">.</span><span class="token_name">append</span><span class="token_op">(</span> <span class="token_name">tab_label</span> <span class="token_op">)</span>
<a name="line781"><span class="token_number"> 781 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">nbFrameL</span><span class="token_op">.</span><span class="token_name">append</span><span class="token_op">(</span> <span class="token_name">nbFrame</span> <span class="token_op">)</span>
<a name="line782"><span class="token_number"> 782 </span></a>        
<a name="line783"><span class="token_number"> 783 </span></a>        <span class="token_name">nbFrame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">side</span><span class="token_op">=</span><span class="token_name">TOP</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">BOTH</span><span class="token_op">,</span> <span class="token_name">expand</span><span class="token_op">=</span><span class="token_name">Y</span><span class="token_op">)</span>
<a name="line784"><span class="token_number"> 784 </span></a>        
<a name="line785"><span class="token_number"> 785 </span></a>        <span class="token_comment"># Place Row and Col controls that Insert or Delete Rows and Cols</span>
<a name="line786"><span class="token_number"> 786 </span></a>        <span class="keyword">for</span> <span class="token_name">row_interface</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_rows_inp</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">):</span>
<a name="line787"><span class="token_number"> 787 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_row_control</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">)</span>
<a name="line788"><span class="token_number"> 788 </span></a>                        
<a name="line789"><span class="token_number"> 789 </span></a>        <span class="keyword">for</span> <span class="token_name">col_interface</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_cols_inp</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">):</span>
<a name="line790"><span class="token_number"> 790 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_col_control</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col_interface</span> <span class="token_op">)</span>
<a name="line791"><span class="token_number"> 791 </span></a>
<a name="line792"><span class="token_number"> 792 </span></a>        <span class="token_comment"># add grid labels</span>
<a name="line793"><span class="token_number"> 793 </span></a>        <span class="token_string">"""Show only num_row x num_col widgets... i.e. No scroll currently available"""</span>
<a name="line794"><span class="token_number"> 794 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_rows_inp</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_cols_inp</span><span class="token_op">)</span>
<a name="line795"><span class="token_number"> 795 </span></a>        <span class="keyword">for</span> <span class="token_name">row_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_rows_inp</span> <span class="token_op">):</span>
<a name="line796"><span class="token_number"> 796 </span></a><span class="text">            </span><span class="keyword">for</span> <span class="token_name">col_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">num_cols_inp</span> <span class="token_op">):</span>
<a name="line797"><span class="token_number"> 797 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_target_grid_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line798"><span class="token_number"> 798 </span></a>
<a name="line799"><span class="token_number"> 799 </span></a>        <span class="token_comment"># add tab to notebook</span>
<a name="line800"><span class="token_number"> 800 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">notebook</span><span class="token_op">.</span><span class="token_name">add</span><span class="token_op">(</span><span class="token_name">nbFrame</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">underline</span><span class="token_op">=</span><span class="token_number">0</span><span class="token_op">,</span> <span class="token_name">padding</span><span class="token_op">=</span><span class="token_number">2</span><span class="token_op">)</span>
<a name="line801"><span class="token_number"> 801 </span></a>        <span class="token_comment">#print("tabs() =", self.notebook.tabs())</span>
<a name="line802"><span class="token_number"> 802 </span></a>    
<a name="line803"><span class="token_number"> 803 </span></a>    <span class="keyword">def</span> <span class="token_name">append_column</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line804"><span class="token_number"> 804 </span></a><span class="text">        </span><span class="token_string">"""Append a column to the grid of the current notebook tab."""</span>
<a name="line805"><span class="token_number"> 805 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line806"><span class="token_number"> 806 </span></a>        
<a name="line807"><span class="token_number"> 807 </span></a>        <span class="token_comment"># increase number of columns for current tab</span>
<a name="line808"><span class="token_number"> 808 </span></a>        <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line809"><span class="token_number"> 809 </span></a>        <span class="token_name">num_cols</span> <span class="token_op">+=</span> <span class="token_number">1</span>
<a name="line810"><span class="token_number"> 810 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span><span class="token_op">)</span>
<a name="line811"><span class="token_number"> 811 </span></a>        
<a name="line812"><span class="token_number"> 812 </span></a>        <span class="token_name">end_col_interface</span> <span class="token_op">=</span> <span class="token_name">num_cols</span> <span class="token_comment"># NEED num_cols for EACH TAB</span>
<a name="line813"><span class="token_number"> 813 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_col_control</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">end_col_interface</span> <span class="token_op">)</span>
<a name="line814"><span class="token_number"> 814 </span></a>        
<a name="line815"><span class="token_number"> 815 </span></a>        <span class="token_comment"># add another column at the end with the right (col,row) label</span>
<a name="line816"><span class="token_number"> 816 </span></a>        <span class="token_name">end_col_target</span> <span class="token_op">=</span> <span class="token_name">end_col_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line817"><span class="token_number"> 817 </span></a>        <span class="keyword">for</span> <span class="token_name">row_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_rows</span> <span class="token_op">):</span>
<a name="line818"><span class="token_number"> 818 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_target_grid_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">end_col_target</span><span class="token_op">)</span>
<a name="line819"><span class="token_number"> 819 </span></a>    
<a name="line820"><span class="token_number"> 820 </span></a>    <span class="keyword">def</span> <span class="token_name">insert_column</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line821"><span class="token_number"> 821 </span></a><span class="text">        </span><span class="token_string">"""Insert a column into the grid of the current notebook tab."""</span>
<a name="line822"><span class="token_number"> 822 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line823"><span class="token_number"> 823 </span></a>        
<a name="line824"><span class="token_number"> 824 </span></a>        <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line825"><span class="token_number"> 825 </span></a>        <span class="keyword">if</span> <span class="token_name">num_cols</span> <span class="token_op">&gt;=</span> <span class="token_name">MAX_NUM_COLS</span><span class="token_op">:</span>
<a name="line826"><span class="token_number"> 826 </span></a><span class="text">            </span><span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span><span class="token_op">.</span><span class="token_name">showinfo</span><span class="token_op">(</span><span class="token_string">"Insert Warning..."</span><span class="token_op">,</span>
<a name="line827"><span class="token_number"> 827 </span></a>                <span class="token_string">"Can NOT have more than %i columns\n\n"</span><span class="token_op">%</span><span class="token_name">MAX_NUM_COLS</span>\
<a name="line828"><span class="token_number"> 828 </span></a>                <span class="token_op">+</span><span class="token_string">"For now, simply use Frame objects to expand the grid area."</span><span class="token_op">)</span>
<a name="line829"><span class="token_number"> 829 </span></a>            <span class="keyword">return</span>
<a name="line830"><span class="token_number"> 830 </span></a>        
<a name="line831"><span class="token_number"> 831 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">append_column</span><span class="token_op">()</span>
<a name="line832"><span class="token_number"> 832 </span></a>        <span class="token_comment"># ----------------------------</span>
<a name="line833"><span class="token_number"> 833 </span></a>        
<a name="line834"><span class="token_number"> 834 </span></a>        <span class="token_comment"># make a copy of current widget info</span>
<a name="line835"><span class="token_number"> 835 </span></a>        <span class="token_name">copy_defined_target_widgetD</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">.</span><span class="token_name">copy</span><span class="token_op">()</span>   <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType or ''</span>
<a name="line836"><span class="token_number"> 836 </span></a>        <span class="token_name">copy_label_obj_from_nameD</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">copy</span><span class="token_op">()</span>       <span class="token_comment"># index=widget_name: value=(tab_label, row_target, col_target, placementWidgetType, Labelobj)</span>
<a name="line837"><span class="token_number"> 837 </span></a>        
<a name="line838"><span class="token_number"> 838 </span></a>        <span class="token_comment"># empty out the main data</span>
<a name="line839"><span class="token_number"> 839 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span>   <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType</span>
<a name="line840"><span class="token_number"> 840 </span></a>        <span class="keyword">for</span> <span class="token_name">key</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">copy_defined_target_widgetD</span><span class="token_op">.</span><span class="token_name">keys</span><span class="token_op">()):</span>
<a name="line841"><span class="token_number"> 841 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span><span class="token_name">key</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line842"><span class="token_number"> 842 </span></a>            
<a name="line843"><span class="token_number"> 843 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span> <span class="token_op">=</span> <span class="token_op">{}</span>     <span class="token_comment"># index=widget_name: value=(tab_label, row_target, col_target, placementWidgetType, Labelobj)</span>
<a name="line844"><span class="token_number"> 844 </span></a>        
<a name="line845"><span class="token_number"> 845 </span></a>        <span class="keyword">for</span> <span class="token_name">widget_name</span><span class="token_op">,(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">copy_label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line846"><span class="token_number"> 846 </span></a>            
<a name="line847"><span class="token_number"> 847 </span></a><span class="text">            </span><span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">copy_defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line848"><span class="token_number"> 848 </span></a>            
<a name="line849"><span class="token_number"> 849 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">==</span><span class="token_name">wtab_label</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">wcol_target</span><span class="token_op">&gt;=</span><span class="token_name">col_target</span><span class="token_op">):</span>
<a name="line850"><span class="token_number"> 850 </span></a>                
<a name="line851"><span class="token_number"> 851 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span>
<a name="line852"><span class="token_number"> 852 </span></a>                <span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line853"><span class="token_number"> 853 </span></a>                <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">row</span> <span class="token_op">=</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">col</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line854"><span class="token_number"> 854 </span></a>                
<a name="line855"><span class="token_number"> 855 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">)</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line856"><span class="token_number"> 856 </span></a>                
<a name="line857"><span class="token_number"> 857 </span></a>                <span class="token_comment">#if self.grid_gui.PreviewWin is not None:</span>
<a name="line858"><span class="token_number"> 858 </span></a>                <span class="token_comment">#    self.grid_gui.PreviewWin.widget_ijD[wrow_target, wcol_target+1] =\</span>
<a name="line859"><span class="token_number"> 859 </span></a>                <span class="token_comment">#        self.grid_gui.PreviewWin.widget_ijD[wrow_target, wcol_target]# index=(i,j) grid position: value=widget</span>
<a name="line860"><span class="token_number"> 860 </span></a>                <span class="token_comment">#    del self.grid_gui.PreviewWin.widget_ijD[wrow_target, wcol_target]</span>
<a name="line861"><span class="token_number"> 861 </span></a>                
<a name="line862"><span class="token_number"> 862 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line863"><span class="token_number"> 863 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span>
<a name="line864"><span class="token_number"> 864 </span></a>                
<a name="line865"><span class="token_number"> 865 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">)</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line866"><span class="token_number"> 866 </span></a>            
<a name="line867"><span class="token_number"> 867 </span></a>    
<a name="line868"><span class="token_number"> 868 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line869"><span class="token_number"> 869 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line870"><span class="token_number"> 870 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Inserted Column at col:%s'</span><span class="token_op">%</span><span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line871"><span class="token_number"> 871 </span></a>    
<a name="line872"><span class="token_number"> 872 </span></a>    <span class="keyword">def</span> <span class="token_name">append_row</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line873"><span class="token_number"> 873 </span></a><span class="text">        </span><span class="token_string">"""Append a new row at the bottom of the current notebook tab."""</span>
<a name="line874"><span class="token_number"> 874 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line875"><span class="token_number"> 875 </span></a>        
<a name="line876"><span class="token_number"> 876 </span></a>        <span class="token_comment"># increase number of rows for current tab</span>
<a name="line877"><span class="token_number"> 877 </span></a>        <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line878"><span class="token_number"> 878 </span></a>        <span class="token_name">num_rows</span> <span class="token_op">+=</span> <span class="token_number">1</span>
<a name="line879"><span class="token_number"> 879 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span><span class="token_op">)</span>
<a name="line880"><span class="token_number"> 880 </span></a>        
<a name="line881"><span class="token_number"> 881 </span></a>        <span class="token_name">end_row_interface</span> <span class="token_op">=</span> <span class="token_name">num_rows</span> <span class="token_comment"># NEED num_rows for EACH TAB</span>
<a name="line882"><span class="token_number"> 882 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_row_control</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">end_row_interface</span> <span class="token_op">)</span>
<a name="line883"><span class="token_number"> 883 </span></a>        
<a name="line884"><span class="token_number"> 884 </span></a>        <span class="token_comment"># add another row at the end with the right (col,row) label</span>
<a name="line885"><span class="token_number"> 885 </span></a>        <span class="token_name">end_row_target</span> <span class="token_op">=</span> <span class="token_name">end_row_interface</span> <span class="token_op">-</span> <span class="token_number">1</span>
<a name="line886"><span class="token_number"> 886 </span></a>        <span class="keyword">for</span> <span class="token_name">col_target</span> <span class="keyword">in</span> <span class="token_name">range</span><span class="token_op">(</span> <span class="token_name">num_cols</span> <span class="token_op">):</span>
<a name="line887"><span class="token_number"> 887 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">make_target_grid_label</span><span class="token_op">(</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">end_row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line888"><span class="token_number"> 888 </span></a>    
<a name="line889"><span class="token_number"> 889 </span></a>    <span class="keyword">def</span> <span class="token_name">insert_row</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">):</span>
<a name="line890"><span class="token_number"> 890 </span></a><span class="text">        </span><span class="token_string">"""Insert a row into the grid of the current notebook tab."""</span>
<a name="line891"><span class="token_number"> 891 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line892"><span class="token_number"> 892 </span></a>        
<a name="line893"><span class="token_number"> 893 </span></a>        
<a name="line894"><span class="token_number"> 894 </span></a>        <span class="token_name">num_rows</span><span class="token_op">,</span> <span class="token_name">num_cols</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">tab_num_rows_colsD</span><span class="token_op">[</span> <span class="token_name">tab_label</span> <span class="token_op">]</span>
<a name="line895"><span class="token_number"> 895 </span></a>        <span class="keyword">if</span> <span class="token_name">num_rows</span> <span class="token_op">&gt;=</span> <span class="token_name">MAX_NUM_ROWS</span><span class="token_op">:</span>
<a name="line896"><span class="token_number"> 896 </span></a><span class="text">            </span><span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span><span class="token_op">.</span><span class="token_name">showinfo</span><span class="token_op">(</span><span class="token_string">"Insert Warning..."</span><span class="token_op">,</span>
<a name="line897"><span class="token_number"> 897 </span></a>                <span class="token_string">"Can NOT have more than %i rows\n\n"</span><span class="token_op">%</span><span class="token_name">MAX_NUM_ROWS</span>\
<a name="line898"><span class="token_number"> 898 </span></a>                <span class="token_op">+</span><span class="token_string">"For now, simply use Frame objects to expand the grid area."</span><span class="token_op">)</span>
<a name="line899"><span class="token_number"> 899 </span></a>            <span class="keyword">return</span>
<a name="line900"><span class="token_number"> 900 </span></a>        
<a name="line901"><span class="token_number"> 901 </span></a>        
<a name="line902"><span class="token_number"> 902 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">append_row</span><span class="token_op">()</span>
<a name="line903"><span class="token_number"> 903 </span></a>        
<a name="line904"><span class="token_number"> 904 </span></a>        <span class="token_comment"># ----------------------------</span>
<a name="line905"><span class="token_number"> 905 </span></a>        
<a name="line906"><span class="token_number"> 906 </span></a>        <span class="token_comment"># make a copy of current widget info</span>
<a name="line907"><span class="token_number"> 907 </span></a>        <span class="token_name">copy_defined_target_widgetD</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">.</span><span class="token_name">copy</span><span class="token_op">()</span>   <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType</span>
<a name="line908"><span class="token_number"> 908 </span></a>        <span class="token_name">copy_label_obj_from_nameD</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">copy</span><span class="token_op">()</span>       <span class="token_comment"># index=widget_name: value=(tab_label, row_target, col_target, placementWidgetType, Labelobj)</span>
<a name="line909"><span class="token_number"> 909 </span></a>        
<a name="line910"><span class="token_number"> 910 </span></a>        <span class="token_comment"># empty out the main data</span>
<a name="line911"><span class="token_number"> 911 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span> <span class="token_op">=</span> <span class="token_op">{}</span>   <span class="token_comment"># index=(tab_label, row_target, col_target): value=placementWidgetType</span>
<a name="line912"><span class="token_number"> 912 </span></a>        <span class="keyword">for</span> <span class="token_name">key</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">copy_defined_target_widgetD</span><span class="token_op">.</span><span class="token_name">keys</span><span class="token_op">()):</span>
<a name="line913"><span class="token_number"> 913 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span><span class="token_name">key</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line914"><span class="token_number"> 914 </span></a>        
<a name="line915"><span class="token_number"> 915 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span> <span class="token_op">=</span> <span class="token_op">{}</span>     <span class="token_comment"># index=widget_name: value=(tab_label, row_target, col_target, placementWidgetType, Labelobj)</span>
<a name="line916"><span class="token_number"> 916 </span></a>        
<a name="line917"><span class="token_number"> 917 </span></a>        <span class="keyword">for</span> <span class="token_name">widget_name</span><span class="token_op">,(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">copy_label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line918"><span class="token_number"> 918 </span></a>            
<a name="line919"><span class="token_number"> 919 </span></a><span class="text">            </span><span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">copy_defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line920"><span class="token_number"> 920 </span></a>            
<a name="line921"><span class="token_number"> 921 </span></a>            <span class="keyword">if</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">==</span><span class="token_name">wtab_label</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">wrow_target</span><span class="token_op">&gt;=</span><span class="token_name">row_target</span><span class="token_op">):</span>
<a name="line922"><span class="token_number"> 922 </span></a>                
<a name="line923"><span class="token_number"> 923 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span>
<a name="line924"><span class="token_number"> 924 </span></a>                <span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line925"><span class="token_number"> 925 </span></a>                <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">row</span> <span class="token_op">=</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">row</span> <span class="token_op">+</span> <span class="token_number">1</span>
<a name="line926"><span class="token_number"> 926 </span></a>                
<a name="line927"><span class="token_number"> 927 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">)</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line928"><span class="token_number"> 928 </span></a>                
<a name="line929"><span class="token_number"> 929 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line930"><span class="token_number"> 930 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">wLabelobj</span><span class="token_op">)</span>
<a name="line931"><span class="token_number"> 931 </span></a>                
<a name="line932"><span class="token_number"> 932 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">wtab_label</span><span class="token_op">,</span> <span class="token_name">wrow_target</span><span class="token_op">,</span> <span class="token_name">wcol_target</span><span class="token_op">)</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line933"><span class="token_number"> 933 </span></a>            
<a name="line934"><span class="token_number"> 934 </span></a>    
<a name="line935"><span class="token_number"> 935 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line936"><span class="token_number"> 936 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line937"><span class="token_number"> 937 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Inserted Row at row:%s'</span><span class="token_op">%</span><span class="token_name">row_target</span><span class="token_op">)</span>
<a name="line938"><span class="token_number"> 938 </span></a>    
<a name="line939"><span class="token_number"> 939 </span></a>    <span class="keyword">def</span> <span class="token_name">onSetColumnWeightClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line940"><span class="token_number"> 940 </span></a><span class="text">        </span><span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line941"><span class="token_number"> 941 </span></a>        
<a name="line942"><span class="token_number"> 942 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span> <span class="token_comment"># weight labels have 2 lines</span>
<a name="line943"><span class="token_number"> 943 </span></a>        <span class="token_name">col</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">0</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">':'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line944"><span class="token_number"> 944 </span></a>        
<a name="line945"><span class="token_number"> 945 </span></a>        <span class="token_comment">#print( "Set Weight for Column %i"%col, ' on tab ',tab_label )</span>
<a name="line946"><span class="token_number"> 946 </span></a>        
<a name="line947"><span class="token_number"> 947 </span></a>        <span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">Wt_Select_Dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">master</span><span class="token_op">,</span> <span class="token_string">"Column %i Weight"</span><span class="token_op">%</span><span class="token_name">col</span><span class="token_op">)</span>
<a name="line948"><span class="token_number"> 948 </span></a>        
<a name="line949"><span class="token_number"> 949 </span></a>        <span class="keyword">if</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line950"><span class="token_number"> 950 </span></a><span class="text">            </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_name">intCast</span><span class="token_op">(</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">'weight'</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line951"><span class="token_number"> 951 </span></a>            
<a name="line952"><span class="token_number"> 952 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">set_a_col_weight</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line953"><span class="token_number"> 953 </span></a>
<a name="line954"><span class="token_number"> 954 </span></a>            <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span>  <span class="token_string">"col:%i\nwt:%s"</span><span class="token_op">%(</span><span class="token_name">col</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line955"><span class="token_number"> 955 </span></a>            <span class="keyword">if</span> <span class="token_name">wt</span> <span class="token_op">&gt;</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line956"><span class="token_number"> 956 </span></a><span class="text">                </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#ff6060"</span>
<a name="line957"><span class="token_number"> 957 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line958"><span class="token_number"> 958 </span></a><span class="text">                </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line959"><span class="token_number"> 959 </span></a>                
<a name="line960"><span class="token_number"> 960 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line961"><span class="token_number"> 961 </span></a>
<a name="line962"><span class="token_number"> 962 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Set Column Weight=%s at col:%s'</span><span class="token_op">%(</span><span class="token_name">wt</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line963"><span class="token_number"> 963 </span></a>
<a name="line964"><span class="token_number"> 964 </span></a>    
<a name="line965"><span class="token_number"> 965 </span></a>    <span class="keyword">def</span> <span class="token_name">onSetRowWeightClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line966"><span class="token_number"> 966 </span></a><span class="text">        </span><span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line967"><span class="token_number"> 967 </span></a>        
<a name="line968"><span class="token_number"> 968 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span> <span class="token_comment"># weight labels have 2 lines</span>
<a name="line969"><span class="token_number"> 969 </span></a>        <span class="token_name">row</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">0</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">':'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line970"><span class="token_number"> 970 </span></a>        
<a name="line971"><span class="token_number"> 971 </span></a>        <span class="token_comment">#print( "Set Weight for Row %i"%row, ' on tab ',tab_label )</span>
<a name="line972"><span class="token_number"> 972 </span></a>        
<a name="line973"><span class="token_number"> 973 </span></a>        <span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">Wt_Select_Dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">master</span><span class="token_op">,</span> <span class="token_string">"Row %i Weight"</span><span class="token_op">%</span><span class="token_name">row</span><span class="token_op">)</span>
<a name="line974"><span class="token_number"> 974 </span></a>        
<a name="line975"><span class="token_number"> 975 </span></a>        <span class="keyword">if</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line976"><span class="token_number"> 976 </span></a><span class="text">            </span><span class="token_name">wt</span> <span class="token_op">=</span> <span class="token_name">intCast</span><span class="token_op">(</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">'weight'</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line977"><span class="token_number"> 977 </span></a>            
<a name="line978"><span class="token_number"> 978 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">set_a_row_weight</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line979"><span class="token_number"> 979 </span></a>
<a name="line980"><span class="token_number"> 980 </span></a>            <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span>  <span class="token_string">"row:%i\nwt:%s"</span><span class="token_op">%(</span><span class="token_name">row</span><span class="token_op">,</span> <span class="token_name">wt</span><span class="token_op">)</span>
<a name="line981"><span class="token_number"> 981 </span></a>            <span class="keyword">if</span> <span class="token_name">wt</span> <span class="token_op">&gt;</span> <span class="token_number">0</span><span class="token_op">:</span>
<a name="line982"><span class="token_number"> 982 </span></a><span class="text">                </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#ff6060"</span>
<a name="line983"><span class="token_number"> 983 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line984"><span class="token_number"> 984 </span></a><span class="text">                </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#daa520"</span> <span class="token_comment"># goldenrod "#ff8080" # light coral</span>
<a name="line985"><span class="token_number"> 985 </span></a>
<a name="line986"><span class="token_number"> 986 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line987"><span class="token_number"> 987 </span></a>
<a name="line988"><span class="token_number"> 988 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Set Row Weight=%s at row:%s'</span><span class="token_op">%(</span><span class="token_name">wt</span><span class="token_op">,</span> <span class="token_name">row</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line989"><span class="token_number"> 989 </span></a>
<a name="line990"><span class="token_number"> 990 </span></a>    <span class="token_comment"># mouse clicked widget</span>
<a name="line991"><span class="token_number"> 991 </span></a>    <span class="keyword">def</span> <span class="token_name">onColInsertClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line992"><span class="token_number"> 992 </span></a><span class="text">        </span><span class="token_string">"""Col Control is Clicked.  Will Insert or Delete a Col"""</span>
<a name="line993"><span class="token_number"> 993 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line994"><span class="token_number"> 994 </span></a>        
<a name="line995"><span class="token_number"> 995 </span></a>        <span class="token_comment">#print( 'Clicked "%s" Column Control.'%tab_label )</span>
<a name="line996"><span class="token_number"> 996 </span></a>        <span class="token_comment">#print("    event x,y =", event.x, event.y)</span>
<a name="line997"><span class="token_number"> 997 </span></a>        <span class="token_comment">#print("    widget w,h =", event.widget.winfo_width(), event.widget.winfo_height())</span>
<a name="line998"><span class="token_number"> 998 </span></a>
<a name="line999"><span class="token_number"> 999 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">()</span> <span class="token_comment"># col labels are a single line</span>
<a name="line1000"><span class="token_number">1000 </span></a>        <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">].</span><span class="token_name">strip</span><span class="token_op">().</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">':'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line1001"><span class="token_number">1001 </span></a>
<a name="line1002"><span class="token_number">1002 </span></a>        <span class="token_name">x</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">x</span> <span class="token_op">)</span>
<a name="line1003"><span class="token_number">1003 </span></a>        <span class="keyword">if</span> <span class="token_name">x</span> <span class="token_op">&lt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w3</span><span class="token_op">:</span>
<a name="line1004"><span class="token_number">1004 </span></a>            <span class="token_comment">#print("   Insert a new col at col_target #%i"%col_target)</span>
<a name="line1005"><span class="token_number">1005 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Insert a new col at col_target #%i"</span><span class="token_op">%</span><span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line1006"><span class="token_number">1006 </span></a>            
<a name="line1007"><span class="token_number">1007 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_column</span><span class="token_op">(</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line1008"><span class="token_number">1008 </span></a>        <span class="keyword">elif</span> <span class="token_name">x</span> <span class="token_op">&gt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w23</span><span class="token_op">:</span>
<a name="line1009"><span class="token_number">1009 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Insert a new col at col_target #%i"</span><span class="token_op">%(</span><span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line1010"><span class="token_number">1010 </span></a>            
<a name="line1011"><span class="token_number">1011 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_column</span><span class="token_op">(</span> <span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span> <span class="token_op">)</span>
<a name="line1012"><span class="token_number">1012 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1013"><span class="token_number">1013 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">""</span><span class="token_op">)</span>
<a name="line1014"><span class="token_number">1014 </span></a>
<a name="line1015"><span class="token_number">1015 </span></a>    <span class="token_comment"># mouse clicked widget</span>
<a name="line1016"><span class="token_number">1016 </span></a>    <span class="keyword">def</span> <span class="token_name">onRowInsertClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1017"><span class="token_number">1017 </span></a><span class="text">        </span><span class="token_string">"""Row Control is Clicked. Will Insert or Delete a Row."""</span>
<a name="line1018"><span class="token_number">1018 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line1019"><span class="token_number">1019 </span></a>        
<a name="line1020"><span class="token_number">1020 </span></a>        <span class="token_comment">#print( 'Clicked "%s" Row Control.'%tab_label )</span>
<a name="line1021"><span class="token_number">1021 </span></a>        <span class="token_comment">#print("    event x,y =", event.x, event.y)</span>
<a name="line1022"><span class="token_number">1022 </span></a>        <span class="token_comment">#print("    widget w,h =", event.widget.winfo_width(), event.widget.winfo_height())</span>
<a name="line1023"><span class="token_number">1023 </span></a>
<a name="line1024"><span class="token_number">1024 </span></a>        <span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span> <span class="token_comment"># row labels have 3 lines</span>
<a name="line1025"><span class="token_number">1025 </span></a>        <span class="token_name">row</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">].</span><span class="token_name">strip</span><span class="token_op">().</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">':'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line1026"><span class="token_number">1026 </span></a>
<a name="line1027"><span class="token_number">1027 </span></a>        <span class="token_name">y</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">y</span> <span class="token_op">)</span>
<a name="line1028"><span class="token_number">1028 </span></a>        
<a name="line1029"><span class="token_number">1029 </span></a>        <span class="keyword">if</span> <span class="token_name">y</span> <span class="token_op">&lt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h3</span><span class="token_op">:</span>
<a name="line1030"><span class="token_number">1030 </span></a>            <span class="token_comment">#print("   Insert a new row at row #%i"%row)</span>
<a name="line1031"><span class="token_number">1031 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Insert a new row at row #%i"</span><span class="token_op">%</span><span class="token_name">row</span><span class="token_op">)</span>
<a name="line1032"><span class="token_number">1032 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_row</span><span class="token_op">(</span> <span class="token_name">row</span> <span class="token_op">)</span>
<a name="line1033"><span class="token_number">1033 </span></a>        <span class="keyword">elif</span> <span class="token_name">y</span> <span class="token_op">&gt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h23</span><span class="token_op">:</span>
<a name="line1034"><span class="token_number">1034 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Insert a new row at row #%i"</span><span class="token_op">%(</span><span class="token_name">row</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">))</span>
<a name="line1035"><span class="token_number">1035 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">insert_row</span><span class="token_op">(</span> <span class="token_name">row</span><span class="token_op">+</span><span class="token_number">1</span> <span class="token_op">)</span>
<a name="line1036"><span class="token_number">1036 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1037"><span class="token_number">1037 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">""</span><span class="token_op">)</span>
<a name="line1038"><span class="token_number">1038 </span></a>
<a name="line1039"><span class="token_number">1039 </span></a>    <span class="keyword">def</span> <span class="token_name">onRowControlMove</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1040"><span class="token_number">1040 </span></a><span class="text">        </span><span class="token_string">"""Movement inside a Row Control.  Changes cursor for Insert and Delete."""</span>
<a name="line1041"><span class="token_number">1041 </span></a>        <span class="token_name">y</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">y</span> <span class="token_op">)</span>
<a name="line1042"><span class="token_number">1042 </span></a>        
<a name="line1043"><span class="token_number">1043 </span></a>        <span class="keyword">if</span> <span class="token_name">y</span> <span class="token_op">&lt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h3</span><span class="token_op">:</span>
<a name="line1044"><span class="token_number">1044 </span></a>            <span class="token_comment">#print(y,"&lt;",self.box_h3)</span>
<a name="line1045"><span class="token_number">1045 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'plus'</span><span class="token_op">)</span>
<a name="line1046"><span class="token_number">1046 </span></a>        <span class="keyword">elif</span> <span class="token_name">y</span> <span class="token_op">&gt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h23</span><span class="token_op">:</span>
<a name="line1047"><span class="token_number">1047 </span></a>            <span class="token_comment">#print(y,"&gt;",self.box_h23)</span>
<a name="line1048"><span class="token_number">1048 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'plus'</span><span class="token_op">)</span>
<a name="line1049"><span class="token_number">1049 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1050"><span class="token_number">1050 </span></a>            <span class="token_comment">#print(self.box_h3,"&lt;",y,"&lt;",self.box_h3)</span>
<a name="line1051"><span class="token_number">1051 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'arrow'</span><span class="token_op">)</span>
<a name="line1052"><span class="token_number">1052 </span></a>
<a name="line1053"><span class="token_number">1053 </span></a>    <span class="keyword">def</span> <span class="token_name">onColControlMove</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1054"><span class="token_number">1054 </span></a><span class="text">        </span><span class="token_string">"""Movement inside a Col Control.  Changes cursor for Insert and Delete."""</span>
<a name="line1055"><span class="token_number">1055 </span></a>        <span class="token_name">x</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">x</span> <span class="token_op">)</span>
<a name="line1056"><span class="token_number">1056 </span></a>        
<a name="line1057"><span class="token_number">1057 </span></a>        <span class="keyword">if</span> <span class="token_name">x</span> <span class="token_op">&lt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w3</span><span class="token_op">:</span>
<a name="line1058"><span class="token_number">1058 </span></a>            <span class="token_comment">#print(x,"&lt;",self.box_h3)</span>
<a name="line1059"><span class="token_number">1059 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'plus'</span><span class="token_op">)</span>
<a name="line1060"><span class="token_number">1060 </span></a>        <span class="keyword">elif</span> <span class="token_name">x</span> <span class="token_op">&gt;</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w23</span><span class="token_op">:</span>
<a name="line1061"><span class="token_number">1061 </span></a>            <span class="token_comment">#print(x,"&gt;",self.box_h23)</span>
<a name="line1062"><span class="token_number">1062 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'plus'</span><span class="token_op">)</span>
<a name="line1063"><span class="token_number">1063 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1064"><span class="token_number">1064 </span></a>            <span class="token_comment">#print(self.box_h3,"&lt;",x,"&lt;",self.box_h3)</span>
<a name="line1065"><span class="token_number">1065 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">cursor</span><span class="token_op">=</span><span class="token_string">'arrow'</span><span class="token_op">)</span>
<a name="line1066"><span class="token_number">1066 </span></a>
<a name="line1067"><span class="token_number">1067 </span></a>
<a name="line1068"><span class="token_number">1068 </span></a>    <span class="token_comment"># mouse is over a widget</span>
<a name="line1069"><span class="token_number">1069 </span></a>    <span class="keyword">def</span> <span class="token_name">onRowControlEnter</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1070"><span class="token_number">1070 </span></a><span class="text">        </span><span class="token_string">"""When cursor moves inside a Row Control.  Changes widget border relief."""</span>
<a name="line1071"><span class="token_number">1071 </span></a>        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"sunken"</span>
<a name="line1072"><span class="token_number">1072 </span></a>
<a name="line1073"><span class="token_number">1073 </span></a>        <span class="token_comment"># confirm box height on first entry</span>
<a name="line1074"><span class="token_number">1074 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_h</span><span class="token_op">:</span>
<a name="line1075"><span class="token_number">1075 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_h</span> <span class="token_op">=</span> <span class="token_name">False</span>
<a name="line1076"><span class="token_number">1076 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">=</span>  <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_height</span><span class="token_op">()</span>
<a name="line1077"><span class="token_number">1077 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1078"><span class="token_number">1078 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1079"><span class="token_number">1079 </span></a>            
<a name="line1080"><span class="token_number">1080 </span></a>    <span class="token_comment"># mouse is over a widget</span>
<a name="line1081"><span class="token_number">1081 </span></a>    <span class="keyword">def</span> <span class="token_name">onColControlEnter</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1082"><span class="token_number">1082 </span></a><span class="text">        </span><span class="token_string">"""When cursor moves inside a Col Control.  Changes widget border relief."""</span>
<a name="line1083"><span class="token_number">1083 </span></a>        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"sunken"</span>
<a name="line1084"><span class="token_number">1084 </span></a>        
<a name="line1085"><span class="token_number">1085 </span></a>        <span class="token_comment"># confirm box width on first entry</span>
<a name="line1086"><span class="token_number">1086 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_w</span><span class="token_op">:</span>
<a name="line1087"><span class="token_number">1087 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_w</span> <span class="token_op">=</span> <span class="token_name">False</span>
<a name="line1088"><span class="token_number">1088 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_width</span><span class="token_op">()</span>
<a name="line1089"><span class="token_number">1089 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1090"><span class="token_number">1090 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1091"><span class="token_number">1091 </span></a>        
<a name="line1092"><span class="token_number">1092 </span></a>    <span class="token_comment"># mouse is leaving a widget</span>
<a name="line1093"><span class="token_number">1093 </span></a>    <span class="keyword">def</span> <span class="token_name">onControlLeave</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1094"><span class="token_number">1094 </span></a><span class="text">        </span><span class="token_string">"""Restore widget border relief when cursor leaves Row or Col Control."""</span>
<a name="line1095"><span class="token_number">1095 </span></a>        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"raised"</span>
<a name="line1096"><span class="token_number">1096 </span></a>
<a name="line1097"><span class="token_number">1097 </span></a>    <span class="token_comment"># mouse is over a widget</span>
<a name="line1098"><span class="token_number">1098 </span></a>    <span class="keyword">def</span> <span class="token_name">onGridBoxEnter</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1099"><span class="token_number">1099 </span></a><span class="text">        </span><span class="token_string">"""When cursor moves inside a Grid Box change widget border relief."""</span>
<a name="line1100"><span class="token_number">1100 </span></a>        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"ridge"</span>
<a name="line1101"><span class="token_number">1101 </span></a>        <span class="token_comment">#event.widget["borderwidth"] = 3</span>
<a name="line1102"><span class="token_number">1102 </span></a>        <span class="token_comment">#event.widget["padx"] = 0</span>
<a name="line1103"><span class="token_number">1103 </span></a>        <span class="token_comment">#event.widget["pady"] = 0</span>
<a name="line1104"><span class="token_number">1104 </span></a>        
<a name="line1105"><span class="token_number">1105 </span></a>        <span class="token_name">background</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">cget</span><span class="token_op">(</span><span class="token_string">"background"</span><span class="token_op">)</span>
<a name="line1106"><span class="token_number">1106 </span></a>        <span class="keyword">if</span> <span class="token_name">background</span> <span class="token_op">==</span> <span class="token_string">"#FFFACD"</span><span class="token_op">:</span>
<a name="line1107"><span class="token_number">1107 </span></a><span class="text">            </span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFFEE"</span>
<a name="line1108"><span class="token_number">1108 </span></a>
<a name="line1109"><span class="token_number">1109 </span></a>        <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_h</span><span class="token_op">:</span>
<a name="line1110"><span class="token_number">1110 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_h</span> <span class="token_op">=</span> <span class="token_name">False</span>
<a name="line1111"><span class="token_number">1111 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">=</span>  <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_height</span><span class="token_op">()</span>
<a name="line1112"><span class="token_number">1112 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1113"><span class="token_number">1113 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_h</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1114"><span class="token_number">1114 </span></a>            
<a name="line1115"><span class="token_number">1115 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">must_confirm_box_w</span> <span class="token_op">=</span> <span class="token_name">False</span>
<a name="line1116"><span class="token_number">1116 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">.</span><span class="token_name">winfo_width</span><span class="token_op">()</span>
<a name="line1117"><span class="token_number">1117 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w3</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1118"><span class="token_number">1118 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w23</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">box_w</span> <span class="token_op">*</span> <span class="token_number">2</span><span class="token_op">)</span> <span class="token_op">//</span> <span class="token_number">3</span>
<a name="line1119"><span class="token_number">1119 </span></a>            
<a name="line1120"><span class="token_number">1120 </span></a>        <span class="token_comment"># highlight widget in PreviewWin</span>
<a name="line1121"><span class="token_number">1121 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_empty</span><span class="token_op">(</span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">):</span>
<a name="line1122"><span class="token_number">1122 </span></a><span class="text">            </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1123"><span class="token_number">1123 </span></a>            <span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">:</span>
<a name="line1124"><span class="token_number">1124 </span></a><span class="text">                </span><span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line1125"><span class="token_number">1125 </span></a>                
<a name="line1126"><span class="token_number">1126 </span></a>                <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">highlight_pw_widget</span><span class="token_op">()</span>
<a name="line1127"><span class="token_number">1127 </span></a>
<a name="line1128"><span class="token_number">1128 </span></a>    <span class="keyword">def</span> <span class="token_name">set_label_widget_background</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">label_widget</span><span class="token_op">):</span>
<a name="line1129"><span class="token_number">1129 </span></a>        
<a name="line1130"><span class="token_number">1130 </span></a><span class="text">        </span><span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line1131"><span class="token_number">1131 </span></a>        <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_rc_target</span><span class="token_op">(</span> <span class="token_name">label_widget</span> <span class="token_op">)</span>
<a name="line1132"><span class="token_number">1132 </span></a>        <span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span>
<a name="line1133"><span class="token_number">1133 </span></a>        
<a name="line1134"><span class="token_number">1134 </span></a>        <span class="keyword">if</span> <span class="token_name">placementWidgetType</span><span class="token_op">:</span>
<a name="line1135"><span class="token_number">1135 </span></a><span class="text">            </span><span class="token_name">label_widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">CONTROL_COLOR_D</span><span class="token_op">[</span><span class="token_name">placementWidgetType</span><span class="token_op">]</span>
<a name="line1136"><span class="token_number">1136 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1137"><span class="token_number">1137 </span></a><span class="text">            </span><span class="token_name">label_widget</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line1138"><span class="token_number">1138 </span></a>        
<a name="line1139"><span class="token_number">1139 </span></a>
<a name="line1140"><span class="token_number">1140 </span></a>    <span class="token_comment"># mouse is leaving a widget</span>
<a name="line1141"><span class="token_number">1141 </span></a>    <span class="keyword">def</span> <span class="token_name">onGridBoxLeave</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1142"><span class="token_number">1142 </span></a><span class="text">        </span><span class="token_string">"""Restore Grid Box border relief when cursor leaves."""</span>
<a name="line1143"><span class="token_number">1143 </span></a>        
<a name="line1144"><span class="token_number">1144 </span></a>        <span class="keyword">if</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">==</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_label_being_edited</span><span class="token_op">:</span>
<a name="line1145"><span class="token_number">1145 </span></a><span class="text">            </span><span class="keyword">return</span>
<a name="line1146"><span class="token_number">1146 </span></a>        
<a name="line1147"><span class="token_number">1147 </span></a>        <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"relief"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"groove"</span>
<a name="line1148"><span class="token_number">1148 </span></a>        <span class="token_comment">#event.widget["borderwidth"] = 2</span>
<a name="line1149"><span class="token_number">1149 </span></a>        <span class="token_comment">#event.widget["padx"] = 1</span>
<a name="line1150"><span class="token_number">1150 </span></a>        <span class="token_comment">#event.widget["pady"] = 1</span>
<a name="line1151"><span class="token_number">1151 </span></a>        
<a name="line1152"><span class="token_number">1152 </span></a>        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_widget_background</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1153"><span class="token_number">1153 </span></a>        
<a name="line1154"><span class="token_number">1154 </span></a>        <span class="token_comment"># return PreviewWin widget to normal</span>
<a name="line1155"><span class="token_number">1155 </span></a>        <span class="keyword">if</span> <span class="keyword">not</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">widget_is_empty</span><span class="token_op">(</span><span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">):</span>
<a name="line1156"><span class="token_number">1156 </span></a><span class="text">            </span><span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1157"><span class="token_number">1157 </span></a>            <span class="keyword">if</span> <span class="token_name">widget_name</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">:</span>
<a name="line1158"><span class="token_number">1158 </span></a><span class="text">                </span><span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line1159"><span class="token_number">1159 </span></a>                
<a name="line1160"><span class="token_number">1160 </span></a>                <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">unhighlight_pw_widget</span><span class="token_op">()</span>
<a name="line1161"><span class="token_number">1161 </span></a>
<a name="line1162"><span class="token_number">1162 </span></a>    <span class="token_comment"># mouse clicked widget</span>
<a name="line1163"><span class="token_number">1163 </span></a>    <span class="keyword">def</span> <span class="token_name">onGridBoxClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1164"><span class="token_number">1164 </span></a><span class="text">        </span><span class="token_string">"""</span>
<a name="line1165"><span class="token_number">1165 </span></a><span class="token_string">        Detect a Click on Label widget in main grid.</span>
<a name="line1166"><span class="token_number">1166 </span></a><span class="token_string">        Each Label widget represents GUI widget that will be added to created GUI.</span>
<a name="line1167"><span class="token_number">1167 </span></a><span class="token_string">        """</span>
<a name="line1168"><span class="token_number">1168 </span></a>        
<a name="line1169"><span class="token_number">1169 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line1170"><span class="token_number">1170 </span></a>        
<a name="line1171"><span class="token_number">1171 </span></a>        <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_rc_target</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1172"><span class="token_number">1172 </span></a>        
<a name="line1173"><span class="token_number">1173 </span></a>        <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span>
<a name="line1174"><span class="token_number">1174 </span></a>        <span class="token_comment">#print('row_target=%d, col_target=%d'%(row_target, col_target))</span>
<a name="line1175"><span class="token_number">1175 </span></a>        <span class="token_comment">#print("Clicked (%i,%i)"%(row_target, col_target ),' on ',tab_label)</span>
<a name="line1176"><span class="token_number">1176 </span></a>        
<a name="line1177"><span class="token_number">1177 </span></a>        <span class="token_comment">#print("self.defined_target_widgetD = ",self.defined_target_widgetD)</span>
<a name="line1178"><span class="token_number">1178 </span></a>        
<a name="line1179"><span class="token_number">1179 </span></a>        <span class="token_comment"># see what widget is selected for placement on the main form</span>
<a name="line1180"><span class="token_number">1180 </span></a>        <span class="token_comment"># (might be placing a duplicate of a selected widget)</span>
<a name="line1181"><span class="token_number">1181 </span></a>        <span class="token_name">s_dup</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">strip</span><span class="token_op">()</span>
<a name="line1182"><span class="token_number">1182 </span></a>        
<a name="line1183"><span class="token_number">1183 </span></a>        <span class="keyword">if</span> <span class="token_name">tab_label</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Notebook'</span><span class="token_op">):</span>
<a name="line1184"><span class="token_number">1184 </span></a><span class="text">            </span><span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_string">'Tab'</span>
<a name="line1185"><span class="token_number">1185 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_source_widget_name</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line1186"><span class="token_number">1186 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">" Only Tab Inserts Allowed on Notebook"</span> <span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line1187"><span class="token_number">1187 </span></a>                    
<a name="line1188"><span class="token_number">1188 </span></a>        <span class="keyword">elif</span> <span class="token_name">s_dup</span> <span class="keyword">and</span> <span class="token_name">s_dup</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'('</span><span class="token_op">):</span> <span class="token_comment"># i.e. widget has a (row,col) position</span>
<a name="line1189"><span class="token_number">1189 </span></a><span class="text">            </span><span class="token_name">sL</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">].</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'\n'</span><span class="token_op">)</span>
<a name="line1190"><span class="token_number">1190 </span></a>            
<a name="line1191"><span class="token_number">1191 </span></a>            <span class="token_comment"># save source widget name for use in target_tk_app_def.TargetTkAppDef making widget</span>
<a name="line1192"><span class="token_number">1192 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_source_widget_name</span> <span class="token_op">=</span> <span class="token_name">sL</span><span class="token_op">[</span><span class="token_number">1</span><span class="token_op">]</span>
<a name="line1193"><span class="token_number">1193 </span></a>            <span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_source_widget_name</span><span class="token_op">.</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'_'</span><span class="token_op">)[</span><span class="token_number">0</span><span class="token_op">]</span>
<a name="line1194"><span class="token_number">1194 </span></a>            
<a name="line1195"><span class="token_number">1195 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1196"><span class="token_number">1196 </span></a><span class="text">            </span><span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span>
<a name="line1197"><span class="token_number">1197 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">dup_source_widget_name</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line1198"><span class="token_number">1198 </span></a>        
<a name="line1199"><span class="token_number">1199 </span></a>        <span class="token_comment"># ======================= PlacementWidgetType decided =======================</span>
<a name="line1200"><span class="token_number">1200 </span></a>        <span class="token_comment"># Check for existing widget at grid location row, col in current tab_label</span>
<a name="line1201"><span class="token_number">1201 </span></a>        <span class="keyword">if</span> <span class="token_op">((</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">)</span> <span class="keyword">and</span> \
<a name="line1202"><span class="token_number">1202 </span></a>           <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]:</span>
<a name="line1203"><span class="token_number">1203 </span></a>
<a name="line1204"><span class="token_number">1204 </span></a>            <span class="token_comment"># get widget_type for widget already in (tab_label, row_target, col_target)</span>
<a name="line1205"><span class="token_number">1205 </span></a><span class="text">            </span><span class="token_name">ptype</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line1206"><span class="token_number">1206 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_name">ptype</span> <span class="token_op">+</span> <span class="token_string">" Widget is at (%i, %i) "</span><span class="token_op">%(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line1207"><span class="token_number">1207 </span></a>            <span class="token_comment">#print( ptype + " Widget is at (%s, %i, %i) "%(tab_label, row_target, col_target) )</span>
<a name="line1208"><span class="token_number">1208 </span></a>            
<a name="line1209"><span class="token_number">1209 </span></a>            <span class="token_comment"># toggle dup_widget_label if already set to this choice</span>
<a name="line1210"><span class="token_number">1210 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">dup_widget_label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">==</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span><span class="token_op">[</span><span class="token_string">"text"</span><span class="token_op">]:</span>
<a name="line1211"><span class="token_number">1211 </span></a>                <span class="token_comment"># set duplicate widget back to plain</span>
<a name="line1212"><span class="token_number">1212 </span></a>                <span class="token_comment">#self.grid_gui.dup_widget_label["text"      ] = "\n\n"</span>
<a name="line1213"><span class="token_number">1213 </span></a>                <span class="token_comment">#self.grid_gui.dup_widget_label["background"] = self.grid_gui.dup_widget_label_plain_bg # "#FFFACD"  # lemonchiffon</span>
<a name="line1214"><span class="token_number">1214 </span></a>        
<a name="line1215"><span class="token_number">1215 </span></a><span class="text">                </span><span class="token_name">val</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span>
<a name="line1216"><span class="token_number">1216 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">set_placement_widget_label</span><span class="token_op">(</span> <span class="token_name">val</span> <span class="token_op">)</span>
<a name="line1217"><span class="token_number">1217 </span></a>                
<a name="line1218"><span class="token_number">1218 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1219"><span class="token_number">1219 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">set_duplication_widget_label</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1220"><span class="token_number">1220 </span></a>            
<a name="line1221"><span class="token_number">1221 </span></a>            
<a name="line1222"><span class="token_number">1222 </span></a>        <span class="keyword">else</span><span class="token_op">:</span> <span class="token_comment"># If row,col is empty, place a new widget here.</span>
<a name="line1223"><span class="token_number">1223 </span></a>            
<a name="line1224"><span class="token_number">1224 </span></a>            <span class="token_comment"># if it's a legal widget, (i.e. is in tkWidgets Dictionary), place it.</span>
<a name="line1225"><span class="token_number">1225 </span></a><span class="text">            </span><span class="keyword">if</span> <span class="token_name">placementWidgetType</span> <span class="keyword">in</span> <span class="token_name">supportedTkWidgetSet</span><span class="token_op">:</span>
<a name="line1226"><span class="token_number">1226 </span></a>                
<a name="line1227"><span class="token_number">1227 </span></a><span class="text">                </span><span class="token_name">num_widget</span> <span class="token_op">=</span> <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">placementWidgetType</span><span class="token_op">]</span>
<a name="line1228"><span class="token_number">1228 </span></a>                <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">placementWidgetType</span><span class="token_op">]</span> <span class="token_op">+=</span> <span class="token_number">1</span>
<a name="line1229"><span class="token_number">1229 </span></a>                <span class="token_name">widget_name</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span> <span class="token_op">+</span> <span class="token_string">"_%i"</span><span class="token_op">%</span><span class="token_name">num_widget</span>
<a name="line1230"><span class="token_number">1230 </span></a>                
<a name="line1231"><span class="token_number">1231 </span></a>                <span class="keyword">if</span> <span class="token_name">tab_label</span><span class="token_op">.</span><span class="token_name">startswith</span><span class="token_op">(</span><span class="token_string">'Notebook'</span><span class="token_op">):</span>
<a name="line1232"><span class="token_number">1232 </span></a>                    <span class="token_comment"># tell target_app about the new tab</span>
<a name="line1233"><span class="token_number">1233 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">add_tab_to_notebook</span><span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">)</span> <span class="token_comment"># tab_label is Notebook_XXX</span>
<a name="line1234"><span class="token_number">1234 </span></a>                                
<a name="line1235"><span class="token_number">1235 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_name">placementWidgetType</span>
<a name="line1236"><span class="token_number">1236 </span></a>                
<a name="line1237"><span class="token_number">1237 </span></a>                <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line1238"><span class="token_number">1238 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_label_text_bg_from_widget_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">)</span>
<a name="line1239"><span class="token_number">1239 </span></a>                <span class="token_comment">#    label["text"      ] = "(%d,%d)\n%s\n" % (row_target, col_target, widget_name)</span>
<a name="line1240"><span class="token_number">1240 </span></a>                <span class="token_comment">#    label["background"] = CONTROL_COLOR_D[placementWidgetType]</span>
<a name="line1241"><span class="token_number">1241 </span></a>                
<a name="line1242"><span class="token_number">1242 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">)</span>
<a name="line1243"><span class="token_number">1243 </span></a>            
<a name="line1244"><span class="token_number">1244 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Placing widget "</span><span class="token_op">+</span><span class="token_name">placementWidgetType</span><span class="token_op">+</span><span class="token_string">" at (%s, %i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">))</span>
<a name="line1245"><span class="token_number">1245 </span></a>                <span class="token_comment">#print( ("Placing widget "+placementWidgetType+" at (%s, %i,%i)"%(tab_label, row_target, col_target)) )</span>
<a name="line1246"><span class="token_number">1246 </span></a>                
<a name="line1247"><span class="token_number">1247 </span></a>                <span class="token_comment"># If widget is a ContainerControlsL, then create a tab on Notebook </span>
<a name="line1248"><span class="token_number">1248 </span></a>                <span class="token_comment">#                ['Frame','LabelFrame','Notebook','RadioGroup']</span>
<a name="line1249"><span class="token_number">1249 </span></a>                <span class="keyword">if</span> <span class="token_name">placementWidgetType</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">:</span>
<a name="line1250"><span class="token_number">1250 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">create_tab</span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_name">widget_name</span><span class="token_op">)</span>
<a name="line1251"><span class="token_number">1251 </span></a>                    
<a name="line1252"><span class="token_number">1252 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line1253"><span class="token_number">1253 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">()</span>
<a name="line1254"><span class="token_number">1254 </span></a>                
<a name="line1255"><span class="token_number">1255 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1256"><span class="token_number">1256 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Widget "</span><span class="token_op">+</span><span class="token_name">placementWidgetType</span><span class="token_op">+</span><span class="token_string">" NOT Recognized"</span><span class="token_op">,</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line1257"><span class="token_number">1257 </span></a>
<a name="line1258"><span class="token_number">1258 </span></a>    <span class="token_comment"># right button click</span>
<a name="line1259"><span class="token_number">1259 </span></a>    <span class="keyword">def</span> <span class="token_name">onGridBoxRightClicked</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1260"><span class="token_number">1260 </span></a><span class="text">        </span><span class="token_string">"""</span>
<a name="line1261"><span class="token_number">1261 </span></a><span class="token_string">        Detect a RightClick on Label widget in current grid.</span>
<a name="line1262"><span class="token_number">1262 </span></a><span class="token_string">        If the Label widget is assigned, then it will be edited.</span>
<a name="line1263"><span class="token_number">1263 </span></a><span class="token_string">        """</span>
<a name="line1264"><span class="token_number">1264 </span></a>        
<a name="line1265"><span class="token_number">1265 </span></a>        <span class="token_name">tab_label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_tab_label</span><span class="token_op">()</span>
<a name="line1266"><span class="token_number">1266 </span></a>        
<a name="line1267"><span class="token_number">1267 </span></a>        <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_widget_rc_target</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_op">)</span>
<a name="line1268"><span class="token_number">1268 </span></a>        
<a name="line1269"><span class="token_number">1269 </span></a>        <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span> <span class="token_op">=</span> <span class="token_name">row_target</span><span class="token_op">+</span><span class="token_number">1</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">+</span><span class="token_number">1</span>
<a name="line1270"><span class="token_number">1270 </span></a>        <span class="token_comment">#print('row_target=%d, col_target=%d'%(row_target, col_target))</span>
<a name="line1271"><span class="token_number">1271 </span></a>        <span class="token_comment">#print("Clicked (%i,%i)"%(row_target, col_target ),' on ',tab_label)</span>
<a name="line1272"><span class="token_number">1272 </span></a>        
<a name="line1273"><span class="token_number">1273 </span></a>        <span class="token_comment">#print("self.defined_target_widgetD = ",self.defined_target_widgetD)</span>
<a name="line1274"><span class="token_number">1274 </span></a>        
<a name="line1275"><span class="token_number">1275 </span></a>        <span class="token_comment"># see what widget is selected for placement on the main form</span>
<a name="line1276"><span class="token_number">1276 </span></a>        <span class="token_name">placementWidgetType</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">()</span>
<a name="line1277"><span class="token_number">1277 </span></a>        <span class="token_comment">#print("placementWidgetType = " + placementWidgetType)</span>
<a name="line1278"><span class="token_number">1278 </span></a>        
<a name="line1279"><span class="token_number">1279 </span></a>        <span class="token_comment"># Check for existing widget at grid location row, col in current tab_label</span>
<a name="line1280"><span class="token_number">1280 </span></a>        <span class="keyword">if</span> <span class="token_op">((</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="keyword">in</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">)</span> <span class="keyword">and</span> \
<a name="line1281"><span class="token_number">1281 </span></a>           <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]:</span>
<a name="line1282"><span class="token_number">1282 </span></a>
<a name="line1283"><span class="token_number">1283 </span></a>            <span class="token_comment"># get widget_type for widget already in (tab_label, row_target, col_target)</span>
<a name="line1284"><span class="token_number">1284 </span></a><span class="text">            </span><span class="token_name">ptype</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[</span> <span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">]</span>
<a name="line1285"><span class="token_number">1285 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">'Editing '</span> <span class="token_op">+</span><span class="token_name">ptype</span> <span class="token_op">+</span> <span class="token_string">" Widget at (%i, %i) "</span><span class="token_op">%(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">)</span>
<a name="line1286"><span class="token_number">1286 </span></a>            <span class="token_comment">#print( ptype + " Widget is at (%s, %i, %i) "%(tab_label, row_target, col_target) )</span>
<a name="line1287"><span class="token_number">1287 </span></a>            
<a name="line1288"><span class="token_number">1288 </span></a>            <span class="token_comment"># get label object, and set up for any property editing</span>
<a name="line1289"><span class="token_number">1289 </span></a>            <span class="token_name">label</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">interface_gridBoxWidgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_interface</span><span class="token_op">,</span> <span class="token_name">col_interface</span><span class="token_op">)]</span>
<a name="line1290"><span class="token_number">1290 </span></a>            
<a name="line1291"><span class="token_number">1291 </span></a>            <span class="token_comment"># prepare to call property editor</span>
<a name="line1292"><span class="token_number">1292 </span></a>            <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">get_all_widget_info</span><span class="token_op">(</span> <span class="token_name">label</span> <span class="token_op">)</span>
<a name="line1293"><span class="token_number">1293 </span></a>            
<a name="line1294"><span class="token_number">1294 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">highlight_grid_widget</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1295"><span class="token_number">1295 </span></a>                        
<a name="line1296"><span class="token_number">1296 </span></a>            
<a name="line1297"><span class="token_number">1297 </span></a>            <span class="token_comment"># get default and user properties</span>
<a name="line1298"><span class="token_number">1298 </span></a>            <span class="keyword">if</span> <span class="token_number">1</span><span class="token_op">:</span><span class="token_comment">#self.grid_gui.PreviewWin is not None:</span>
<a name="line1299"><span class="token_number">1299 </span></a>                
<a name="line1300"><span class="token_number">1300 </span></a><span class="text">                </span><span class="token_name">target_comp</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">compObjD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line1301"><span class="token_number">1301 </span></a>                <span class="token_name">dialogOptionsD</span> <span class="token_op">=</span> <span class="token_op">{}</span>
<a name="line1302"><span class="token_number">1302 </span></a>                <span class="keyword">for</span> <span class="token_name">key</span><span class="token_op">,</span><span class="token_name">val</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">default_tkOptionD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span>
<a name="line1303"><span class="token_number">1303 </span></a><span class="text">                    </span><span class="token_name">dialogOptionsD</span><span class="token_op">[</span><span class="token_name">key</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">val</span><span class="token_op">,</span> <span class="token_string">"def."</span><span class="token_op">)</span>
<a name="line1304"><span class="token_number">1304 </span></a>                    
<a name="line1305"><span class="token_number">1305 </span></a>                <span class="keyword">for</span> <span class="token_name">key</span><span class="token_op">,</span><span class="token_name">val</span> <span class="keyword">in</span> <span class="token_name">list</span><span class="token_op">(</span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">items</span><span class="token_op">()):</span> <span class="token_comment"># user_tkOptionD holds tk options set by user. (i.e. not same as default_tkOptionD)</span>
<a name="line1306"><span class="token_number">1306 </span></a><span class="text">                    </span><span class="token_name">dialogOptionsD</span><span class="token_op">[</span><span class="token_name">key</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_op">(</span><span class="token_name">val</span><span class="token_op">,</span> <span class="token_string">"USER VALUE"</span><span class="token_op">)</span>
<a name="line1307"><span class="token_number">1307 </span></a>            
<a name="line1308"><span class="token_number">1308 </span></a>                <span class="token_name">dialogOptionsD</span><span class="token_op">[</span><span class="token_string">'child_widget_list'</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">get_names_of_containers_widgets</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1309"><span class="token_number">1309 </span></a>            
<a name="line1310"><span class="token_number">1310 </span></a>                <span class="token_comment"># highlight widget on PreviewWin</span>
<a name="line1311"><span class="token_number">1311 </span></a>                <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">highlight_pw_widget</span><span class="token_op">()</span> <span class="token_comment"># onGridBoxLeave tries to override this when Edit_Properties_Dialog is called.</span>
<a name="line1312"><span class="token_number">1312 </span></a>                
<a name="line1313"><span class="token_number">1313 </span></a>                <span class="token_comment">#self.grid_gui.PreviewWin.update()</span>
<a name="line1314"><span class="token_number">1314 </span></a>                    
<a name="line1315"><span class="token_number">1315 </span></a>            <span class="token_comment">#else:</span>
<a name="line1316"><span class="token_number">1316 </span></a>            <span class="token_comment">#    dialogOptionsD = None</span>
<a name="line1317"><span class="token_number">1317 </span></a>            <span class="token_comment">#    target_comp = None                </span>
<a name="line1318"><span class="token_number">1318 </span></a>            
<a name="line1319"><span class="token_number">1319 </span></a>            <span class="token_comment"># call property editor</span>
<a name="line1320"><span class="token_number">1320 </span></a>            
<a name="line1321"><span class="token_number">1321 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_label_being_edited</span> <span class="token_op">=</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">widget</span> <span class="token_comment"># used as flag in onGridBoxLeave to maintain hightlight</span>
<a name="line1322"><span class="token_number">1322 </span></a>            
<a name="line1323"><span class="token_number">1323 </span></a>            <span class="token_name">dialog</span> <span class="token_op">=</span> <span class="token_name">Edit_Properties_Dialog</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">master</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">dialogOptionsD</span><span class="token_op">=</span><span class="token_name">dialogOptionsD</span><span class="token_op">)</span>
<a name="line1324"><span class="token_number">1324 </span></a>
<a name="line1325"><span class="token_number">1325 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">current_label_being_edited</span> <span class="token_op">=</span> <span class="token_name">None</span> <span class="token_comment"># used as flag in onGridBoxLeave to maintain hightlight</span>
<a name="line1326"><span class="token_number">1326 </span></a>
<a name="line1327"><span class="token_number">1327 </span></a>            <span class="keyword">def</span> <span class="token_name">unhighlight_edited_widget</span><span class="token_op">():</span>
<a name="line1328"><span class="token_number">1328 </span></a>                <span class="token_comment"># restore label on grid to normal</span>
<a name="line1329"><span class="token_number">1329 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">unhighlight_grid_widget</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1330"><span class="token_number">1330 </span></a>                <span class="keyword">if</span> <span class="token_name">target_comp</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line1331"><span class="token_number">1331 </span></a><span class="text">                    </span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">unhighlight_pw_widget</span><span class="token_op">()</span>
<a name="line1332"><span class="token_number">1332 </span></a>            
<a name="line1333"><span class="token_number">1333 </span></a>            <span class="token_comment"># use dialog results to set properties</span>
<a name="line1334"><span class="token_number">1334 </span></a>            <span class="keyword">if</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="keyword">is</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line1335"><span class="token_number">1335 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">master</span><span class="token_op">.</span><span class="token_name">after</span><span class="token_op">(</span> <span class="token_number">500</span><span class="token_op">,</span> <span class="token_name">unhighlight_edited_widget</span> <span class="token_op">)</span> <span class="token_comment"># give user half a sectond to see highlight</span>
<a name="line1336"><span class="token_number">1336 </span></a>            <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1337"><span class="token_number">1337 </span></a>                <span class="token_comment"># check for delete widget command</span>
<a name="line1338"><span class="token_number">1338 </span></a><span class="text">                </span><span class="keyword">if</span> <span class="token_op">(</span><span class="token_string">"DeleteWidget"</span> <span class="keyword">in</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">)</span> <span class="keyword">and</span> <span class="token_op">(</span><span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span><span class="token_op">[</span><span class="token_string">"DeleteWidget"</span><span class="token_op">]==</span><span class="token_string">"yes"</span><span class="token_op">):</span>
<a name="line1339"><span class="token_number">1339 </span></a>                    
<a name="line1340"><span class="token_number">1340 </span></a><span class="text">                    </span><span class="token_name">unhighlight_edited_widget</span><span class="token_op">()</span>
<a name="line1341"><span class="token_number">1341 </span></a>                    
<a name="line1342"><span class="token_number">1342 </span></a>                    <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">_</span><span class="token_op">,</span> <span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">_</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">.</span><span class="token_name">get</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_string">''</span> <span class="token_op">)</span>
<a name="line1343"><span class="token_number">1343 </span></a>                    
<a name="line1344"><span class="token_number">1344 </span></a>                    <span class="keyword">if</span> <span class="token_name">widget_type</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">:</span>
<a name="line1345"><span class="token_number">1345 </span></a>                        
<a name="line1346"><span class="token_number">1346 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">removeContainerByName</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1347"><span class="token_number">1347 </span></a>                        
<a name="line1348"><span class="token_number">1348 </span></a>                    <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1349"><span class="token_number">1349 </span></a>                        <span class="token_comment">#print("Deleting ",widget_name)</span>
<a name="line1350"><span class="token_number">1350 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">delete_widget_by_name</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1351"><span class="token_number">1351 </span></a>                        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">delComponentByName</span><span class="token_op">(</span> <span class="token_name">widget_name</span> <span class="token_op">)</span>
<a name="line1352"><span class="token_number">1352 </span></a>                                        
<a name="line1353"><span class="token_number">1353 </span></a>                <span class="keyword">else</span><span class="token_op">:</span> <span class="token_comment"># not deleting, so update user_tkOptionD for widget</span>
<a name="line1354"><span class="token_number">1354 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">master</span><span class="token_op">.</span><span class="token_name">after</span><span class="token_op">(</span> <span class="token_number">500</span><span class="token_op">,</span> <span class="token_name">unhighlight_edited_widget</span> <span class="token_op">)</span> <span class="token_comment"># give user half a sectond to see highlight</span>
<a name="line1355"><span class="token_number">1355 </span></a>                    
<a name="line1356"><span class="token_number">1356 </span></a>                    <span class="token_comment">#print('grid_notebook dialog.result =',dialog.result)</span>
<a name="line1357"><span class="token_number">1357 </span></a>                    <span class="keyword">if</span> <span class="token_name">target_comp</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line1358"><span class="token_number">1358 </span></a><span class="text">                        </span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">.</span><span class="token_name">update</span><span class="token_op">(</span> <span class="token_name">dialog</span><span class="token_op">.</span><span class="token_name">result</span> <span class="token_op">)</span>
<a name="line1359"><span class="token_number">1359 </span></a>                        <span class="keyword">if</span>  <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">widget_type</span> <span class="token_op">!=</span> <span class="token_string">"Tab"</span><span class="token_op">:</span>
<a name="line1360"><span class="token_number">1360 </span></a><span class="text">                            </span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">set_user_properties</span><span class="token_op">()</span>
<a name="line1361"><span class="token_number">1361 </span></a>        
<a name="line1362"><span class="token_number">1362 </span></a>                    <span class="token_comment"># need to repostion Canvas Label</span>
<a name="line1363"><span class="token_number">1363 </span></a>                    <span class="keyword">if</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">widget_type</span> <span class="token_op">==</span> <span class="token_string">"Canvas"</span><span class="token_op">:</span>
<a name="line1364"><span class="token_number">1364 </span></a><span class="text">                        </span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">pw_widget</span><span class="token_op">.</span><span class="token_name">native_widget</span><span class="token_op">.</span><span class="token_name">delete</span><span class="token_op">(</span> <span class="token_string">'all'</span> <span class="token_op">)</span>
<a name="line1365"><span class="token_number">1365 </span></a>                        <span class="token_name">w</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">[</span><span class="token_string">'width'</span><span class="token_op">])</span>
<a name="line1366"><span class="token_number">1366 </span></a>                        <span class="token_name">h</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">[</span><span class="token_string">'height'</span><span class="token_op">])</span>
<a name="line1367"><span class="token_number">1367 </span></a>                        <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">pw_widget</span><span class="token_op">.</span><span class="token_name">native_widget</span><span class="token_op">.</span><span class="token_name">create_text</span><span class="token_op">(</span><span class="token_name">w</span><span class="token_op">//</span><span class="token_number">2</span><span class="token_op">,</span><span class="token_name">h</span><span class="token_op">//</span><span class="token_number">2</span><span class="token_op">,</span> <span class="token_name">text</span><span class="token_op">=</span><span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">widget_name</span><span class="token_op">,</span> 
<a name="line1368"><span class="token_number">1368 </span></a>                                                                        <span class="token_name">fill</span><span class="token_op">=</span><span class="token_string">"black"</span><span class="token_op">,</span> <span class="token_name">width</span><span class="token_op">=</span><span class="token_name">w</span><span class="token_op">,</span> <span class="token_name">anchor</span><span class="token_op">=</span><span class="token_string">'center'</span><span class="token_op">)</span>
<a name="line1369"><span class="token_number">1369 </span></a>                    <span class="keyword">elif</span>  <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">widget_type</span> <span class="token_op">==</span> <span class="token_string">"Tab"</span><span class="token_op">:</span>
<a name="line1370"><span class="token_number">1370 </span></a><span class="text">                        </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">change_notebook_tab_label</span><span class="token_op">(</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">target_comp</span><span class="token_op">.</span><span class="token_name">user_tkOptionD</span><span class="token_op">[</span><span class="token_string">'text'</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line1371"><span class="token_number">1371 </span></a>                        
<a name="line1372"><span class="token_number">1372 </span></a>                        <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line1373"><span class="token_number">1373 </span></a>
<a name="line1374"><span class="token_number">1374 </span></a>                        
<a name="line1375"><span class="token_number">1375 </span></a>                <span class="token_comment"># reinitialize display</span>
<a name="line1376"><span class="token_number">1376 </span></a>                <span class="token_comment">#widgetL = [(c.widget_type, widget_name, c.tab_label, c.row, c.col) for widget_name,c in self.grid_gui.target_app.compObjD.items()]</span>
<a name="line1377"><span class="token_number">1377 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">repaint_all_labels</span><span class="token_op">(</span> <span class="token_op">)</span>
<a name="line1378"><span class="token_number">1378 </span></a>                
<a name="line1379"><span class="token_number">1379 </span></a>                <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line1380"><span class="token_number">1380 </span></a><span class="text">                    </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">PreviewWin</span><span class="token_op">.</span><span class="token_name">maybe_resize_preview_win</span><span class="token_op">()</span>
<a name="line1381"><span class="token_number">1381 </span></a>
<a name="line1382"><span class="token_number">1382 </span></a>            
<a name="line1383"><span class="token_number">1383 </span></a>            
<a name="line1384"><span class="token_number">1384 </span></a>    <span class="keyword">def</span> <span class="token_name">delete_widget_by_name</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">):</span>
<a name="line1385"><span class="token_number">1385 </span></a>        
<a name="line1386"><span class="token_number">1386 </span></a><span class="text">        </span><span class="token_op">(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">,</span> <span class="token_name">placementWidgetType</span><span class="token_op">,</span> <span class="token_name">label</span><span class="token_op">)</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line1387"><span class="token_number">1387 </span></a>
<a name="line1388"><span class="token_number">1388 </span></a>        <span class="keyword">if</span> <span class="token_name">placementWidgetType</span> <span class="keyword">in</span> <span class="token_name">ContainerControlsL</span><span class="token_op">:</span>
<a name="line1389"><span class="token_number">1389 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Can NOT delete Containeer Widget "</span><span class="token_op">+</span><span class="token_name">placementWidgetType</span><span class="token_op">+</span>\
<a name="line1390"><span class="token_number">1390 </span></a>                                <span class="token_string">" at (%s,%i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">),</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line1391"><span class="token_number">1391 </span></a>                                    
<a name="line1392"><span class="token_number">1392 </span></a>            <span class="token_name">tkinter</span><span class="token_op">.</span><span class="token_name">messagebox</span><span class="token_op">.</span><span class="token_name">showinfo</span><span class="token_op">(</span><span class="token_string">"Delete Warning..."</span><span class="token_op">,</span>
<a name="line1393"><span class="token_number">1393 </span></a>                <span class="token_string">"Can NOT delete Containeer Widget "</span><span class="token_op">+</span><span class="token_name">placementWidgetType</span><span class="token_op">+</span><span class="token_string">'\n\n'</span><span class="token_op">+</span>\
<a name="line1394"><span class="token_number">1394 </span></a>                <span class="token_string">" at (%s,%i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">))</span>
<a name="line1395"><span class="token_number">1395 </span></a>                                    
<a name="line1396"><span class="token_number">1396 </span></a>        <span class="keyword">else</span><span class="token_op">:</span>
<a name="line1397"><span class="token_number">1397 </span></a>            <span class="token_comment"># if this is just added, reset numbering in CONTROL_NEXT_NUMBER_D</span>
<a name="line1398"><span class="token_number">1398 </span></a><span class="text">            </span><span class="token_name">num_widget</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">widget_name</span><span class="token_op">.</span><span class="token_name">split</span><span class="token_op">(</span><span class="token_string">'_'</span><span class="token_op">)[-</span><span class="token_number">1</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line1399"><span class="token_number">1399 </span></a>            <span class="keyword">if</span> <span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">placementWidgetType</span><span class="token_op">]</span> <span class="token_op">==</span> <span class="token_name">num_widget</span> <span class="token_op">+</span> <span class="token_number">1</span><span class="token_op">:</span>
<a name="line1400"><span class="token_number">1400 </span></a><span class="text">                </span><span class="token_name">CONTROL_NEXT_NUMBER_D</span><span class="token_op">[</span><span class="token_name">placementWidgetType</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_name">num_widget</span>
<a name="line1401"><span class="token_number">1401 </span></a>                
<a name="line1402"><span class="token_number">1402 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">defined_target_widgetD</span><span class="token_op">[(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)]</span> <span class="token_op">=</span> <span class="token_string">''</span>
<a name="line1403"><span class="token_number">1403 </span></a>            
<a name="line1404"><span class="token_number">1404 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"text"</span>      <span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"(%d,%d)\n\n"</span> <span class="token_op">%</span> <span class="token_op">(</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line1405"><span class="token_number">1405 </span></a>            <span class="token_name">label</span><span class="token_op">[</span><span class="token_string">"background"</span><span class="token_op">]</span> <span class="token_op">=</span> <span class="token_string">"#FFFACD"</span>  <span class="token_comment"># lemonchiffon</span>
<a name="line1406"><span class="token_number">1406 </span></a>            
<a name="line1407"><span class="token_number">1407 </span></a>            <span class="keyword">del</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">label_obj_from_nameD</span><span class="token_op">[</span> <span class="token_name">widget_name</span> <span class="token_op">]</span>
<a name="line1408"><span class="token_number">1408 </span></a>        
<a name="line1409"><span class="token_number">1409 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">set_status_msg</span><span class="token_op">(</span><span class="token_string">"Deleted widget "</span><span class="token_op">+</span><span class="token_name">placementWidgetType</span><span class="token_op">+</span>\
<a name="line1410"><span class="token_number">1410 </span></a>                                <span class="token_string">" at (%s,%i,%i)"</span><span class="token_op">%(</span><span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">),</span> <span class="token_name">also_print</span><span class="token_op">=</span><span class="token_name">True</span><span class="token_op">)</span>
<a name="line1411"><span class="token_number">1411 </span></a>                
<a name="line1412"><span class="token_number">1412 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_gui</span><span class="token_op">.</span><span class="token_name">refresh_preview_win</span><span class="token_op">()</span>
<a name="line1413"><span class="token_number">1413 </span></a>                
<a name="line1414"><span class="token_number">1414 </span></a>
<a name="line1415"><span class="token_number">1415 </span></a>        
<a name="line1416"><span class="token_number">1416 </span></a>        
<a name="line1417"><span class="token_number">1417 </span></a><span class="keyword">if</span> <span class="token_name">__name__</span> <span class="token_op">==</span> <span class="token_string">'__main__'</span><span class="token_op">:</span>
<a name="line1418"><span class="token_number">1418 </span></a>    
<a name="line1419"><span class="token_number">1419 </span></a><span class="text">    </span><span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">target_tk_app_def</span> <span class="keyword">import</span> <span class="token_name">TargetTkAppDef</span>
<a name="line1420"><span class="token_number">1420 </span></a>    <span class="keyword">from</span> <span class="token_name">tkgridgui</span><span class="token_op">.</span><span class="token_name">preview_win</span> <span class="keyword">import</span> <span class="token_name">PreviewWin</span>
<a name="line1421"><span class="token_number">1421 </span></a>    
<a name="line1422"><span class="token_number">1422 </span></a>    <span class="keyword">class</span> <span class="token_name">MockGridGUI</span><span class="token_op">(</span><span class="token_name">object</span><span class="token_op">):</span>
<a name="line1423"><span class="token_number">1423 </span></a><span class="text">        </span><span class="keyword">def</span> <span class="token_name">__init__</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">MainWin</span><span class="token_op">):</span>
<a name="line1424"><span class="token_number">1424 </span></a><span class="text">            </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span> <span class="token_op">=</span> <span class="token_name">MainWin</span>
<a name="line1425"><span class="token_number">1425 </span></a>            <span class="token_name">topFrame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span> <span class="token_name">MainWin</span> <span class="token_op">)</span> <span class="token_comment"># frame for controls</span>
<a name="line1426"><span class="token_number">1426 </span></a>
<a name="line1427"><span class="token_number">1427 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span><span class="token_name">topFrame</span><span class="token_op">)</span> 
<a name="line1428"><span class="token_number">1428 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span> <span class="token_op">=</span> <span class="token_name">NotebookGridDes</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span><span class="token_op">,</span> <span class="token_name">MainWin</span><span class="token_op">,</span> <span class="token_name">num_cols</span><span class="token_op">=</span><span class="token_number">6</span><span class="token_op">,</span> <span class="token_name">num_rows</span><span class="token_op">=</span><span class="token_number">10</span><span class="token_op">)</span>
<a name="line1429"><span class="token_number">1429 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_frame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">N</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">LEFT</span><span class="token_op">)</span>
<a name="line1430"><span class="token_number">1430 </span></a>            
<a name="line1431"><span class="token_number">1431 </span></a>            <span class="token_name">topFrame</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">BOTH</span><span class="token_op">,</span> <span class="token_name">expand</span><span class="token_op">=</span><span class="token_name">Y</span><span class="token_op">)</span>
<a name="line1432"><span class="token_number">1432 </span></a>        
<a name="line1433"><span class="token_number">1433 </span></a>            <span class="token_comment"># make a Status Bar</span>
<a name="line1434"><span class="token_number">1434 </span></a>            <span class="token_name">statframe</span> <span class="token_op">=</span> <span class="token_name">Frame</span><span class="token_op">(</span><span class="token_name">MainWin</span><span class="token_op">)</span>
<a name="line1435"><span class="token_number">1435 </span></a>            <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span> <span class="token_op">=</span> <span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line1436"><span class="token_number">1436 </span></a>            <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'Welcome to TkGridGUI'</span><span class="token_op">)</span>
<a name="line1437"><span class="token_number">1437 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusbar</span> <span class="token_op">=</span> <span class="token_name">Label</span><span class="token_op">(</span><span class="token_name">statframe</span><span class="token_op">,</span> <span class="token_name">textvariable</span><span class="token_op">=</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">,</span> 
<a name="line1438"><span class="token_number">1438 </span></a>                <span class="token_name">relief</span><span class="token_op">=</span><span class="token_name">SUNKEN</span><span class="token_op">,</span> <span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">W</span><span class="token_op">)</span>
<a name="line1439"><span class="token_number">1439 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">statusbar</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">SW</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">X</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">BOTTOM</span><span class="token_op">)</span>
<a name="line1440"><span class="token_number">1440 </span></a>            <span class="token_name">statframe</span><span class="token_op">.</span><span class="token_name">pack</span><span class="token_op">(</span><span class="token_name">anchor</span><span class="token_op">=</span><span class="token_name">SW</span><span class="token_op">,</span> <span class="token_name">fill</span><span class="token_op">=</span><span class="token_name">X</span><span class="token_op">,</span> <span class="token_name">side</span><span class="token_op">=</span><span class="token_name">BOTTOM</span><span class="token_op">)</span>
<a name="line1441"><span class="token_number">1441 </span></a>            
<a name="line1442"><span class="token_number">1442 </span></a>    
<a name="line1443"><span class="token_number">1443 </span></a>            <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">=</span><span class="token_name">StringVar</span><span class="token_op">()</span>
<a name="line1444"><span class="token_number">1444 </span></a>            <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span><span class="token_string">'Button'</span><span class="token_op">)</span>
<a name="line1445"><span class="token_number">1445 </span></a>            <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">bind</span><span class="token_op">(</span><span class="token_string">"&lt;Key&gt;"</span><span class="token_op">,</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">key_set_placement_widget</span><span class="token_op">)</span>
<a name="line1446"><span class="token_number">1446 </span></a>            
<a name="line1447"><span class="token_number">1447 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span> <span class="token_op">=</span> <span class="token_name">TargetTkAppDef</span><span class="token_op">(</span> <span class="token_name">name</span><span class="token_op">=</span><span class="token_string">'myApp'</span><span class="token_op">)</span>
<a name="line1448"><span class="token_number">1448 </span></a>            <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">=</span> <span class="token_name">None</span>
<a name="line1449"><span class="token_number">1449 </span></a>        
<a name="line1450"><span class="token_number">1450 </span></a>        <span class="keyword">def</span> <span class="token_name">key_set_placement_widget</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">,</span> <span class="token_name">event</span><span class="token_op">):</span>
<a name="line1451"><span class="token_number">1451 </span></a><span class="text">            </span><span class="token_string">"""When the user hits a number key, set the placementWidgetType to that index of CONTROLS"""</span>
<a name="line1452"><span class="token_number">1452 </span></a>            <span class="keyword">try</span><span class="token_op">:</span>
<a name="line1453"><span class="token_number">1453 </span></a><span class="text">                </span><span class="token_name">i</span> <span class="token_op">=</span> <span class="token_name">int</span><span class="token_op">(</span> <span class="token_name">event</span><span class="token_op">.</span><span class="token_name">char</span> <span class="token_op">)</span>
<a name="line1454"><span class="token_number">1454 </span></a>                <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">placementWidgetType_svar</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">CONTROLS</span><span class="token_op">[</span><span class="token_name">i</span><span class="token_op">][</span><span class="token_number">0</span><span class="token_op">]</span> <span class="token_op">)</span>
<a name="line1455"><span class="token_number">1455 </span></a>                <span class="token_name">msg</span> <span class="token_op">=</span> <span class="token_string">'placementWidgetType_svar set to:'</span> <span class="token_op">+</span> <span class="token_name">CONTROLS</span><span class="token_op">[</span><span class="token_name">i</span><span class="token_op">][</span><span class="token_number">0</span><span class="token_op">]</span>
<a name="line1456"><span class="token_number">1456 </span></a>                <span class="token_comment">#print( msg )</span>
<a name="line1457"><span class="token_number">1457 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">statusMessage</span><span class="token_op">.</span><span class="token_name">set</span><span class="token_op">(</span> <span class="token_name">msg</span> <span class="token_op">)</span>
<a name="line1458"><span class="token_number">1458 </span></a>            <span class="keyword">except</span><span class="token_op">:</span>
<a name="line1459"><span class="token_number">1459 </span></a><span class="text">                </span><span class="keyword">pass</span>
<a name="line1460"><span class="token_number">1460 </span></a>        
<a name="line1461"><span class="token_number">1461 </span></a>        <span class="keyword">def</span> <span class="token_name">refresh_preview_win</span><span class="token_op">(</span><span class="token_name">self</span><span class="token_op">):</span>
<a name="line1462"><span class="token_number">1462 </span></a><span class="text">            </span><span class="token_string">"""Get all widget info from grid_notebook and pass into to target_app."""</span>
<a name="line1463"><span class="token_number">1463 </span></a>            <span class="keyword">if</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="keyword">is</span> <span class="token_name">None</span><span class="token_op">:</span>
<a name="line1464"><span class="token_number">1464 </span></a><span class="text">                </span><span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">=</span> <span class="token_name">PreviewWin</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">MainWin</span> <span class="token_op">)</span>
<a name="line1465"><span class="token_number">1465 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">set_PreviewWin</span><span class="token_op">(</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">PreviewWin</span> <span class="token_op">)</span>
<a name="line1466"><span class="token_number">1466 </span></a>                <span class="token_comment">#self.grid_gui.PreviewWin = PreviewWin</span>
<a name="line1467"><span class="token_number">1467 </span></a>            
<a name="line1468"><span class="token_number">1468 </span></a>            <span class="token_name">widgetL</span> <span class="token_op">=</span> <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">grid_notebook</span><span class="token_op">.</span><span class="token_name">make_complete_list_of_widgets</span><span class="token_op">()</span>
<a name="line1469"><span class="token_number">1469 </span></a>            <span class="token_comment">#print("========== PreviewWin Widget Info.")</span>
<a name="line1470"><span class="token_number">1470 </span></a>            <span class="keyword">for</span> <span class="token_name">w</span> <span class="keyword">in</span> <span class="token_name">widgetL</span><span class="token_op">:</span>
<a name="line1471"><span class="token_number">1471 </span></a>                <span class="token_comment">#print( w )</span>
<a name="line1472"><span class="token_number">1472 </span></a><span class="text">                </span><span class="token_op">(</span><span class="token_name">widget_type</span><span class="token_op">,</span> <span class="token_name">widget_name</span><span class="token_op">,</span> <span class="token_name">tab_label</span><span class="token_op">,</span> <span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col_target</span><span class="token_op">)</span> <span class="token_op">=</span> <span class="token_name">w</span>
<a name="line1473"><span class="token_number">1473 </span></a>                
<a name="line1474"><span class="token_number">1474 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">maybe_add_component</span><span class="token_op">(</span> <span class="token_name">widget_type</span><span class="token_op">=</span><span class="token_name">widget_type</span><span class="token_op">,</span> 
<a name="line1475"><span class="token_number">1475 </span></a>                                                     <span class="token_name">widget_name</span><span class="token_op">=</span><span class="token_name">widget_name</span><span class="token_op">,</span> 
<a name="line1476"><span class="token_number">1476 </span></a>                                                     <span class="token_name">tab_label</span><span class="token_op">=</span><span class="token_name">tab_label</span><span class="token_op">,</span> 
<a name="line1477"><span class="token_number">1477 </span></a>                                                     <span class="token_name">row</span><span class="token_op">=</span><span class="token_name">row_target</span><span class="token_op">,</span> <span class="token_name">col</span><span class="token_op">=</span><span class="token_name">col_target</span><span class="token_op">)</span>
<a name="line1478"><span class="token_number">1478 </span></a>                <span class="token_name">self</span><span class="token_op">.</span><span class="token_name">target_app</span><span class="token_op">.</span><span class="token_name">show_preview</span><span class="token_op">()</span>
<a name="line1479"><span class="token_number">1479 </span></a>            <span class="token_comment">#print("="*55)</span>
<a name="line1480"><span class="token_number">1480 </span></a>    
<a name="line1481"><span class="token_number">1481 </span></a>    <span class="token_name">root</span> <span class="token_op">=</span> <span class="token_name">Tk</span><span class="token_op">()</span>
<a name="line1482"><span class="token_number">1482 </span></a>    <span class="token_name">MainWin</span> <span class="token_op">=</span> <span class="token_name">root</span>
<a name="line1483"><span class="token_number">1483 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">title</span><span class="token_op">(</span><span class="token_string">'Main Window'</span><span class="token_op">)</span>
<a name="line1484"><span class="token_number">1484 </span></a>    <span class="token_comment">#MainWin.geometry('320x320+10+10')</span>
<a name="line1485"><span class="token_number">1485 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">config</span><span class="token_op">(</span><span class="token_name">background</span><span class="token_op">=</span><span class="token_string">'#FFFACD'</span><span class="token_op">)</span><span class="token_comment">#'lemonchiffon': '#FFFACD'</span>
<a name="line1486"><span class="token_number">1486 </span></a>
<a name="line1487"><span class="token_number">1487 </span></a>    <span class="token_name">grid_gui</span> <span class="token_op">=</span> <span class="token_name">MockGridGUI</span><span class="token_op">(</span> <span class="token_name">MainWin</span> <span class="token_op">)</span>
<a name="line1488"><span class="token_number">1488 </span></a>    
<a name="line1489"><span class="token_number">1489 </span></a>    <span class="token_name">MainWin</span><span class="token_op">.</span><span class="token_name">mainloop</span><span class="token_op">()</span>    
<a name="line1490"><span class="token_number">1490 </span></a>        </pre></body>
</html>